OverviewþVisão Geral
What if you only wanted to look at the pictures in a book ?þE se só quisesse ver as imagens num livro ?
This is a thought that has occurred to young children and adult researchers alike .þEste é um pensamento que já ocorreu tanto a jovens crianças como a pesquisadores adultos .
If you knew that the book was available through a digital library , it would be nice to download only those pages with pictures and ignore the rest .þSe soubesse que o livro está disponível através duma biblioteca digital , seria útil fazer o download somente das páginas com imagens e ignorar o resto .
Here are the page thumbnails for a HathiTrust volume with unique identifier osu.32435078698222 .þAqui estão as miniaturas de página dum volume do HathiTrust com o identificador exclusivo osu.32435078698222 .
After the process described in this lesson , only those pages with pictures ( 31 in total ) have been downloaded as JPEGs to a folder .þApós o processo descrito nesta lição , apenas as páginas com imagens ( 31 no total ) foram baixadas como JPEGs para uma pasta .
View of volume for which only pages with pictures have been downloaded .þVisualização dum volume para o qual só as páginas com imagens foram baixadas .
To see how many unillustrated pages have been filtered out , compare against the full set of thumbnails for all 148 pages in this revised 1845 edition of Samuel Griswold Goodrich 's bestselling children 's book Tales of Peter Parley about America ( 1827 ) .þImagem com a apresentação das páginas de um livro que contêm imagens Para ver quantas páginas não ilustradas foram filtradas , compare com o conjunto total de miniaturas para todas as 148 páginas nesta edição revisada de 1845 do livro infantil bestseller de Samuel Griswold Goodrich , The Tales of Peter Parley About America ( 1827 ) .
View of HathiTrust thumbnails for all pages .þVisualização das miniaturas do HathiTrust para todas as páginas .
This lesson shows how complete these filtering and downloading steps for public-domain text volumes held by HathiTrust ( HT ) and Internet Archive ( IA ) , two of the largest digital libraries in the world .þImagem com a visualização de todas as miniaturas das páginas de um livro Esta lição mostra como completar estas etapas de filtragem e de download para volumes de texto em domínio público detidos pelo HathiTrust ( HT ) e pelo Internet Archive ( IA ) , duas das maiores bibliotecas digitais no mundo .
It will be of interest to anyone who wants to create image corpora in order to learn about the history of illustration and the layout ( mise en page ) of books .þSerá do interesse de qualquer um que deseje criar coleções de imagens com o fim de aprender sobre a História da Ilustração e o layout ( mise en page ) dos livros .
Visual approaches to digital bibliography are becoming popular , following the pioneering efforts of EBBA and AIDA .þAs abordagens visuais à bibliografia digital estão a tornar-se populares , seguindo os esforços pioneiros do EBBA e do Aida .
Recently completed or funded projects explore ways to identify footnotes and track marginalia , to give just two examples .þProjetos recentemente concluídos ou financiados exploram maneiras de identificar notas de rodapé e de rastrear notas de margem de página , para dar só dois exemplos .
My own research tries to answer empirical questions about changes in the frequency and mode of illustration in nineteenth-century medical and educational texts .þA minha própria pesquisa tenta responder a questões empíricas sobre alterações na frequência e modo de ilustração em textos médicos e educacionais do século dezanove .
This involves aggregating counts of pictures per book and trying to estimate what printing process was used to make those pictures .þIsto envolve agregar múltiplas imagens por livro e tentar estimar que processo de impressão foi usado para fazer tais imagens .
A more targeted use case for extracting picture pages might be the collation of illustrations across different editions of the same book .þUm caso de uso mais direcionado para a extração de páginas ilustradas pode ser a catalogação de ilustrações ao longo de diferentes edições do mesmo livro .
Future work might profitably investigate the visual characteristics and meaning of the extracted pictures : their color , size , theme , genre , number of figures , and so on .þTrabalhos futuros poderão investigar com sucesso as características visuais e o significado das imagens extraídas : a sua cor , o seu tamanho , o seu tema , o seu género , o número de figuras e assim por diante .
How to get localized information about visual regions of interest is beyond the scope of this lesson since the process involves quite a bit of machine learning .þComo obter informação localizada sobre regiões visuais de interesse está para além do âmbito desta lição , visto que o processo envolve uma quantidade significativa de aprendizagem de máquina .
However , the yes/no classification of pages with ( or without ) pictures is a practical first step to shrink the huge space of all pages for each book in a target collection and , thereby making illustration localization feasible .þNo entanto , a classificação sim/não de páginas com ( ou sem ) imagens é um primeiro passo prático para reduzir o enorme volume de todas as páginas para cada livro numa coleção visada , tornando viável a localização de ilustrações .
To give a reference point , nineteenth-century medical texts contain ( on average ) illustrations on 1-3 % of their pages .þPara dar um ponto de referência , os textos médicos do século dezanove contêm ( em média ) ilustrações em 1-3 % das suas páginas .
If you are trying to study illustration within a digital-library corpus about which you do not have any preexisting information , it is thus reasonable to assume that 90+ % of the pages in that corpus will NOT be illustrated .þSe estiver a tentar estudar a ilustração no interior dum corpus duma biblioteca digital sobre o qual não tem qualquer informação preexistente , é , consequentemente , razoável assumir que 90+ % das páginas nesse corpus NÃO estarão ilustradas .
HT and IA allow the pictures/no pictures question to be answered indirectly through parsing the data generated by optical character recognition software ( OCR is applied after a physical volume is scanned in order to generate an often-noisy transcription of the text ) .þO HT e o IA permitem que a questão com imagens/sem imagens seja respondida indiretamente através da análise dos dados gerados pelo software optical character recognition ( OCR ) ou reconhecimento ótico de caracteres , em português ( o OCR é aplicado após um volume físico ser digitalizado com o objetivo de gerar uma transcrição do texto muitas vezes desordenada ) .
Leveraging OCR output to find illustrated pages was first proposed by Kalev Leetaru in a 2014 collaboration with Internet Archive and Flickr .þAproveitar o resultado do output do OCR para encontrar páginas ilustradas foi proposto primeiramente por Kalev Leetaru numa colaboração de 2014 com o Internet Archive e o Flickr .
This lesson ports Leetaru 's approach to HathiTrust and takes advantage of faster XML-processing libraries in Python as well as IA 's newly-extended range of image file formats .þEsta lição transfere a abordagem de Leetaru para o HathiTrust e tira proveito de bibliotecas de processamento de XML mais rápidas no Python , bem como da gama recentemente ampliada de formatos de ficheiro de imagem do IA .
Since HT and IA expose their OCR-derived information in slightly different ways , I will postpone the details of each library 's `` visual features '' to their respective sections .þUma vez que o HT e o IA expõem a sua informação derivada do OCR de maneiras ligeiramente diferentes , eu irei adiar a apresentação dos detalhes das `` características visuais '' de cada biblioteca para as suas secções respetivas .
GoalsþObjetivos
By the end of the lesson you will be able to :þNo final da lição , o leitor será capaz de :
Set up the `` minimal '' Anaconda Python distribution ( Miniconda ) and create an environmentþConfigurar a versão `` mínima '' da distribuição Anaconda do Python ( Miniconda ) e criar um ambiente ;
Save and iterate over a list of HT or IA volumes IDs generated by a searchþSalvar e iterar sobre uma lista de IDs de volumes do HT ou do IA gerados por uma pesquisa ;
Access the HT and IA data application programmer interfaces ( APIs ) through Python librariesþAcessar aos application programming interfaces ( APIs ) ou interfaces de programação de aplicações , em português , de dados do HT e do IA através das bibliotecas do Python ;
Find page-level visual featuresþEncontrar características visuais ao nível da página ;
Download page JPEGs programmaticallyþFazer o download dos JPEGs de páginas programaticamente .
The big-picture goal is to strengthen data collection and exploration skills by creating a historical illustration corpus .þO grande objetivo é fortalecer as competências de coleta e exploração de dados ao criar um corpus de ilustração histórica .
Combining image data with volume metadata allows the formulation of promising research questions about visual change over time .þCombinar dados de imagem com os metadados dum volume permite a formulação de questões de pesquisa promissoras sobre a mudança visual ao longo do tempo .
RequirementsþRequisitos
This lesson 's software requirements are minimal : access to a machine running a standard operating system and a web browser .þOs requisitos de software desta lição são mínimos : o acesso a uma máquina executando um sistema operacional padrão e um navegador de internet .
Miniconda is available in both 32- and 64-bit versions for Windows , macOS , and Linux .þO Miniconda está disponível em duas versões de 32 e de 64 bits para Windows , macOS e Linux .
Python 3 is the current stable release of the language and will be supported indefinitely .þO Python 3 é a versão estável atual da linguagem e será suportado indefinidamente .
This tutorial assumes basic knowledge of the command line and the Python programming language .þEste tutorial assume um conhecimento básico da linha de comando e da linguagem de programação Python .
You should understand the conventions for comments and commands in a shell-based tutorial .þO leitor deve compreender as convenções para comentários e comandos num tutorial baseado num shell .
I recommend Ian Milligan and James Baker 's Introduction to the Bash Command Line for learning or brushing up on your command line skills .þEu recomendo a Introduction to the Bash Command Line , de Ian Milligan e James Baker , para aprender ou para rever as suas competências com a linha de comando .
SetupþConfiguração
DependenciesþDependências
More experienced readers may wish to simply install the dependencies and run the notebooks in their environment of choice .þOs leitores mais experientes podem querer simplesmente instalar as dependências e executar os notebooks nos seus ambientes de escolha .
Further information on my own Miniconda setup ( and some Windows/ * nix differences ) is provided .þMais informações sobre a minha própria configuração do Miniconda ( e algumas diferenças entre o Windows e o * nix ) são providenciadas .
þNota de tradução : Para instalar as dependências , altere o seu diretório de trabalho para a pasta onde se encontra instalado o Python executando o comando cd e , depois , digite o comando pip install ou pip3 install acompanhado pelas seguintes linhas :
hathitrust-api ( Install docs )þNota de tradução hathitrust-api ou hathitrust_api ( Documentos de Instalação ) ;
internetarchive ( Install docs )þinternetarchive ( Documentos de Instalação ) ;
jupyter ( Install docs )þjupyter ( Documentos de Instalação ) ;
requests ( Install docs ) [ creator recommends pipenv installation ; for pip install see PyPI ]þrequests ( Documentos de Instalação ) [ o criador recomenda a instalação do pipenv ; para a instalação do pip , veja PyPI ] .
Lesson FilesþFicheiros da Lição
Download this compressed folder that contains two Jupyter notebooks , one for each of the digital libraries .þFaça o download desta pasta comprimida que contém dois Jupyter notebooks , um para cada uma das bibliotecas digitais .
The folder also contains a sample JSON metadata file describing a HathiTrust collection .þA pasta também contém um ficheiro de metadados JSON de amostra descrevendo uma coleção do HathiTrust .
Unzip and check that the following files are present : 554050894-1535834127.json , hathitrust.ipynb , internetarchive.ipynb .þDescomprima e confirme que os seguintes ficheiros estão presentes : 554050894-1535834127.json , hathitrust.ipynb e internetarchive.ipynb .
All subsequent commands assume that your current working directory is the folder containing the lesson files .þTodos os comandos subsequentes assumem que o seu diretório de trabalho atual é a pasta que contém os ficheiros da lição .
Download DestinationþDestino do Download
Here is the default directory that will be created once all the cells in both notebooks have been run ( as provided ) .þAqui está o diretório predefinido que será criado assim que todas as células em ambos os notebooks tiverem sido executadas ( como providenciado ) .
After getting a list of which pages in a volume contain pictures , the HT and IA download functions request those pages as JPEGs ( named by page number ) and store them in sub-directories ( named by item ID ) .þDepois de obter uma lista de quais páginas num volume contêm imagens , as funções de download do HT e do IA solicitam essas páginas como JPEGs ( nomeadas pelo número de página ) e arquivam-nas em subdiretórios ( nomeados pelo ID do item ) .
You can of course use different volume lists or change the out_dir destination to something other than items .þÉ claro que o leitor pode usar diferentes listas de volumes ou mudar o destino out_dir para algo que não items .
The download functions are lazy ; if you run the notebooks again , with the items directory looking as it does above , any item that already has its own sub-folder will be skipped .þAs funções de download são lentas ; se executar os notebooks novamente , com o diretório items similar ao que se apresenta em cima , qualquer item que já tenha a sua própria subpasta será ignorado .
Anaconda ( optional )þAnaconda ( Opcional )
Anaconda is the leading scientific Python distribution .þA Anaconda é a principal distribuição científica do Python .
Its conda package manager allows you to install libraries such as numpy and tensorflow with ease .þO seu gerenciador de pacotes conda permite-lhe instalar bibliotecas como a numpy e a tensorflow com facilidade .
The `` Miniconda '' version does not come with any superfluous packages preinstalled , which encourages you to keep your base environment clean and only install what you need for a project within a named environment .þA versão `` Miniconda '' não é acompanhada por quaisquer pacotes supérfluos pré-instalados , o que incentiva o leitor a manter o seu ambiente de base limpo e a instalar apenas o que necessita para um projeto dentro dum ambiente nomeado .
Download and install Miniconda .þFaça o download e instale o Miniconda .
Choose the latest stable release of Python 3 .þEscolha a versão estável mais recente do Python 3 .
If everything goes well , you should be able to run which conda ( linux/macOS ) or where conda ( Windows ) in your shell and see the location of the executable program in the output .þSe tudo correr bem , o leitor conseguirá executar which conda ( no Linux/macOS ) ou where conda ( no Windows ) no seu shell e ver a localização do programa executável no output .
Anaconda has a handy cheat sheet for frequently used commands .þA Anaconda tem uma cheat sheet ou folha de dicas , em português , útil para comandos de uso frequente .
Create an EnvironmentþCriar um Ambiente
Environments , among other things , help control the complexity associated with using multiple package managers in tandem .þOs ambientes , entre outras coisas , ajudam a controlar a complexidade associada ao uso de múltiplos gerenciadores de pacotes em conjunto .
Not all Python libraries can be installed through conda .þNem todas as bibliotecas do Python podem ser instaladas através do conda .
In some cases we will fall back to the standard Python package manager , pip ( or planned replacements like pipenv ) .þEm alguns casos , nós recorreremos ao gestor de pacote padrão do Python , o pip ( ou alterações planejadas , como o pipenv ) .
However , when we do so , we will use a version of pip installed by conda .þNo entanto , quando o fizermos , nós usaremos uma versão do pip instalada através do conda .
This keeps all the packages we need for the project in the same virtual sandbox .þIsto mantém todos os pacotes que nós precisamos para o projeto no mesmo espaço virtual .
Now we create a named environment , set it to use Python 3 , and activate it .þAgora nós criamos um ambiente nomeado , configuramo-lo para usar Python 3 , e ativamo-lo .
To exit an environment , run source deactivate on macOS/Linux or deactivate on Windows .þPara sair dum ambiente , execute source deactivate no Linux/macOS ou deactivate no Windows .
But make sure to stay in the extract-pages environment for the duration of the lesson !þMas certifique-se que permanece no ambiente extract-pages durante o decorrer da lição !
Install Conda PackagesþInstalar os Pacotes do Conda
We can use conda to install our first couple of packages .þNós podemos usar o conda para instalar os nossos primeiros pacotes .
All the other required packages ( gzip , json , os , sys , and time ) are part of the standard Python library .þTodos os outros pacotes necessários ( gzip , JSON , os , sys e time ) fazem parte da biblioteca padrão do Python .
Note how we need to specify a channel in some cases .þNote como nós precisamos de especificar um canal em alguns casos .
You can search for packages on Anaconda Cloud .þO leitor pode pesquisar por pacotes no Anaconda Cloud .
Jupyter has many dependencies ( other packages on which it relies ) , so this step may take a few minutes .þO Jupyter tem muitas dependências ( outros pacotes dos quais depende ) , por isso esta etapa pode exigir alguns minutos .
Remember that when conda prompts you with Proceed ( [ y ] /n ) ? you should type a y or yes and then press Enter to accept the package plan .þRecorde-se que quando o conda lhe pergunta se deseja continuar com a instalação por via da questão Proceed ( [ y ] /n ) ? , o leitor deve digitar um y ou um yes e , depois , pressionar Enter para aceitar a instalação do pacote .
Behind the scenes , conda is working to make sure all the required packages and dependencies will be installed in a compatible way .þNos bastidores , o conda está a trabalhar para certificar-se que todos os pacotes e dependências necessários serão instalados numa maneira compatível .
Install Pip PackagesþInstalar Pacotes do Pip
If you are using a conda environment , it 's best to use the local version of pip .þSe estiver a usar um ambiente conda , é melhor usar a versão local do pip .
Check that the following commands output a program whose absolute path contains something like /Miniconda/envs/extract-pages/Scripts/pip .þConfirme que os seguintes comandos dão como resultado do output um programa cujo caminho absoluto contém algo como /Miniconda/envs/extract-pages/Scripts/pip .
If you see two versions of pip in the output above , make sure to type the full path to the local environment version when installing the API wrapper libraries :þSe vir duas versões do pip no output em cima , certifique-se de digitar o caminho absoluto para a versão do ambiente local ao instalar as bibliotecas wrapper da API .
Jupyter Notebooks Peter Organisciak and Boris Capitanu 's Text Mining in Python through the HTRC Feature Reader explains the benefits of notebooks for development and data exploration .þO Text Mining in Python Through the HTRC Feature Reader , de Peter Organisciak e Boris Capitanu , explica os benefícios dos notebooks para o desenvolvimento e a exploração de dados .
It also contains helpful information on how to effectively run cells .þTambém contém informação útil sobre como executar eficazmente as células .
Since we installed the minimalist version of Anaconda , we need to launch Jupyter from the command line .þVisto que nós instalámos a versão minimalista da Anaconda , nós precisamos de iniciar o Jupyter a partir da linha de comandos .
In your shell ( from inside the folder containing the lesson files ) run jupyter notebook .þNo seu shell ( a partir do interior da pasta contendo os ficheiros da lição ) execute jupyter notebook .
This will run the notebook server in your shell and launch your default browser with the Jupyter homepage .þIsto executará o servidor do notebook no seu shell e iniciará o seu navegador de internet predefinido com a página inicial do Jupyter .
The homepage shows all the files in the current working directory .þA página inicial mostra todos os ficheiros no diretório de trabalho atual .
Jupyter homepage showing lesson files .þA página inicial do Jupyter mostrando os ficheiros da lição . Imagem com a apresentação da estrutura de ficheiros da página inicial do Jupyter
In your shell , make sure you have cd -ed into the unzipped lesson-files directory .þNo seu shell , certifique-se que usou o comando cd para ir até ao diretório descomprimido lesson-files .
Click on the hathitrust.ipynb and internetarchive.ipynb notebooks to open them in new browser tabs .þClique nos notebooks hathitrust.ipynb e internetarchive.ipynb para abri-los em novas abas do navegador de internet .
From now on , we do n't need to run any commands in the shell .þA partir daqui , nós não precisamos de executar qualquer comando no shell .
The notebooks allow us to execute Python code and have full access to the computer 's file system .þOs notebooks permitem-nos executar o código Python e ter acesso total ao sistema de pastas do computador .
When you are finished , you can stop the notebook server by clicking `` Quit '' on the Jupyter homepage or executing ctrl+c in the shell .þQuando o leitor tiver terminado , pode parar o servidor do notebook carregando em `` Quit `` na página inicial do Jupyter ou executando ctrl+c no shell .
HathiTrustþHathiTrust
API AccessþAcesso à API
You need to register with HathiTrust before using the Data API .þO leitor precisa efetuar um registro no HathiTrust antes de usar o API de dados .
Head over to the registration portal and fill out your name , organization , and email to request access keys .þDirija-se ao portal de registro e preencha o seu nome , a sua organização e o seu e-mail para requerer chaves de acesso .
You should receive an email response within a minute or so .þO leitor deverá receber uma resposta no e-mail dentro de cerca dum minuto ( : verifique também a caixa de spam ) .
Click the link , which will take you to a one-time page with both keys displayed .þnota de tradução Clique no link , que o trará a uma página temporária com ambas as chaves exibidas .
In the hathitrust.ipynb notebook , examine the very first cell ( shown below ) .þNo notebook hathitrust.ipynb , examine a primeira célula ( mostrada em baixo ) .
Fill in your API tokens as directed .þPreencha as suas chaves da API como indicado .
Then run the cell by clicking `` Run '' in the notebook navbar .þDepois , execute a célula clicando em `` Run `` na barra de navegação do notebook .
Careful !þCuidado !
Do not expose your access tokens through a public repo on GitHub ( or other version control host ) .þNão exponha as suas chaves de acesso através dum repositório público no GitHub ( ou outro host de controle de versões ) .
They will be searchable by just about anyone .þElas serão pesquisáveis por qualquer outra pessoa .
One good practice for a Python project is to either store your tokens as environment variables or save them in a file that is not versioned .þUma boa prática para um projeto Python é a de armazenar as suas chaves de acesso como variáveis de ambiente ou salvá-las num ficheiro que não é versionado .
Create Volume ListþCriar uma Lista de Volumes
HT allows anyone to make a collection of items—you do n't even have to be logged in !þO HT permite a qualquer um fazer uma coleção de itens—o leitor nem sequer tem que estar na sua conta !
You should register for an account , however , if you want to save your list of volumes .þNo entanto , o leitor deveria registrar uma conta se quiser salvar a sua lista de volumes .
Follow the instructions to do some full-text searches and then add selected results to a collection .þSiga as instruções para fazer algumas pesquisas no texto completo e para , depois , adicionar resultados escolhidos a uma coleção .
Currently , HathiTrust does not have a public search API for acquiring volumes programmatically ; you need to search through their web interface .þAtualmente , o HathiTrust não tem uma API de pesquisa pública para adquirir volumes programaticamente ; o leitor precisa de pesquisar através da sua interface da internet .
As you update a collection , HT keeps track of the associated metadata for each item in it .þAo atualizar uma coleção , o HT mantém o rastro dos metadados associados para cada item nela .
I have included in the lesson files the metadata for a sample lesson in JSON format .þEu incluí nos ficheiros da lição os metadados para uma lição de amostra no formato JSON .
If you wanted to use the file from your own HT collection , you would navigate to your collections page and hover on the metadata link on the left to bring up the option to download as JSON as seen in the following screenshot .þSe quisesse usar o ficheiro da sua própria coleção do HT , o leitor navegaria até à página das suas coleções e colocaria o cursor do mouse sobre o link dos metadados à esquerda para revelar a opção para fazer o download como JSON , como observado na seguinte captura de tela .
Screenshot of how to download collection metadata in JSON format .þCaptura de tela de como fazer o * download * dos metadados de coleções no formato JSON .
When you have downloaded the JSON file , simply move it to the directory where you placed the Jupyter notebooks .þImagem de uma página web do site HathiTrust com instruções para download de metadados de ficheiros JSON Assim que o leitor tiver feito o download do ficheiro JSON , basta movê-lo para o diretório onde colocou os Jupyter notebooks .
Replace the name of the JSON file in the HT notebook with the name of your collection 's file .þSubstitua o nome do ficheiro JSON no notebook do HT com o nome do ficheiro da sua coleção .
The notebook shows how to use a list comprehension to get all the htitem_id strings within the gathers object that contains all the collection information .þO notebook mostra como usar list comprehension para obter todas as strings htitem_id dentro do objeto gathers que contem todas as informações da coleção .
Tutorials often show you how to process one example item ( often of a trivial size or complexity ) .þOs tutoriais normalmente mostram-lhe como processar um item de exemplo ( muitas vezes de tamanho ou complexidade trivial ) .
This is pedagogically convenient , but it means you are less equipped to apply that code to multiple items—by far the more common use case .þIsto é pedagogicamente conveniente , mas significa que o leitor está menos equipado para aplicar esse código a múltiplos itens—de longe o caso de uso mais comum .
In the notebooks you will see how to encapsulate transformations applied to one item into functions that can be called within a loop over a collection of items .þNos notebooks , o leitor verá como encapsular transformações aplicadas a um item em funções que podem ser usadas num loop sobre uma coleção de itens .
Visual Feature : IMAGE_ON_PAGEþCaracterística Visual : IMAGE_ON_PAGE
Given a list of volumes , we want to explore what visual features they have at the page level .þDada uma lista de volumes , nós queremos explorar que características visuais eles têm ao nível da página .
The most recent documentation ( 2015 ) for the Data API describes a metadata object called htd : pfeat on pages 9-10 .þA documentação mais recente ( 2015 ) para o API de dados descreve um objeto metadados chamado htd : pfeat nas páginas 9-10 .
htd : pfeat is shorthand for `` HathiTrust Data API : Page Features . ''þhtd : pfeat é a abreviação para `` HathiTrust Data API : Page Features '' .
htd : pfeat ­ - the page feature key ( if available ) : CHAPTER_START COPYRIGHT FIRST_CONTENT_CHAPTER_START FRONT_COVER INDEX REFERENCES TABLE_OF_CONTENTS TITLEþhtd : pfeat ­ - the page feature key ( if available ) : CHAPTER_START COPYRIGHT FIRST_CONTENT_CHAPTER_START FRONT_COVER INDEX REFERENCES TABLE_OF_CONTENTS TITLE
CHAPTER_STARTþCHAPTER_START
COPYRIGHTþCOPYRIGHT
FIRST_CONTENT_CHAPTER_STARTþFIRST_CONTENT_CHAPTER_START
FRONT_COVERþFRONT_COVER
INDEXþINDEX
REFERENCESþREFERENCES
TABLE_OF_CONTENTSþTABLE_OF_CONTENTS
TITLEþTITLE
What the hathitrust-api wrapper does is make the full metadata for a HT volume available as a Python object .þO que o wrapper hathitrust-api faz é disponibilizar os metadados completos para um volume do HT como um objeto Python .
Given a volume 's identifier , we can request its metadata and then drill down through the page sequence into page-level information .þDado o identificador dum volume , nós podemos pedir os seus metadados e , depois , fazer o drill down através da sequência de páginas até à informação ao nível da página .
The htd : pfeat list is associated with each page in a volume and in theory contains all features that apply to that page .þA lista htd : pfeat está associada com cada página num volume e , em teoria , contém todas as características que se aplicam a essa página .
In practice , there a quite a few more feature tags than the eight listed above .þNa prática , existem mais algumas tags de características do que as oito listadas em cima .
The one we will be working with is called IMAGE_ON_PAGE and is more abstractly visual than structural tags such as CHAPTER_START .þAquela com a qual nós iremos trabalhar chama-se IMAGE_ON_PAGE e é mais abstratamente visual que tags estruturais como CHAPTER_START .
Tom Burton-West , a research librarian at the University of Michigan Library , works closely with HathiTrust and HTRC , HathiTrust 's Research Center .þTom Burton-West , um bibliotecário pesquisador na biblioteca da University of Michigan , trabalha em estreita colaboração com o HathiTrust e o HTRC , o Centro de Pesquisa do HathiTrust .
Tom told me over email that HathiTrust is provided the htd : pfeat information by Google , with whom they have worked closely since HT 's founding in 2008 .þO Tom disse-me por e-mail que o HathiTrust recebe a informação htd : pfeat via o Google , com o qual trabalham proximamente desde a fundação do HT , em 2008 .
A contact at Google gave Tom permission to share the following :þUm contacto no Google deu permissão ao Tom para partilhar o seguinte :
These tags are derived from a combination of heuristics , machine learning , and human tagging .þEstas tags são derivadas duma combinação de Heurística , de aprendizagem de máquina e de anotação humana .
An example heuristic might be that the first element in the volume page sequence is almost always the FRONT_COVER .þUm exemplo heurístico pode ser o facto do primeiro elemento na sequência de páginas do volume ser quase sempre a FRONT_COVER .
Machine learning could be used to train models to discriminate , say , between image data that is more typical of lines of prose in a Western script or of the lines in an engraving .þA aprendizagem de máquina pode ser usada para treinar modelos a discriminar , digamos , entre dados de imagem que são mais típicos das linhas de prosa numa escrita ocidental ou das linhas numa gravura .
Human tagging is the manual assignment of labels to images .þA anotação humana é a atribuição manual de etiquetas a imagens .
The ability to view a volume 's illustrations in the EEBO and ECCO databases is an example of human tagging .þA habilidade de ver as ilustrações dum volume nos bancos de dados do EEBO e do ECCO é um exemplo de anotação humana .
The use of `` machine learning '' by Google sounds somewhat mysterious .þO uso da `` aprendizagem de máquina '' pelo Google parece um pouco misterioso .
Until Google publicizes their methods , it is impossible to know all the details .þAté o Google publicitar os seus métodos , é impossível saber todos os detalhes .
However , it 's likely that the IMAGE_ON_PAGE tags were first proposed by detecting `` Picture '' blocks in the OCR output files ( a process discussed below in the Internet Archive section ) .þNo entanto , é provável que as tags IMAGE_ON_PAGE tenham sido propostas pela primeira vez após a deteção de blocos de `` Imagens '' nos ficheiros de output do OCR ( um processo discutido em baixo , na secção do Internet Archive ) .
Further filtering may then be applied .þMais filtragem pode , então , ser aplicada .
Code Walk-throughþPasso a Passo Para o Código
Find PicturesþEncontrar as imagens
We have seen how to create a list of volumes and observed that the Data API can be used to get metadata objects containing page-level experimental features .þNós vimos como criar uma lista de volumes e observámos que a API de dados pode ser usada para obter objetos metadados contendo características experimentais ao nível da página .
The core function in the HT notebook has the signature ht_picture_download ( item_id , out_dir=None ) .þA função essencial no notebook do HT tem a assinatura digital ht_picture_download ( item_id , out_dir=None ) .
Given a unique identifier and an optional destination directory , this function will first get the volume 's metadata from the API and convert it into JSON format .þDado um identificador exclusivo e um diretório de destino opcional , esta função irá , em primeiro lugar , obter os metadados do volume a partir da API e convertê-los num formato JSON .
Then it loops over the page sequence and checks if the tag IMAGE_ON_PAGE is in the htd : pfeat list ( if it exists ) .þDepois , percorre a sequência de páginas e verifica se a tag IMAGE_ON_PAGE está na lista htd : pfeat ( se a mesma existir ) .
Notice that we need to drill down several levels into the top-level object to get the htd : seq object , which we can iterate over .þNote que nós precisamos de fazer o drill down por vários níveis até ao objeto do nível de topo para obter o objeto htd : seq , sobre o qual nós podemos iterar .
The two exceptions I want to catch are KeyError , which occurs when the page does not have an page-level features associated with it and TypeError , which occurs when the pseq field for the page is for some reason non-numeric and thus can not be cast to an int .þAs duas exceções que eu quero evitar são o KeyError , que ocorre quando a página não tem qualquer característica ao nível da página a si associada , e o TypeError , que ocorre quando o campo pseq para a página é , por alguma razão , não numérico e , portanto , não pode ser destinado a um int .
If something goes wrong with a page , we just continue on to the next one .þSe algo correr mal com uma página , nós simplesmente executamos continue para passar à próxima .
The idea is to get all the good data we can. Not to clean up inconsistencies or gaps in the item metadata .þO plano é obter todos os dados bons que conseguirmos . Não é limpar inconsistências ou falhas nos metadados do item .
Download ImagesþFazer o Download das Imagens
Once img_pages contains the complete list of pages tagged with IMAGE_ON_PAGE , we can download those pages .þAssim que img_pages contém a lista completa de páginas com a tag IMAGE_ON_PAGE , nós podemos fazer o download dessas páginas .
Note that if no out_dir is supplied to ht_picture_download ( ) , then the function simply returns the img_pages list and does NOT download anything .þNote que , se nenhum out_dir for fornecido a ht_picture_download ( ) , então a função simplesmente retorna a lista img_pages e NÃO faz o download do quer que seja .
The getpageimage ( ) API call returns a JPEG by default .þA chamada da API getpageimage ( ) retorna um JPEG por predefinição .
We simply write out the JPEG bytes to a file in the normal way .þNós simplesmente colocamos os bytes do JPEG num ficheiro na forma normal .
Within the volume sub-folder ( itself inside out_dir ) , the pages will be named 1.jpg for page 1 and so forth .þDentro da subpasta do volume ( ela própria dentro do out_dir ) , as páginas serão nomeadas 1.jpg para a página 1 e assim sucessivamente .
One thing to consider is our usage rate of the API .þUma coisa a considerar é a nossa taxa de uso da API .
We do n't want to abuse our access by making hundreds of requests per minute .þNós não queremos abusar do nosso acesso ao fazer centenas de pedidos por minuto .
To be safe , especially if we intend to run big jobs , we wait two seconds before making each page request .þPara estar a salvo , especialmente se pretendermos executar grandes trabalhos , nós esperamos dois segundos antes de fazer cada pedido de página .
This may be frustrating in the short term , but it helps avoid API throttling or banning .þIsto pode ser frustrante a curto prazo , mas ajuda a evitar o sufocamento ou a suspenção da API .
Internet ArchiveþInternet Archive
API AccessþAcesso à API
We connect to the Python API library using an Archive.org account email and password rather than API tokens .þNós conectamos à biblioteca API do Python usando uma conta no Archive.org com e-mail e palavra-chave ao invés das chaves de acesso do API .
This is discussed in the Quickstart Guide .þIsto é discutido no Guia Quickstart .
If you do not have an account , register for your `` Virtual Library Card . ''þSe não tiver uma conta , registre-se para obter o seu `` Virtual Library Card '' .
In the first cell of the internetarchive.ipynb notebook , enter your credentials as directed .þNa primeira célula do notebook internetarchive.ipynb , introduza as suas credenciais como indicado .
Run the cell to authenticate to the API .þExecute a célula para autenticar-se perante a API .
þ: O comando ia.configure ( ia_email , ia_password ) é atualmente desnecessário e pode gerar um erro extenso , em cuja mensagem final consta : InvalidURL : Invalid URL 'https : ///services/xauthn/ ' : No host supplied .
þNota de tradução
þSugerimos que o mesmo não seja executado no ficheiro IPYNB .
Create Volume ListþCriar uma Lista de Volumes
The IA Python library allows you to submit query strings and receive a list of matching key-value pairs where the word `` identifier '' is the key and the actual identifier is the value .þA biblioteca IA do Python permite-lhe submeter query strings e receber uma lista de pares chave-valor correspondentes na qual a palavra `` identifier `` , ou identificador , em português , é a chave e o verdadeiro identificador é o valor .
The syntax for a query is explained on the Advanced Search page for IA .þA sintaxe para uma query é explicada na página de Advanced Search para o IA .
You can specify parameters by using a keyword like `` date '' or `` mediatype '' followed by a colon and the value you want to assign that parameter .þO leitor pode especificar parâmetros ao usar uma palavra-chave como `` date `` ou `` mediatype `` seguida de dois pontos e o valor que quer atribuir a esse parâmetro .
For instance , I only want results that are texts ( as opposed to video , etc. ) .þPor exemplo , eu só quero resultados que são textos ( em oposição a vídeos , etc . ) .
Make sure the parameters and options you are trying to use are supported by IA 's search functionality .þCertifique-se que os parâmetros e as opções que está a tentar usar são suportadas pela funcionalidade de pesquisa do IA .
Otherwise you may get missing or weird results and not know why .þCaso contrário , pode perder ou obter resultados estranhos e não saber porquê .
In the notebook , I generate a list of IA ids with the following code :þNo notebook , eu gero uma lista de IDs do IA com o seguinte código :
Visual Feature : Picture BlocksþCaracterística Visual : Blocos de Imagens
Internet Archive does not release any page-level features .þO Internet Archive não apresenta quaisquer características ao nível da página .
Instead , it makes a number of raw files from the digitization process available to users .þAo invés , disponibiliza um certo número de ficheiros brutos do processo de digitalização aos utilizadores .
The most important of these for our purposes is the Abbyy XML file .þO mais importante destes para os nossos propósitos é o ficheiro XML Abbyy .
Abbyy is a Russian company whose FineReader software dominates the OCR market .þAbbyy é uma empresa russa cujo software FineReader domina o mercado do OCR .
All recent versions of FineReader produce an XML document that associates different `` blocks '' with each page in the scanned document .þTodas as versões recentes do FineReader produzem um documento XML que associa diferentes `` blocos '' com cada página no documento digitalizado .
The most common type of block is Text but there are Picture blocks as well .þO tipo de bloco mais comum é Text mas também existem blocos Picture ou `` Imagem '' , em português .
Here is an example block taken from an IA Abbyy XML file .þAqui está um bloco de exemplo tirado dum ficheiro de XML Abbyy do IA .
The top-left ( `` t '' and `` l '' ) and bottom-right ( `` b '' and `` r '' ) corners are enough to identify the rectangular block region .þOs cantos superior esquerdo ( `` t '' e `` l '' ) e inferior direito ( `` b '' e `` r '' ) são suficientes para identificar a região de bloco retangular .
The IA equivalent to looking for IMAGE_ON_PAGE tags in HT is parsing the Abbyy XML file and iterating over each page .þO equivalente no IA a ver as tags IMAGE_ON_PAGE no HT é a análise do ficheiro XML Abbyy e a iteração sobre cada página .
If there is at least one Picture block on that page , the page is flagged as possibly containing an image .þSe existir pelo menos um bloco Picture nessa página , a página é sinalizada como possivelmente contendo uma imagem .
While HT 's IMAGE_ON_PAGE feature contains no information about the location of that image , the Picture blocks in the XML file are associated with a rectangular region on the page .þEnquanto a característica IMAGE_ON_PAGE do HT não contém informação sobre a localização dessa imagem , os blocos Picture no ficheiro XML estão associados a uma região retangular na página .
However , since FineReader specializes in recognizing letters from Western character sets , it is much less accurate at identifying image regions .þNo entanto , porque o FineReader se especializa no reconhecimento de letras de conjuntos de caracteres ocidentais , é muito menos preciso a identificar regiões de imagem .
Leetaru 's project ( see Overview ) used the region coordinates to crop pictures , but in this lesson we will simply download the whole page .þO projeto de Leetaru ( veja Visão Geral ) usou as coordenadas da região para cortar imagens , mas nesta lição nós iremos simplesmente fazer o download da página inteira .
Part of the intellectual fun of this lesson is using a noisy dataset ( OCR block tags ) for a largely unintended purpose : identifying pictures and not words .þParte da diversão intelectual desta lição é usar um dataset ( tags de bloco do OCR ) por vezes confuso para um propósito largamente não intencional : identificar imagens e não palavras .
At some point , it will become computationally feasible to run deep learning models on every raw page image in a volume and pick out the desired type ( s ) of picture ( s ) .þA certa altura , tornar-se-á computacionalmente viável executar modelos de aprendizagem aprofundada em todas as páginas ilustradas nuas num volume e escolher o ( s ) tipo ( s ) de imagem ( /ns ) desejada ( s ) .
But since most pages in most volumes are unillustrated , that is an expensive task .þMas , como a maior parte das páginas na maioria dos volumes não são ilustradas , esta é uma tarefa dispendiosa .
For now , it makes more sense to leverage the existing data we have from the OCR ingest process .þPor agora , faz mais sentido aproveitar os dados existentes que nós detemos do processo de ingestão do OCR .
For more information on how OCR itself works and interacts with the scan process , please see Mila Oiva 's PH lesson OCR with Tesseract and ScanTailor .þPara mais informações sobre como o próprio OCR funciona e interage com o processo de digitalização , por favor , veja a lição do PH de Mila Oiva , OCR With Tesseract and ScanTailor ( atenção que esta lição já não é actualizada ) .
Errors can crop up due to skewing , artefacts , and many other problems .þErros podem surgir por causa de distorções , artefactos e muitos outros problemas .
These errors end up affecting the reliability and precision of the `` Picture '' blocks .þEstes erros acabam por afetar a fiabilidade e a precisão dos blocos `` Picture '' .
In many cases , Abbyy will estimate that blank or discolored pages are actually pictures .þEm muitos casos , o Abbyy estimará que páginas em branco ou descoloridas são , na realidade , imagens .
These incorrect block tags , while undesirable , can be dealt with using retrained convolutional neural networks .þEstas tags de bloco incorretas , ainda que indesejadas , podem ser combatidas com o uso de redes neurais convolucionais retreinadas .
Think of the page images downloaded in this lesson as a first pass in a longer process of obtaining a clean and usable dataset of historical illustrations .þPense nas páginas com imagens cujo download foi feito nesta lição como um primeiro passo num processo mais longo para obter um dataset limpo e útil de ilustrações históricas .
Code Walk-throughþPasso a Passo do Código
Find PicturesþEncontrar as Imagens
Just as with HT , the core function for IA is ia_picture_download ( item_id , out_dir=None ) .þTal como com o HT , a função principal para o IA é ia_picture_download ( item_id , out_dir=None ) .
Since it involves file I/O , the process for geting the img_pages list is more complicated than that for HT .þVisto que envolve o I/O dum ficheiro , o processo para obter a lista img_pages é mais complicado do que o do HT .
Using the command line utility ia ( which is installed with the library ) , you can get a sense of the available metadata files for a volume .þUsando a utilidade ia ( que é instalada com a biblioteca ) da linha de comando , o leitor pode obter uma ideia dos ficheiros de metadados disponíveis para um volume .
With very few exceptions , a file with format `` Abbyy GZ '' should be available for volumes with media type text on Internet Archive .þCom muitas poucas exceções , um ficheiro com o formato `` Abbyy GZ '' deveria estar disponível para volumes com o tipo de media text no Internet Archive .
These files , even when compressed , can easily be hundreds of megabytes in size !þEstes ficheiros , mesmo quando comprimidos , podem facilmente ter centenas de megabytes de tamanho !
If there is an Abbyy file for the volume , we get its name and then download it .þSe existir um ficheiro Abbyy para o volume , nós obtemos o seu nome e depois fazemos o download .
The ia.download ( ) call uses some helpful parameters to ignore the request if the file already exists and , if not , download it without creating a nested directory .þA chamada ia.download ( ) usa alguns parâmetros úteis para ignorar a solicitação se o ficheiro já existe e , se não , para fazer o seu download sem criar um diretório aninhado .
To save space , we delete the Abbyy file after parsing it .þPara salvar espaço , nós eliminamos o ficheiro Abbyy depois de o analisar .
Once we have the file , we need to parse the XML using the standard Python library .þAssim que nós tivermos o ficheiro , nós precisamos de analisar o XML usando a biblioteca padrão do Python .
We take advantage of the fact that we can open the compressed file directly with the gzip library .þNós tomamos vantagem do facto de que nós podemos abrir o ficheiro comprimido diretamente com a biblioteca gzip .
Abbyy files are zero-indexed so the first page in the scan sequence has index 0 .þOs ficheiros Abbyy são indexadas a partir do zero , por isso a primeira página na sequência digitalizada tem o índice de 0 .
However , we have to filter out 0 since it can not be requested from IA .þNo entanto , nós temos que filtrar 0 porque não pode ser exigido do IA .
IA 's exclusion of index 0 is not documented anywhere ; rather , I found out through trial and error .þA exclusão do índice 0 por parte do IA não está documentada em qualquer lugar ; em vez disso , eu descobri através de tentativa e erro .
If you see a hard-to-explain error message , try to track down the source and do n't be afraid to ask for help , whether from someone with relevant experience or at the organization itself .þSe o leitor ver uma mensagem de erro de explicação difícil , tente rastrear a origem e não tenha medo em pedir ajuda , seja a alguém com experiência relevante , seja a alguém da própria organização .
Download ImagesþFazer o Download das Imagens
IA 's Python wrapper does not provide a single-page download function—only bulk .þO wrapper do IA incorporado no Python não providencia uma função de download de páginas únicas—apenas em massa .
This means that we will use IA 's RESTful API to get specific pages .þIsto significa que nós usaremos a RESTful API do IA para obter páginas específicas .
First we construct a URL for each page that we need .þPrimeiro , nós construímos um URL para cada página de que nós precisamos .
Then we use the requests library to send an HTTP GET request and , if everything goes well ( i.e . the code 200 is returned in the response ) , we write out the contents of the response to a JPEG file .þDepois , nós usamos a biblioteca requests para enviar uma solicitação GET de HTTP e , se tudo correr bem ( i.e . o código 200 é enviado na resposta ) , nós escrevemos o conteúdo da resposta num ficheiro JPEG .
IA has been working on an alpha version of an API for image cropping and resizing that conforms to the standards of the International Image Interoperability Framework ( IIIF ) .þO IA tem estado a trabalhar numa versão alpha duma API para o corte e redimensionamento de imagens que obedeça às exigências do International Image Interoperability Framework ( IIIF ) .
IIIF represents a vast improvement on the old method for single-page downloads which required downloading JP2 files , a largely unsupported archival format .þO IIIF representa uma profunda melhoria face ao antigo método para downloads de páginas únicas que requeriam a realização do download de ficheiros JP2 , um formato de ficheiro largamente não suportado .
Now it 's extremely simple to get a single page JPEG :þAgora , é extremamente simples obter um só JPEG duma página :
Next StepsþPróximos Passos
Once you understand the main functions and the data unpacking code in the notebooks , feel free to run the cells in sequence or `` Run All '' and watch the picture pages roll in .þAssim que o leitor tiver entendido as principais funções e o código de unpacking dos dados nos notebooks , sinta-se livre para executar as células em sequência ou carregar em `` Run All `` e ver as páginas ilustradas a entrar nas pastas .
You are encouraged to adapt these scripts and functions for your own research questions .þO leitor é encorajado a adaptar estes scripts e funções para as suas próprias questões de pesquisa .
