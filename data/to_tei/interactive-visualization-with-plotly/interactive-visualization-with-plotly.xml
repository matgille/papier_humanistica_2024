<TEI xmlns="https://tei-c.org/ns/1-0/">
  <metadata>
  <title>Creating Interactive Visualizations with Plotly</title>
  <slug>interactive-visualization-with-plotly</slug>
  <layout>lesson</layout>
  <collection>lessons</collection>
  <date>2023-12-13</date>
  <authors>Grace Di M&#233;o</authors>
  <reviewers>Mario Ba&#241;uelos,Rob Lewis</reviewers>
  <editors>Scott Kleinman</editors>
  <review-ticket>https://github.com/programminghistorian/ph-submissions/issues/518</review-ticket>
  <difficulty>2</difficulty>
  <activity>presenting</activity>
  <topics>python,data-visualization</topics>
  <abstract>This lesson demonstrates how to create interactive data visualizations in Python with Plotly's open-source graphing libraries using materials from the Historical Violence Database.</abstract>
  <avatar_alt>Line drawing of a swan looking at its reflection in a body of water</avatar_alt>
  <doi>10.46430/phen0115</doi>
</metadata>
  <text>
    <body>
      <div n="1"><head>Introduction</head>
<div n="2"><head>Lesson Goals</head>
<p>This lesson demonstrates how to create interactive data visualizations in Python using <link target="https://perma.cc/94J3-8LAS">Plotly's open-source graphing libraries</link>. In particular, you will learn:</p>
<ul>
<li>The distinction between Plotly Express, Plotly's Graph Objects, and Plotly Dash</li>
<li>How to create and export graphs using <code type="inline">plotly.express</code> and <code type="inline">plotly.graph_objects</code></li>
<li>How to add custom features to graphs</li>
</ul>
</div><div n="2"><head>Prerequisites</head>
<p>In order to follow this lesson, it is assumed that you have:</p>
<ul>
<li>Installed <link target="https://www.python.org/downloads/">Python 3</link> and the <link target="https://pypi.org/project/pip/"><code type="inline">pip</code> package installer</link></li>
<li>An intermediate level understanding of the Python programming language</li>
<li>Some familiarity with <link target="https://perma.cc/UT9Y-KR76">pandas</link> and <link target="https://perma.cc/JQW9-AM8Y">NumPy</link>, which should also be installed</li>
<li>Knowledge of basic data visualization techniques (especially bar charts, histograms and scatterplots)</li>
<li>Some familiarity with data preprocessing (we will be using pandas)</li>
</ul>
<p>This lesson was developed using Jupyter Notebook. For those who are unfamiliar with this software, the <emph>Programming Historian</emph> offers an excellent lesson on how to create, edit and export Jupyter notebooks <link target="/en/lessons/jupyter-notebooks">here</link>. You may also follow this lesson using your own preferred code editor (VSCode, PyCharm, etc.).</p>
</div><div n="2"><head>What is Plotly?</head>
<p>Plotly is a company which provides a number of open-source libraries allowing users to build interactive graphs. Unlike static images, Plotly graphs can respond to user actions with popup labels, pan-and-zoom abilities, faceted data displays, and more. Plotly libraries are available in Python &#8212; the focus of this tutorial &#8212; as well as various programming languages, including R and Julia.<ref type="footnotemark" target="#1"/> A wide variety of graphs is available through Plotly libraries, ranging from the statistical or scientific to the financial or geographic. These graphs can be displayed using various methods, including Jupyter notebooks, HTML files, and web applications produced with Plotly's Dash framework. Static (non-interactive) graphs can also be exported either as raster or vector images.</p>
<div class="alert alert-warning">
<b>Throughout this lesson, Plotly graphs will be displayed as static images. To access their interactive features, either click on the image or the link in the caption below the image.</b>
</div>
</div><div n="2"><head>Plotly's Python Graphing Library: Plotly Express vs. Plotly Graph Objects vs. Plotly Dash</head>
<p>To understand how to use Plotly, it is vital to understand the differences between Plotly Express, Plotly Graph Objects, and Plotly Dash.</p>
<p>Essentially, these are three distinct &#8212; but often overlapping &#8212; Plotly modules with their own use cases:</p>
<ul>
<li>Plotly Express (<code type="inline">plotly.express</code>, usually imported as <code type="inline">px</code>) is an accessible, high-level interface for creating data visualizations, offering around 30 different graph types. The module provides functions which create figures in just one line of code (although more lines are required for certain customizations), making graphs quick and easy to create. Since this is a 'high-level' interface, users do not need to interact with the underlying data structure of graphs when using <code type="inline">plotly.px</code>. Plotly recommends that new users start with Express before working directly with Plotly Graph Objects.</li>
<li>Plotly Graph Objects (<code type="inline">plotly.graph_objects</code>, usually imported as <code type="inline">go</code>) are the actual  figures created and rendered by Plotly 'under the hood': in essence, when a user creates a figure in <code type="inline">plotly.px</code>, Plotly will generate a 'Graph Object' to store the graph's data. These data include the information visualized in the graph as well as various attributes such as graph colors, sizes, and shapes. It is therefore possible to create visualizations with the lower-level <code type="inline">plotly.go</code> module; in fact, it is possible to recreate anything made with <code type="inline">plotly.px</code> using <code type="inline">plotly.go</code>. It is generally advised to use <code type="inline">plotly.px</code> where possible, since using <code type="inline">plotly.go</code> often involves generating many lines of code. However, as we will see later, there are some specific use cases for <code type="inline">plotly.go</code>.</li>
<li>The Plotly Dash module (imported as <code type="inline">dash</code>) is a framework for building interactive web applications (typically dashboards) which can be embedded into websites and other platforms. Users often integrate figures created using <code type="inline">plotly.px</code> and/or <code type="inline">plotly.go</code> into their Dash apps, making the Plotly Python stack a full suite for creating, manipulating, and publishing interactive data visualizations. Plotly Dash is built on top of <code type="inline">React.js</code> and <code type="inline">Plotly.js</code> to enable integration with the web, meaning that users do not need to have any knowledge of Javascript, CSS or HTML (only Python).<ref type="footnotemark" target="#2"/></li>
</ul>
<p>Plotly provides comprehensive documentation for working with <link target="https://perma.cc/94J3-8LAS">Express and Graph Objects</link> and for using <link target="https://perma.cc/E7S3-6W3H">Dash</link>.</p>
</div><div n="2"><head>Why Plotly?</head>
<p>There are currently a plethora of graphing libraries available to Python users, including <link target="https://perma.cc/N3Y9-CPWN">Matplotlib</link>, <link target="https://perma.cc/3AQL-5H6C">Seaborn</link>, <link target="https://perma.cc/L2MP-43BL">Bokeh</link> and <link target="https://perma.cc/UZM9-2LBE">Pygal</link>. With so many options to choose from, users will need to select one library over another. Factors such as use case, stylistic taste, and ease of use will be important here, with each library having its own merits. Some of the notable advantages of working with Plotly include:</p>
<ul>
<li>Plotly is one of the only packages to be directed at interactive graphs: options such as Matplotlib and Pygal provide only limited interactivity (although Bokeh is also designed for interactivity and is a viable alternative)<ref type="footnotemark" target="#3"/></li>
<li>Plotly is the only Python graphing suite which facilitates both the creation of graphs and the integration of these graphs within web apps</li>
<li>Plotly has easy (seamless) integration with pandas (for example, DataFrames can be added directly into graph objects)</li>
<li>Interactive 3D graphs are available (typically not available in other libraries)</li>
<li>Plotly is simple to use (adding features like animation and dropdown bars is relatively easy)</li>
</ul>
</div></div>
      <div n="1"><head>Sample Dataset</head>
<p>The dataset for this lesson is a subset of Roger Lane's <link target="https://perma.cc/93XS-LFG4">'Homicides in Philadelphia, 1839-1932' dataset</link><ref type="footnotemark" target="#4"/>, covering only the years 1902-1932. If you wish to work along with this lesson, you can <link target="/assets/interactive-visualization-with-plotly/sample-dataset-philadelphia-homicides-1902-1932.csv">download this particular dataset directly</link>. (The corresponding 'Philadelphia homicide codebook 1902-1932' document was also consulted to verify variables in the dataset but is not required for completing this lesson.)  As its title suggests, the dataset records homicides which occurred in Philadelphia in the early twentieth century. It is informed by arrest reports filed by the Philadephia police and covers the years 1902, 1908, 1914, 1920, 1926, and 1932. In its downloaded format, the dataset contains 26 columns and 717 rows, although we will be scaling this down.</p>
</div>
      <div n="1"><head>Building Graphs with Plotly Express</head>
<div n="2"><head>Setting Up Plotly Express</head>
<ol>
<li>
<p>Before starting, you will need to install three modules to your environment:<ref type="footnotemark" target="#5"/></p>
<ul>
<li>Plotly (using the terminal command <code type="inline">pip install plotly</code>)</li>
<li>pandas (using the terminal command <code type="inline">pip install pandas</code>)<ref type="footnotemark" target="#6"/></li>
<li>Kaleido (using the terminal command <code type="inline">pip install kaleido</code>)<ref type="footnotemark" target="#7"/></li>
</ul>
</li>
<li>
<p>With these packages installed, create a new Jupyter notebook (or a new Python file in your chosen code editor). Ideally, your notebook should be stored in the same folder as the downloaded sample dataset.</p>
</li>
<li>
<p><code type="inline">import</code> these modules at the start of your new notebook:</p>
</li>
</ol>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_0" type="block" corresp="code_interactive-visualization-with-plotly_0.txt"></code></pre>
</div><div n="2"><head>Importing and Cleaning Data</head>
<p>Next, we will import and clean the Philadelphia homicide dataset using pandas. This will involve:</p>
<ul>
<li>Importing only the required columns from our dataset</li>
<li>Replacing any missing numeric values as a NumPy 'non-number' (the <code type="inline">NaN</code> data type)</li>
<li>Relabeling and removing certain data points for clarity and accuracy</li>
</ul>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_1" type="block" corresp="code_interactive-visualization-with-plotly_1.txt"></code></pre>
</div><div n="2"><head>Bar Charts</head>
<p>Now that we've created a pandas <code type="inline">DataFrame</code> for our historical homicide data, we can start building some basic graphs using Plotly Express. Let's begin by creating a bar chart to represent the count of prosecutions per type of crime. Since our existing dataset does not contain counts of offences (each row represents one individual prosecution), we will first need to create a new <code type="inline">DataFrame</code> which groups cases by offence type and provides a count:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_2" type="block" corresp="code_interactive-visualization-with-plotly_2.txt"></code></pre>
<p>The next step is to create the bar chart using this new <code type="inline">phl_by_charge</code> dataset. Notice that the graph has been saved to the variable <code type="inline">fig</code>, which is a common convention when working with Plotly:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_3" type="block" corresp="code_interactive-visualization-with-plotly_3.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-01.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-01.png" alt="Bar graph plotting Charge on the x axis, against Size on the y axis. The Charges are Abortion, Manslaughter and Murder, and the Sizes range from 0 to 500."/>
	</link>
<figcaption>
    <p>Figure 1. Simple bar graph with basic interactivity created using Plotly Express. If readers hover over the bars, they will notice floating labels appear. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-01.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>So we have our first <code type="inline">px</code> graph! Notice that this graph already has some interactivity: hovering over each bar will specify its crime type and prosecution count. Another notable feature is that users can easily save this graph (as a static image) by navigating to the top-right corner and clicking on the camera icon to download the plot as a <code type="inline">.png</code> file. In this same corner, users have the option to zoom, pan, autoscale or reset their view of the plot. These features are available throughout all the following Plotly visualizations.</p>
<p>However, this isn't the most visually appealing graph: it could use a title, some colors, and a clearer y-axis label. We could have done this when we initially created the bar chart by passing additional arguments into the <code type="inline">.bar()</code> method. We can use the <code type="inline">labels</code> argument to change the y-axis labels from 'size' to 'Count' and the <code type="inline">color</code> argument to color the bars according to a given variable (in this example, we will use the crime type, 'Charge'). To add a title, uncomment the <code type="inline">title</code> argument in the code below and add a title of your choice.</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_4" type="block" corresp="code_interactive-visualization-with-plotly_4.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-02.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-02.png" alt="Bar graph plotting Charge on the x axis, against Count on the y axis. The Charges are Abortion, Manslaughter and Murder, and the Counts range from 0 to 500. Each bar now has its own different color. The graph also features a legend which defines its color attributes."/>
	</link>
<figcaption>
    <p>Figure 2. Simple bar graph with basic interactivity created using Plotly Express. This plot is a variant of that produced in Figure 1, now featuring color attributes as well as an interactive legend which allows readers to isolate or remove data points. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-02.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>As demonstrated above, Plotly will automatically add a legend to the graph if you are dividing attributes by color (this can be avoided if desired). The legend is also interactive: clicking once on an element will remove its corresponding bar from the graph; double-clicking on an element will isolate all others.</p>
</div><div n="2"><head>Line Graphs</head>
<p>Let's move on to creating a line graph. As a general rule, Plotly Express graphs are created using the syntax <code type="inline">px.somegraph()</code>, where <code type="inline">somegraph</code> represents the graph being created. While we used the syntax <code type="inline">px.bar()</code> to create a bar chart, we will use <code type="inline">px.line()</code> to create a line graph. The exact term needed for each graph type can be found via the <link target="https://perma.cc/U4N7-2VM5">Plotly documentation</link>.</p>
<p>Our line graph will illustrate changes in prosecution rates per crime type over the research period. As before, we will need to create a new <code type="inline">DataFrame</code> which groups cases both by year and offence type:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_5" type="block" corresp="code_interactive-visualization-with-plotly_5.txt"></code></pre>
<p>Next, we will create a line graph using the <code type="inline">.line()</code> method and will use the <code type="inline">labels</code> and <code type="inline">color</code> keywords to add some formatting. Again, uncomment the <code type="inline">title</code> argument in the code below (and in subsequent code samples) if you wish to add a title:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_6" type="block" corresp="code_interactive-visualization-with-plotly_6.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-03.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-03.png" alt="Line graph plotting Charges over time. The x axis is labeled with Years 1905 to 1930, while the y axis is labeled with Count from 0 to 180. The Charges are Abortion, Manslaughter and Murder, and the Counts range from 0 to 180. The graph also features a legend which defines its color attributes."/>
	</link>
<figcaption>
    <p>Figure 3. Simple line graph with basic interactivity created using Plotly Express. Hovering over the lines at plot points invokes a floating label. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-03.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>We have now learned to create new graphs with some added formatting &#8212; but what if we wanted to add our formatting after creating the graph instead? We can use the <code type="inline">.update_layout()</code> method on our <code type="inline">fig</code> object to edit the graph at a later stage. This method can be applied to any Plotly Express graph and accepts a very wide range of adjustable parameters. As an example, let's use this method to update our font family, font colors, and the text of our title:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_7" type="block" corresp="code_interactive-visualization-with-plotly_7.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-04.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-04.png" alt="Line graph plotting Charges over time. The x axis is labeled with Years 1905 to 1930, while the y axis is labeled Count from 0 to 180. The Charges are Abortion, Manslaughter and Murder, and the Counts range from 0 to 180. The graph also features a legend which defines its color attributes and an embedded title, which reads: Fig. 4: a formatted title!"/>
	</link>
<figcaption>
    <p>Figure 4. Simple line graph with basic interactivity created using Plotly Express. Hovering over the lines at plot points invokes a floating label. This plot is a variant of that produced in Figure 3, now featuring updated font, font colors, and an embedded figure title. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-04.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div><div n="2"><head>Scatterplots</head>
<p>Scatterplots, commonly used for visualizing relationships between continuous variables, can be created with Plotly Express using the <code type="inline">.scatter()</code> method. For our sample dataset, it might be appropriate to use a scatterplot to depict the relationship between victim and assailant ages.</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_8" type="block" corresp="code_interactive-visualization-with-plotly_8.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-05.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-05.png" alt="Scatterplot graph plotting the Age of victims and accused assailants in the case of Charges of Abortion, Manslaughter and Murder. The x axis is labeled Age of Accused 10 to 100, while the y axis is labeled Victim Age 0 to 90. The graph's legend defines its color attributes."/>
	</link>
<figcaption>
    <p>Figure 5. Simple scatterplot with basic interactivity created using Plotly Express. Readers can hover over individual plot points to invoke floating labels. Additionally, an interactive legend allows isolation, comparison or removal of data categories. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-05.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>As you can see, scatterplots also contain some inherent interactivity: hovering over a unique data point will display the specific charge and the ages of both the accused and the victim. Clicking and double-clicking on the legend allows you to isolate certain elements.</p>
</div><div n="2"><head>Facet Plots</head>
<p>Facet plots are made up of the multiple subplots which a) share the same set of axes; and b) show a subset of the data (for the same set of variables). These can be made very easily in Plotly Express. First, using the same procedure as outlined in the above examples, you'll need to specify the type of graph you want to use in your subplots. Second, the <code type="inline">facet_col</code> parameter allows you to specify which variable to use for splitting the data into subplots. In the example below, a 2x1 grid of bar charts shows prosecution counts for each weapon type used by suspects in homicide cases. One bar chart provides counts for male suspects and the other for female suspects:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_9" type="block" corresp="code_interactive-visualization-with-plotly_9.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-06.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-06.png" alt="A pair of bar graphs plotting prosecution Counts for each Weapon type. The x axes are labeled Weapon, and the y axes are labeled Size (representing prosecution count). The Weapon types include guns, knives, and poison. The counts range from 0 to 250. The left graph shows Counts for gender of accused - Female, while the right graph shows counts for gender of accused - Male. The graph's legend defines its color attributes."/>
	</link>
<figcaption>
    <p>Figure 6. Two bar graph subplots with basic interactivity created using Plotly Express, separating the data between the two genders. Readers can hover over the bars to invoke floating labels. An interactive legend allows isolation, comparison or removal of data categories. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-06.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>Note that this method circumvents the need to specify your grid dimensions, as Plotly Express will automatically divide the grid into the number of categories available (in this case, a 2x1 grid &#8212; one chart for males and one for females). However, the method only works for creating a figure which contains just one type of graph. We will discuss how to create figures which contain specified dimensions and multiple types of graph in <link target="#subplots">this section</link> on using Graph Objects.</p>
</div><div n="2"><head>Adding Animations: Animation Frames</head>
<p>As we have seen, Plotly Express figures already feature some inbuilt interactivity. Yet, there are a number of other features which we could add to increase interactivity, including animation frames.</p>
<p>An animation frame depicts the way data change in relation to a certain measure. In historical research, the measure which is most likely to be useful is time, although most other numerical variables with some inherent rankability (e.g. ordinal or interval data) should work. A Plotly Express figure with an animation frame will contain an interactive toolbar which allows users not only to play/stop the animation but also to manually scroll to the data dispersion at selected points.</p>
<p>To create a figure with an animation frame, start by using the usual method outlined in the above examples to specify which type of graph is desired. Then, within that method, use the <code type="inline">animation_frame</code> parameter to specify which variable should be used for visualizing change. The example below builds a bar chart depicting changes in male and female homicide prosecutions over the sample period:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_10" type="block" corresp="code_interactive-visualization-with-plotly_10.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-07.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-07.png" alt="Amimated bar graph plotting Counts of homicide according to the Gender of accused assailants. The x axis is labeled Gender of Accused, and the y axis is labeled Count. A legend defines the bar graph's color attributes. Beneath the bar graph, there are Play and Stop buttons alongside a slider labeled with Years from 1902 to 1930. Upon initial click, the slider node is positioned at the year 1902."/>
	</link>
<figcaption>
    <p>Figure 7. Animated bar graph featuring an interactive slider created using Plotly Express. As before, readers have the option to hover over the bars to display floating labels. Readers can either invoke an animation of the graph using Play and Stop buttons, or use the slider function to manually shift their view of the data. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-07.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div><div n="2"><head>Adding Animations: Dropdown Bars</head>
<p>Dropdown bars are slightly more complicated than animation frames. They can allow users to switch between a wide variety of display options, including changing colors, lines, axes and even variables. When creating figures with dropdown bars, the first step is to create the initial graph without a dropdown bar (this will be the first graph which your users will see). In this example, we'll be working with a scatter plot which visualises the ages of perpetrators and victims, so we'll create this as follows:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_11" type="block" corresp="code_interactive-visualization-with-plotly_11.txt"></code></pre>
<p>Note that the graph has been created but is not visible since we have not used the <code type="inline">fig.show()</code> command yet. This figure will be displayed once we have added a dropdown bar in the following steps.</p>
<p>After creating our initial graph, we can use the <code type="inline">update_layout</code> method again to add a dropdown bar. This is a more complex step, since Plotly Express objects' data are nested at many levels under the hood, so we'll need to go a few layers deeper than normal to access the dropdown feature.</p>
<p>Once we have called the <code type="inline">update_layout</code> method:</p>
<ul>
<li>We first need to access the <code type="inline">updatemenus</code> parameter: this stores a list of dictionaries, each storing the metadata for various design features.</li>
<li>The only design feature we are currently interested in is the dropdown box, which is stored under the <code type="inline">buttons</code> dictionary.</li>
<li>The <code type="inline">buttons</code> key stores as its value <emph>another</emph> list of dictionaries, each representing the options available in your dropdown bar.</li>
<li>We'll need to create two <code type="inline">buttons</code> &#8212; one for the stacked bar chart and one for the pie chart &#8212; so our <code type="inline">buttons</code> list will store two dictionaries.</li>
<li>
Each of these two dictionaries will need three key-value pairs:<ul>
<li>The first, under the <code type="inline">args</code> key, will specify which type of graph to display.</li>
<li>The second, under the <code type="inline">label</code> key, will specify the text to display in the dropdown bar.</li>
<li>The third, under the <code type="inline">method</code> key, will specify how to modify the chart (update, restyle, animate, etc.).</li>
</ul>
</li>
</ul>
<p>In the example below, we will look at how to use a dropdown bar to toggle between different categories of a variable. Since our initial scatterplot displays the ages of the accused and their victims, we'll add a dropdown bar which allows users to see data points for either a) all cases, b) murder charges only, c) manslaughter charges only, or d) abortion charges only.</p>
<p>To create the dropdown, we need to take the following steps:</p>
<ul>
<li>Under the <code type="inline">label</code> key, the value will specify the text to display in the dropdown bar.</li>
<li>Under the <code type="inline">method</code> key, the value will be 'update' since we are altering the layout <emph>and</emph> the data.</li>
<li>Under the <code type="inline">args</code> key, the value (which is another list of dictionaries) will specify which data will be <code type="inline">visible</code> (more on this issue below), the title for this graph view (optional), and the titles for the x- and y-axes of this graph view (optional).</li>
</ul>
<p>You need to enter a list for the <code type="inline">visible</code> key: each item in the list indicates whether the data at that specific index should be displayed. In our example, we have partitioned our dataset into three groups: the data corresponding to murder charges, the data for the manslaughter charges, and the data for the abortion charges. As such, our list for the <code type="inline">visible</code> key should have three items. Our first <code type="inline">button</code>, which represents the first graph displayed to the user, should therefore specify <code type="inline">[True, True, True]</code> since we want all charges to be shown in that first view. However, the remaining three <code type="inline">buttons</code> will only specify <code type="inline">True</code> for one item, because we want to show the data for only one type of crime.</p>
<p>Now let's put this into practice:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_12" type="block" corresp="code_interactive-visualization-with-plotly_12.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-08.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-08.png" alt="Scatterplot graph plotting the Age of victims and accused assailants in the case of Charges of Abortion, Manslaughter and Murder. The x axis is labeled Age of Accused 10 to 100, while the y axis is labeled Victim Age 0 to 90. The graph's legend defines its color attributes. A dropdown filter offers readers the option to isolate each category of Charge or display All Charges."/>
	</link>
<figcaption>
    <p>Figure 8. Scatterplot featuring an interactive dropdown filter created using Plotly Express. This iteration of the plot also features a dropdown menu which facilitates filtering by category of Charge or to display All Charges. As before, an interactive legend allows readers to isolate, compare or remove data categories, and hover-over invokes floating labels for individual data points. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-08.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>Creating the dropdown bar in the above example provides users with the ability to isolate (and examine) a given element from the wider visualization. We visited this Plotly feature earlier when noting that double-clicking on an element in the graph's legend will remove it from the visualization. However, the dropdown menu offers an additional advantage: it provides us with the ability to create dynamic headings, which means our titles and labels change depending on which option we have selected from the dropdown box.</p>
<p>The above examples demonstrate that it is very easy to create graphs using Plotly Express and relatively simple to add interactivity such as animation frames and dropdown bars. We will now look at creating graphs with Plotly Graph Objects. Specifically, we will focus on what 'Graph Objects' are, how they work, and when (and why) you might want to create graphs using <code type="inline">plotly.go</code> instead of <code type="inline">plotly.px</code>.</p>
</div></div>
      <div n="1"><head>Building Graphs with Plotly Graph Objects</head>
<div n="2"><head>Setting Up Plotly Graph Objects</head>
<p>To start working with Plotly's Graph Objects, you'll need to import the <code type="inline">graph_objects</code> module:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_13" type="block" corresp="code_interactive-visualization-with-plotly_13.txt"></code></pre>
<div class="alert alert-warning">
Note that in a conventional `.py `script the libraries should all be imported at the start of the script.
The code to import these libraries is provided at this stage for clarity.
</div>
</div><div n="2"><head>They're All Objects! Data Structure of Plotly Graph Objects</head>
<p>As mentioned in the introduction to this lesson, all Plotly Express figures are actually Graph Objects 'under the hood'. This means that, when you create a figure using <code type="inline">plotly.px</code>, you are creating an instance of a Graph Object.</p>
<p>This becomes evident if we call the <code type="inline">type</code> function on the <code type="inline">fig</code> variable:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_14" type="block" corresp="code_interactive-visualization-with-plotly_14.txt"></code></pre>
<p>It is important to note therefore that all figures created in Plotly are effectively Graph Objects.</p>
<p>Graph Objects are represented by tree-like (hierarchical) data structures with three top levels: <code type="inline">data</code>, <code type="inline">layout</code>, and <code type="inline">frames</code>:</p>
<ul>
<li>The <code type="inline">data</code> level contains information such as the type of chart, the categories available, the data points falling under each category, whether to show the category in the legend, the types of markers being used for data points, and the text/data to display when hovering over data points.</li>
<li>The <code type="inline">layout</code> attribute contains information such as the figure dimensions, the fonts and colors used, any annotations, the coordinates of subplots, the metadata associated with any <code type="inline">buttons</code> (as discussed in a previous example), and whether any images should be used in the background.</li>
<li>The <code type="inline">frames</code> attribute stores information relating to animations used in the figure, such as the data to be displayed at each stop point on a sliding bar. This attribute will not be created unless you add an animation to the figure.</li>
</ul>
<p>It is easy to view the underlying data structure of a figure by printing it as a Python dictionary with the <code type="inline">fig.to_dict()</code> function. We can format the structure for easier reading by viewing it in JSON format with <code type="inline">fig.to_json(pretty=True)</code>. In the example below, we display only the first 500 characters to provide a sample of the output when we use this method (again using the <code type="inline">fig</code> variable we created above).</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_15" type="block" corresp="code_interactive-visualization-with-plotly_15.txt"></code></pre>
<pre><code class="language-json" xml:id="code_interactive-visualization-with-plotly_16" type="block" corresp="code_interactive-visualization-with-plotly_16.txt"></code></pre>
<p>Examining the output of a figure should help you to understand the underlying data structure and properties of a graph object. If you print the full output (using the <code type="inline">fig.to_dict()</code> method), you will notice that:</p>
<ul>
<li>Our <code type="inline">data</code> attribute stores data for each of the three categories (murder, manslaughter, and abortion) under separate dictionaries</li>
<li>The <code type="inline">data</code> attribute qualifies which type of graph is being used (in this case 'scatter')</li>
<li>The <code type="inline">layout</code> attribute contains the figure title</li>
<li>The <code type="inline">layout</code> attribute contains the data associated with the <code type="inline">buttons</code> (i.e. the dropdown bar)</li>
<li>There is no <code type="inline">traces</code> attribute since there is no animation frame associated with this figure</li>
</ul>
</div><div n="2"><head>Using Plotly Graph Objects vs. Plotly Express</head>
<p>Another key point to be aware of is that creating graphs with <code type="inline">plotly.go</code> typically requires much more code than making the same graph with <code type="inline">plotly.px</code>.</p>
<p>Consider the following example: building a simple horizontal bar chart to show male vs. female homicide prosecutions. First, let's create a <code type="inline">DataFrame</code> which tallies prosecution counts by gender:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_17" type="block" corresp="code_interactive-visualization-with-plotly_17.txt"></code></pre>
<p>Now let's build the horizontal bar chart with these data with <code type="inline">plotly.go</code>:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_18" type="block" corresp="code_interactive-visualization-with-plotly_18.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-09.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-09.png" alt="Horizontal bar chart. The x axis is labeled with Counts from 0&#10;        to 600, while the y axis is labeled Gender. The upper bar shows the number of male accused,&#10;        whereas the lower bar shows the number of female accused."/>
	</link>
<figcaption>
    <p>Figure 9. Horizontal bar chart with basic interactivity created using Plotly Graph Objects. Readers can hover over the bars to invoke floating labels. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-09.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>Note that when using Plotly Graph Objects, you can supply a title using the <code type="inline">layout</code> argument, which takes a dictionary containing the <code type="inline">title</code> keyword and its value.</p>
<p>Now, let's create the same figure using <code type="inline">plotly.px</code>:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_19" type="block" corresp="code_interactive-visualization-with-plotly_19.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-10.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-10.png" alt="Horizontal bar chart. The x axis is labeled with Counts from 0 to 600,&#10;        while the y axis is labeled Gender. The upper bar shows the number of male accused, whereas the&#10;        lower bar shows the number of female accused."/>
	</link>
<figcaption>
    <p>Figure 10. Horizontal bar chart with basic interactivity created using Plotly Express. Readers can hover over the bars to invoke floating labels. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-10.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>It becomes clear from the above examples that <code type="inline">plotly.go</code> requires more code than <code type="inline">plotly.px</code> because many features need to be manually created in <code type="inline">plotly.go</code>. Thus, it is usually better to use <code type="inline">plotly.px</code> where possible.</p>
</div><div n="2"><head>Why Use Graph Objects?</head>
<p>This leads us to a key question: if it's so much easier to create graphs using <code type="inline">plotly.px</code>, why should we bother using <code type="inline">plotly.go</code> at all? The simple answer is that there are several useful features and capabilities which are only available by using <code type="inline">plotly.go</code>. We will look at two such capabilities in this section of the tutorial: tables and subplots.</p>
</div><div n="2"><head>Tables</head>
<p>One of the most useful features provided through the <code type="inline">plotly.go</code> module is the option to create neat, interactive tables. This requires four steps:</p>
<ol>
<li>Create a new figure using the <code type="inline">.Figure()</code> method.</li>
<li>Under the <code type="inline">data</code> attribute, call the <code type="inline">.Table()</code> method to specify that the figure should be a table.</li>
<li>Within the <code type="inline">.Table()</code> method, create a <code type="inline">header</code> dictionary to store a list of column headings.</li>
<li>Also within the <code type="inline">.Table()</code> method, create a <code type="inline">cells</code> dictionary to store the data (values).</li>
</ol>
<p>It is also possible to customise it with labels, colors and alignment options.</p>
<p>In the example below, we'll create a table to store the entire Philadelphia homicides dataset:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_20" type="block" corresp="code_interactive-visualization-with-plotly_20.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-11.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-11.png" alt="Table showing a portion of the Philadelphia Homicides dataset for the year 1902. Column headers are Year, Charge, Gender of accused, Victim age, &#10;             Weapon, and Gang."/>
	</link>
<figcaption>
    <p>Figure 11. Table containing the Philadelphia Homicides dataset created with Plotly Graph Objects. Readers can
        scroll through the entire dataset as they would in a spreadsheet. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-11.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<p>As with <code type="inline">plotly.px</code>, figures created with <code type="inline">plotly.go</code> have some inherent interactivity. Tables, for example, provide users the ability to scroll through rows (either using a trackpad or the scrollbar on the right) and are therefore excellent for saving space. It is also easy to move columns around by clicking on the column headers and dragging them left or right.</p>
</div><div n="2"><head>Subplots</head>
<p>Another useful feature of the <code type="inline">plotly.go</code> module is its capacity for building subplots. Although <code type="inline">plotly.px</code> can build facet plots, these are comparatively limited, since they must all share the same graph type, axes and variables. Subplots, on the other hand, allow you to create a grid containing different types of graphs with their own axes and variables, which ends up looking like a sort of 'dashboard'.</p>
<p>Since the code is particularly lengthy for creating subplots, this example will be provided on a step-by-step basis. We will create a 3x1 grid containing three different charts: the first will be a standard bar chart to quantify prosecution counts for male vs. female suspects; the second will be a line graph showing changes in male vs. female prosecutions over time; and the third will be a boxplot showing the minimum, inter-quartile range and maximum ages of male vs. female suspects.</p>
<div n="3"><head>Step 1: Import the subplots module and get data</head>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_21" type="block" corresp="code_interactive-visualization-with-plotly_21.txt"></code></pre>
</div><div n="3"><head>Step 2: Create an empty subplot with a 3x1 grid using the <code type="inline">make_subplots()</code> function</head>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_22" type="block" corresp="code_interactive-visualization-with-plotly_22.txt"></code></pre>
</div><div n="3"><head>Step 3: Add the first graph (the bar chart) using the <code type="inline">.add_trace()</code> method</head>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_23" type="block" corresp="code_interactive-visualization-with-plotly_23.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-12.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-12.png" alt="A three-column plot with a bar chart in the left column and two empty columns on its right. The&#10;        y axis is labeled with counts from 0 to 600, while the bar charts on the x axis are labeled (from left to&#10;        right) Female and Male."/>
	</link>
<figcaption>
    <p>Figure 12. A three-column plot with basic interactivity created using Plotly Graph Objects, with a bar chart on the left showing the number of accused by
        gender, and two empty columns on the right. Readers can hover over the bars to invoke floating labels. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-12.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<div class="alert alert-warning">
Note: If you are creating a subplot using Jupyter Notebook, rerunning the code may duplicate the trace you added and thereby add more items to the legend. If you need to rerun the code, it is best to restart the kernel first.
</div>
</div><div n="3"><head>Step 4: Add the second graph (the line graph)</head>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_24" type="block" corresp="code_interactive-visualization-with-plotly_24.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-13.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-13.png" alt="A three-column plot with a bar chart in the left column and a line graph in the middle column. The bar chart's&#10;        y axis is labeled with counts from 0 to 600, while the x axis is labeled (from left to right) Female and Male.&#10;        The line graph's x axis is labeled with years from 1900 to 1930 and the y axis is labeled with counts from 0 to 150. A green line indicates the number &#10;        of male accused, and a red line indicates the number of female accused. A legend in the top right provides the color attributes for the bars in the bar &#10;        chart and the lines in the line chart."/>
	</link>
<figcaption>
    <p>Figure 13. A three-column plot created using Plotly Graph Objects, with a bar chart showing the number of accused by
        gender and a line graph showing the number of male and female accused by year. Hover-over invokes floating labels for each bar and individual data points. The third column is still empty. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-13.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
<div class="alert alert-warning">
Note that if you did not import `plotly.graph_objs.scatter.Line`, you may get the following warning (which you can safely ignore):
<pre><code xml:id="code_interactive-visualization-with-plotly_25" type="block" corresp="code_interactive-visualization-with-plotly_25.txt"></code></pre>
</div>
</div><div n="3"><head>Step 5: Add the final graph (the boxplot)</head>
<p>We have not looked at boxplots yet, but they are created in a similar way to other graphs and have similar interactive behaviour (e.g. scrolling over a box will show the minimum, maximum, median, and interquartile range of the data).</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_26" type="block" corresp="code_interactive-visualization-with-plotly_26.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-14.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-14.png" alt="A three-column plot with a bar chart in the left column, a line graph in the middle column and a box plot in the right column. The bar chart's&#10;        y axis is labeled with counts from 0 to 600, while the x axis is labeled (from left to right) Female and Male.&#10;        The line graph's x axis is labeled with years from 1900 to 1930 and the y axis is labeled with counts from 0 to 150. A green line indicates the number &#10;        of male accused, and a red line indicates the number of female accused.&#10;        The x axis of the box plot shows one box for female accused on the left and another box for male accused on the right. The y axis indicates age between &#10;        0 and 100. The legend indicates the color attributes and&#10;        labels for all three subplots."/>
	</link>
<figcaption>
    <p>Figure 14. A three-column plot created using Plotly Graph Objects, with a bar chart showing the number of accused by
        gender, a line graph showing the number of male and female accused by year, and a box plot showing the
        distribution and outlier values of male and female accused by age. Hover-over invokes floating labels for each bar or individual data point and shows 
        the minimum, maximum, median, and interquartile range on the box plot. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-14.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div><div n="3"><head>Step 6: Format the figure</head>
<p>There are still some tweaks needed, like adding a main title for the figure and subtitles for each subplot. You might also want to change fonts, text positioning, and the figure size &#8212; you can use the <code type="inline">.update_layout()</code> method to change these properties:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_27" type="block" corresp="code_interactive-visualization-with-plotly_27.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-15.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-15.png" alt="A three-column plot with a bar chart in the left column, a line graph in the middle column and a box plot in the right column. The bar chart's&#10;        y axis is labeled with counts from 0 to 600, while the x axis is labeled (from left to right) Female and Male.&#10;        The line graph's x axis is labeled with years from 1900 to 1930 and the y axis is labeled with counts from 0 to 150. A green line indicates the number &#10;        of male accused, and a red line indicates the number of female accused.&#10;        The x axis of the box plot shows one box for female accused on the left and another box for male accused on the right. The y axis indicates age between &#10;        0 and 100. The legend indicates the color attributes and&#10;        labels for all three subplots. The subtitles: Suspect gender, Year, and Suspect gender are placed under each subplot (from left to&#10;        right)."/>
	</link>
<figcaption>
    <p>Figure 15. A three-column plot created using Plotly Graph Objects, with a bar chart showing the number of accused by
        gender, a line graph showing the number of male and female accused by year, and a box plot showing the
        distribution and outlier values of male and female accused by age. This plot is a variant of that produced in
        Figure 14, with added subtitles for each subplot. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-15.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div><div n="3"><head>Step 7: Add annotations to the line graph</head>
<p>Since the legend has been removed, it's now impossible to distinguish between the lines which represent males and those which represent females in the line graph. We can use the <code type="inline">.update_layout()</code> method to add annotated arrows pointing to each line:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_28" type="block" corresp="code_interactive-visualization-with-plotly_28.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-16.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-16.png" alt="A three-column plot with a bar chart in the left column, a line graph in the middle column and a box plot in the right column. The bar chart's&#10;        y axis is labeled with counts from 0 to 600, while the x axis is labeled (from left to right) Female and Male.&#10;        The line graph's x axis is labeled with years from 1900 to 1930 and the y axis is labeled with counts from 0 to 150. A green line indicates the number &#10;        of male accused, and a red line indicates the number of female accused. An arrow with the label Males points to the green line and an arrow&#10;        with the label females points to the red line.&#10;        The x axis of the box plot shows one box for female accused on the left and another box for male accused on the right. The y axis indicates age between &#10;        0 and 100. The legend indicates the color attributes and&#10;        labels for all three subplots. The subtitles: Suspect gender, Year, and Suspect gender are placed under each&#10;        subplot (from left to right)."/>
	</link>
<figcaption>
    <p>Figure 16. A three-column plot created using Plotly Graph Objects, with a bar chart showing the number of accused by
        gender, a line graph showing the number of male and female accused by year, and a box plot showing the
        distribution and outlier values of male and female accused by age. This plot is a variant of that produced in
        Figure 15, with added annotations in the line graph. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-16.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div><div n="3"><head>Step 8: Add annotations below the figure</head>
<p>We might want to add annotations below the figure to specify the focus of each subplot (particularly useful for academic publishing), which we can do using the <code type="inline">.add_annotation()</code> method:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_29" type="block" corresp="code_interactive-visualization-with-plotly_29.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-17.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-17.png" alt="A three-column plot with a bar chart in the left column, a line graph in the middle column and a box plot in the right column. The bar chart's&#10;        y axis is labeled with counts from 0 to 600, while the x axis is labeled (from left to right) Female and Male.&#10;        The line graph's x axis is labeled with years from 1900 to 1930 and the y axis is labeled with counts from 0 to 150. A green line indicates the number &#10;        of male accused, and a red line indicates the number of female accused. An arrow with the label Males points to the green line and an arrow&#10;        with the label females points to the red line.&#10;        The x axis of the box plot shows one box for female accused on the left and another box for male accused on the right. The y axis indicates age between &#10;        0 and 100. The legend indicates the color attributes and&#10;        labels for all three subplots. The subtitles: Suspect gender, Year, and Suspect gender are placed under each&#10;        subplot (from left to right). An additional annotation below all three subplots reads Male vs. female suspects&#10;        (left); male vs. female suspects over time (middle); age distributions of male vs. female suspects (right)."/>
	</link>
<figcaption>
    <p>Figure 17. A three-column plot created using Plotly Graph Objects, with a bar chart showing the number of accused by
        gender, a line graph showing the number of male and female accused by year, and a box plot showing the
        distribution and outlier values of male and female accused by age. This plot is a variant of that produced in
        Figure 16, with an additional annotation added below all three subplots. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-17.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div></div></div>
      <div n="1"><head>Viewing and Exporting Figures</head>
<p>In the previous sections of the lesson, we saw how to create and modify interactive graphs using both the <code type="inline">plotly.px</code> and <code type="inline">plotly.go</code> modules. We will next consider how to view and export these graphs for publications or other research outputs.</p>
<p>The methods discussed here will use a basic line graph, identical to that created earlier in the tutorial (see Figure 3). Let's start by recreating that figure:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_30" type="block" corresp="code_interactive-visualization-with-plotly_30.txt"></code></pre>
<div n="2"><head>Viewing Figures</head>
<p>As we have seen throughout this lesson, the <code type="inline">.show()</code> method can be used to output a figure. By default, this method uses the inbuilt Plotly renderer and therefore provides interactivity:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_31" type="block" corresp="code_interactive-visualization-with-plotly_31.txt"></code></pre>
<figure style="">
<link style="" target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-03.html">
    <img src="/images/interactive-visualization-with-plotly/en-or-interactive-visualization-with-plotly-03.png" alt="Bar graph plotting Charge on the x axis, against Size on the y axis. The Charges are Abortion,&#10;        Manslaughter and Murder, and the Sizes range from 0 to 500."/>
	</link>
<figcaption>
    <p>Figure 18. Reproduction of Figure 3, illustrating the <code type="inline">fig.show()</code> method. <link target="/assets/interactive-visualization-with-plotly/interactive-visualization-with-plotly-03.html">Click to explore an interactive variant of this plot</link>.</p>
</figcaption>
</figure>
</div><div n="2"><head>Exporting Figures</head>
<p>Plotly figures can be exported either as interactive or static (non-interactive) graphs. Interactive graphs may be useful for research websites and (some) digital publications, whereas static graphs are appropriate for print publications.</p>
<div n="3"><head>Exporting as HTML</head>
<p>Exporting figures as HTML retains their interactivity when viewed in a web browser. Any figure can be saved as an HTML file by using the <code type="inline">.write_html()</code> method:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_32" type="block" corresp="code_interactive-visualization-with-plotly_32.txt"></code></pre>
<p>By default, any exported figure will be saved in the same folder as that in which your script is stored. If you want to store the figure elsewhere (a different folder), you can specify the exact directory when you specify the file name (for example, <code type="inline">fig.write_html("your_path/your_file_name.html")</code>).</p>
</div><div n="3"><head>Exporting static images</head>
<p>Plotly provides numerous options for exporting both raster images (<code type="inline">.png</code> or <code type="inline">.jpg</code>) and vector images (<code type="inline">.pdf</code> or .<code type="inline">svg</code>). To do this, use the <code type="inline">.write_image()</code> function and specify the image type within the file name:</p>
<pre><code class="language-python" xml:id="code_interactive-visualization-with-plotly_33" type="block" corresp="code_interactive-visualization-with-plotly_33.txt"></code></pre>
</div></div></div>
      <div n="1"><head>Summary</head>
<p>Plotly offers the ability to create publication-quality, interactive figures using Python and other programming languages. This lesson provides an overview of what Plotly is, why it's useful, and how it can be used with Python. It also demonstrates the different modules in the Plotly framework (Plotly Express and Plotly Graph Objects) and the methods required to create, edit, and export data visualizations. The key syntaxes covered in this lesson are:</p>
<ul>
<li>Installing Plotly using <code type="inline">pip install plotly</code></li>
<li>Importing Plotly Express and Plotly Graph Objects using <code type="inline">import plotly.express as px</code> and <code type="inline">import plotly.graph_objects as go</code></li>
<li>
With Plotly Express:<ul>
<li>Creating graphs using <code type="inline">px.bar()</code>, <code type="inline">px.line()</code>, and <code type="inline">px.scatter()</code></li>
<li>Adding features to graphs using parameters such as <code type="inline">title</code>, <code type="inline">labels</code>, <code type="inline">color</code>, and <code type="inline">animation_frame</code></li>
<li>Using <code type="inline">.update_layout()</code> to edit figures after creation and/or add dropdown bars</li>
</ul>
</li>
<li>
With Plotly Graph Objects:<ul>
<li>Recognizing the <code type="inline">data</code>, <code type="inline">layout</code>, and <code type="inline">traces</code> attributes as key underlying structure of a graph object</li>
<li>Creating new (empty) graph objects with <code type="inline">go.Figure()</code></li>
<li>Creating graphs using <code type="inline">go.Bar()</code>, <code type="inline">go.Table()</code>, <code type="inline">go.Line()</code>, and <code type="inline">go.Box()</code></li>
<li>Editing features using the <code type="inline">layout</code> attribute</li>
<li>Creating subplots (importing the subplots module using <code type="inline">from plotly.subplots import make_subplots</code>, implementing subplots with <code type="inline">make_subplots()</code> function, and adding traces to subplots using <code type="inline">.add_trace()</code> method)</li>
<li>Using <code type="inline">.update_layout()</code> to edit figures after creation</li>
</ul>
</li>
<li>Exporting figures created with Express or Graph Objects using <code type="inline">.write_html()</code> and <code type="inline">.write_image()</code></li>
</ul>
</div>
      <div n="1"><head>Endnotes</head>
<p><note id="1"> Under the hood, these libraries are built on top of the Plotly JavaScript library.</note>
<note id="2"> Plotly Dash is outside the scope of this lesson, which instead focuses on <code type="inline">plotly.px</code> and <code type="inline">plotly.go</code>.</note>
<note id="3"> For further information on Bokeh, see Charlie Harper's lesson on <link target="/en/lessons/visualizing-with-bokeh">Visualizing Data with Bokeh and Pandas</link> here on <emph>Programming Historian</emph>.</note>
<note id="4"> The dataset and its related documents are available freely via the <link target="https://perma.cc/WCW9-YRX9">Historical Violence Database</link> project organized by Ohio State University and licensed under a <link target="https://perma.cc/3BYZ-UDYW">Creative Commons Attribution-Noncommercial-Share Alike 3.0 United States License</link>. </note>
<note id="5"> If you already work with Jupyter notebooks, there is a good chance that other dependencies are already installed. However, if you are working in a clean Python environment or in a code editor like VS Code, it may also be necessary to run <code type="inline">pip install ipykernel</code> and <code type="inline">pip install nbformat</code>.</note>
<note id="6"> We will also be using the NumPy module, but this is automatically installed with the installation of pandas.</note>
<note id="7"> Kaleido is a Python library for generating static images (e.g. JPG and SVG files) and will therefore be needed when exporting non-interactive graphs.</note></p>
</div>
    </body>
  </text>
</TEI>
