<TEI xmlns="http://www.tei-c.org/ns/1.0" xml:id="gravity-model">
    <teiHeader>
        <fileDesc>
            <titleStmt>
                <title>Introduction to Gravity Models of Migration &amp;amp; Trade</title>
                <author role="original_author">Adam Crymble</author>
                <editor role="reviewers">
                    <persName>Oliver Duke-Williams</persName>
                    <persName>Sylvia Fernández Quintanilla</persName>
                </editor>
                <editor role="editors">Anna-Maria Sichani</editor>
            </titleStmt>
            <publicationStmt>
                <distributor>Programming Historian</distributor>
                <idno type="doi">10.46430/phen0085</idno>
                <date type="published">03/18/2019</date>
            </publicationStmt>
            <sourceDesc>
                <p>Born digital, in a markdown format. This lesson is original.</p>
            </sourceDesc>
        </fileDesc>
        <profileDesc>
            <abstract>
                <p>This lesson introduces gravity models as a means for determining the probable distribution of entities across space in historical datasets. It does so through a case study of historical migration patterns.
</p>
            </abstract>
            <textClass>
                <keywords>
                    <term xml:lang="en">data-manipulation</term>
                </keywords>
            </textClass>
        </profileDesc>
    </teiHeader>
    <text xml:lang="en">
        <body>
            <div type="2">
                <head>The Historical Problem &amp; Mathematical Solution</head>
                <p>For every 1,000 migrants who moved to London in the 1770s-80s, how many would we expect to come from each English county? For every 1,000 tons of coffee exported from Colombia in 1950, how much would we expect to go to each of the Western Hemisphere's 21 independent countries?</p>
                <p>Both of these historical questions are about movements - people or goods - and are concerned with the resultant distribution from those movements. There are many ways to answer these types of questions, the simplest of which is to assume uniform distribution (25.64 migrants per county, or 47.61 tons of coffee per country). But this is unlikely to be accurate.</p>
                <p>Standardising by population may improve accuracy of estimates. How many migrants there were per 10,000 inhabitants? Or how many pounds of coffee was imported per person? While better, it does not provide the full picture because other forces are influencing the outcome (Figure 1). In the first example, the English county of Westmorland had a relatively small population (38,000), and it was also quite far from London (365km). Because of this and other factors, it was unlikely to send as many migrants to London as Berkshire, which had more people (102,000) and was proximal (62km). Population and distance from London were almost certainly factors affecting the number of migrants.</p>
                <p>For coffee exports, population is also important. In 1950, the population of Canada (14 million) and the United States (152 million) meant that it was unlikely that they imported the same amount of coffee. Nevertheless, with no domestic supply and a strong coffee-drinking culture, Canada and the United States probably had more in common than they do with many South and Central American countries, who grew their own coffee and had less need to import it. So population, coffee culture, and domestic supply are all relevant variables, as are other factors (Figure 1).</p>
                <figure>
                    <desc>Figure 1: Example A - A map of historic English counties, showing Westmorland, Berkshire, and London. It would be unlikely for both counties to send the same number of migrants to London given differences in population and distance from the capital. Example B - Some of the countries are coffee-producing, and that would affect their need to import, skewing the distribution. Meanwhile, population varies widely between countries. 'person' icon by Jens Tärning, 'Coffee Bean' by Abdo, 'Cup' by alvianwijaya, all from the *Noun Project*.</desc>
                    <graphic url="figure1.png"/>
                </figure>
                <p>To arrive at a more realistic distribution, the approach must take into account several relevant influencing factors. One such approach is a "gravity model", a mathematical formula based on <ref target="https://en.wikipedia.org/wiki/Regression_analysis">regression analysis</ref> and <ref target="https://en.wikipedia.org/wiki/Probability_theory">probability theory</ref> that incorporates relevant push, pull, or economic factors into consideration when suggesting a probable distribution between the various territories.</p>
                <p>The term "gravity" invokes the idea of forces pulling entities together, as in <ref target="https://en.wikipedia.org/wiki/Newton%27s_law_of_universal_gravitation">Isaac Newton's falling apple</ref>. In that case, the relevant factors for calculating gravitational pull were the mass of the apple, the mass of the earth, and the distance between the two. Assuming environmental factors are constant, the apple will always experience the same gravitational pull (or close enough for our purposes). This "universal" law of gravity is represented mathematically by a simple formula:</p>
                <p>$$F = G \frac{m_{1}m_{2}}{r_{2}}$$</p>
                <p>A gravity model of migration or trade is similar in its aim (seeking to understand and measure the forces influencing movement), but is unable to attain the same degree of reliability or repeatability because it measures the results of a series of unpredictable human decisions based on <ref target="https://en.wikipedia.org/wiki/Free_will">free will</ref> rather than the <ref target="https://en.wikipedia.org/wiki/Physical_law">laws of physics</ref>. The model is fairly good at predicting how populations will act, but any number of things could influence individual decisions, meaning that the resultant distribution will always be somewhat unpredictable. If you could re-run a realistic migration simulation, you would always end up with slightly different results because you can never account for every relevant variable. Nor do you necessarily want to. The goal is not to build an overly <ref target="https://en.wikipedia.org/wiki/Determinism">deterministic</ref> view of migration or trade, but to get enough information about the key influences to have a historical conversation about meaningful patterns and unexpected discoveries.</p>
                <p>So gravitational pull and gravity models are different. As physics is dependable and humans are not, the formula for gravitational pull is simple algebra, whereas the one for gravity modelling of migration or trade draws upon probability theory and is thus part of a different branch of mathematics. Despite this, the term "gravity" is a useful reminder that this approach is about understanding the forces that influence movement.</p>
                <div>
 A gravity model's goal is to tell the user: given a number of <hi rend="bold">influencing forces</hi> (distance, cost of living) affecting migration or movement of a <hi rend="bold">large number of entities of the same type</hi> (people, coffee beans, widgets) <hi rend="bold">between a set number of points</hi> (39 counties and London or Colombia and various countries), the model can <hi rend="bold">suggest the most probable distribution</hi> of those people, coffee beans, or widgets.
<p>It operates on the principle that if you know the volume of movement, and you know the factors influencing it, you can predict with reasonable accuracy the outcome of even complex movement within a confined system.</p>
                </div>
                <p>If you also know how many migrants <emph>did</emph> come from each county, or now much coffee <emph>did</emph> go to each nation, the model allows you to identify regional anomalies by comparing the estimated to the observed values. Those might be regions that, given the various contributing factors, were sending more or fewer migrants than we would expect, or consuming disproportionately more or less coffee. These anomalies can then become the subject of scholarly investigation, leading to historical conclusions.</p>
            </div>
            <div type="2">
                <head>The Need for a Tutorial</head>
                <p>While popular with some geographers and economists, and while gravity models have tremendous potential for historians, they have as yet been used very rarely in historical studies. The author was only able to identify two historical migration studies that employed a gravity model as an integral part of the analysis:</p>
                <list type="ordered">
                    <item>
                        <p>A.A. Lovett, I.D. Whyte, and K.A. Whyte, "Poisson regression analysis and migration fields: the example of the apprenticeship records of Edinburgh in the seventeenth and eighteenth centuries", <emph>Transactions of the Institute of British Geographers</emph>, 10 (1985), pp. 317–32.</p>
                    </item>
                    <item>
                        <p>Adam Crymble, Adam Dennett, Tim Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, 71, 3 (2018), pp. 747-771: <ref target="https://doi.org/10.1111/ehr.12569">https://doi.org/10.1111/ehr.12569</ref>.</p>
                    </item>
                </list>
                <p>Given the lack of exposure historians have to gravity models, this tutorial seeks to provide an accessible introduction by providing a walk-through of the example used in my article listed immediately above. This approach allows the reader to try a working gravity model, with the aim of understanding what it is and how it is put together, while also being able to turn to the published literature to see how the modelling process led to scholarly findings.</p>
            </div>
            <div type="2">
                <head>Lesson Requirements</head>
                <div type="3">
                    <head>Software</head>
                    <p>You will require the following software:</p>
                    <list type="unordered">
                        <item>
                            <emph>R</emph> programming language</item>
                        <item>
                            <emph>MASS</emph> package for R</item>
                        <item>Spreadsheet (Excel or Open Office)</item>
                        <item>a scientific calculator (or online equivalent)</item>
                    </list>
                    <p>The <ref target="https://www.r-project.org/">
                            <emph>R</emph>
                        </ref> programming language is a specialist language designed for statistical work. <ref target="https://cran.r-project.org/web/packages/MASS/index.html">
                            <emph>MASS</emph>
                        </ref> is an add-on code package for <emph>R</emph> that allows us to conduct certain advanced statistical processes very efficiently. <emph>MASS</emph> is short for "Modern Applied Statistics with S" and was written in 2002 by William Venables and Brian Ripley. There are many sets of instructions online for how to install <emph>R</emph> and <emph>R</emph> packages, including Taryn Dewar's tutorial on <ref target="/en/lessons/r-basics-with-tabular-data">R Basics with Tabular Data</ref>.</p>
                    <p>The tutorial also uses a spreadsheet programme, and a scientific calculator or software or a website that can replicate one. Your calculator should have at least the options highlighted yellow in Figure 2.</p>
                    <figure>
                        <desc>Figure 2: The Google calculator, with the keys used in this tutorial highlighted in yellow. You can use any calculator that has these keys as a minimum.</desc>
                        <graphic url="figure2.png"/>
                    </figure>
                    <p>The associated material for use in this tutorial is introduced as needed. You can also download it all here:</p>
                    <list type="unordered">
                        <item>
                            <ref target="/assets/gravity-model/VagrantsExampleData.csv">VagrantsExampleData.csv</ref>
                        </item>
                        <item>
                            <ref target="/assets/gravity-model/weightingCalculation.r">weightingCalculation.r</ref>
                        </item>
                    </list>
                </div>
                <div type="3">
                    <head>Mathematical Concepts</head>
                    <p>This tutorial uses a number of mathematical concepts and operations. To understand a gravity model and how it works, you will have to become comfortable with the following concepts and mathematical operations (though it is possible to follow along without all of this knowledge):</p>
                    <list type="unordered">
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">Cartesian coordinates</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Exponential_function">exponential function</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Mean">mean</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Natural_logarithm">natural logarithm</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Order_of_operations">order of operations</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson's correlation coefficient</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Probability_distribution">probability distribution</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Regression_analysis">regression analysis</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Slope">slope</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Square_root">square root</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Standard_deviation">standard deviation</ref>
                        </item>
                        <item>
                            <ref target="https://en.wikipedia.org/wiki/Y-intercept">y-intercept</ref>
                        </item>
                    </list>
                </div>
            </div>
            <div type="2">
                <head>The Historical Case Study</head>
                <p>While gravity models can be used in a range of different migration and trade studies, this tutorial uses a specific historical case study of migration based on the history of vagrancy in eighteenth century London as an example for readers to follow. The materials used in this case study are built from:</p>
                <p>1 - Adam Crymble, Adam Dennett, Tim Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, 71, 3 (2018), pp. 747-771: <ref target="https://doi.org/10.1111/ehr.12569">https://doi.org/10.1111/ehr.12569</ref> (Paywall until July 2019).</p>
                <p>2 - Adam Crymble, Louise Falcini, Tim Hitchcock, "Vagrant Lives: 14,789 Vagrants Processed by the County of Middlesex, 1777-1786", <emph>Journal of Open Humanities Data</emph>, vol. 1, no. 1 (2015), <ref target="http://doi.org/10.5334/johd.1">http://doi.org/10.5334/johd.1</ref>.</p>
                <p>The Vagrancy Act of 1744 gave communities in England and Wales the right to expel outsiders back from whence they came. This was an important right because welfare was distributed locally at the time, and it was paid for by local taxes with the intention of supporting local people. That meant that a large influx of poor outsiders could financially cripple communities that attracted a lot of migration (such as those in London). This restriction on internal migration was only really used against the poor, and constables and local magistrates had tremendous powers of discretion over who they labelled a "vagrant" and who they left alone. As of the time of writing, a version of this law is still on the books in England, and it is still used by the police to arrest people who are begging or who they otherwise feel need to be removed from a situation. People in the late eighteenth century who were arrested under the 1744 act are therefore evidence of internal migration between the various counties of England and London. The question is: were any counties sending more or fewer vagrants to London than we would expect?</p>
                <p>This example will model the probable distribution of 3,262 lower-class migrants to London between 1777 and 1786. These "vagrants" were probably visibly poor, but not necessarily to the degree of beggarliness or homelessness. All of them were forcibly expelled from London under the 1744 Vagrancy Act, and sent back to their place of origin.<ref type="footnotemark" target="#note_1"/> They represent a group of failed migrants to the city, and understanding their distribution means we can identify which parts of England sent proportionately higher numbers of vagrants to London. In turn this can help us to understand which parts of the country were under economic stress.</p>
                <p>A sample of the primary sources that detail these individuals' journeys can be seen in Figure 3. At the time of their expulsion from London, each vagrant had his or her name and place of origin recorded, providing a unique account of the lives of thousands of failed migrants to the London area.</p>
                <figure>
                    <desc>Figure 3: A sample list of vagrants expelled from Middlesex. 'Middlesex Sessions Papers - Justices' Working Documents', (January 1778), *London Lives, 1690-1800*, LMSMPS50677PS506770118 (www.londonlives.org, version 2.0, 18 August 2018), London Metropolitan Archives.</desc>
                    <graphic url="figure3.jpg"/>
                </figure>
                <p>As part of the "<ref target="http://www.migrants.adamcrymble.org/the-project/">Vagrant Lives</ref>" project, the original vagrancy lists were converted into a scholarly dataset and published as:</p>
                <list type="unordered">
                    <item>Adam Crymble, Louise Falcini, Tim Hitchcock, "Vagrant Lives: 14,789 Vagrants Processed by the County of Middlesex, 1777-1786", <emph>Journal of Open Humanities Data</emph>, vol. 1, no. 1 (2015), <ref target="http://doi.org/10.5334/johd.1">http://doi.org/10.5334/johd.1</ref>.</item>
                </list>
                <p>Readers are invited to download and explore this <ref target="https://zenodo.org/record/1217600">published dataset</ref> and its documentation to understand the types of primary sources being modelled in this example.</p>
                <div type="3">
                    <head>Important Notes about the Dataset:</head>
                    <p>Gravity models will only return meaningful results if constructed for case studies that meet certain conditions. While it is not feasible to provide an exhaustive list, there were a few decisions the authors had to make when working with this dataset of vagrants, and they are worth repeating as a warning to readers who might be thinking about their own study.</p>
                    <list type="unordered">
                        <item>
                            <p>These historical data in the "Vagrant Lives" dataset are not complete. 42 of a possible 65 such lists survive for the period 1777 to 1786, which represents approximately 75% of all vagrants expelled for whom there should be a record. The remaining primary sources are lost. It is important that the records one uses are either a <ref target="https://en.wikipedia.org/wiki/Sample_(statistics)">complete or representative sample</ref>. The authors of the dataset believe the 75% of records that survived are representative of what we would find if we had all 100%. If this was not the case, modelling may not be appropriate.</p>
                        </item>
                        <item>
                            <p>The authors believe that migrants from all counties were equally likely to be arrested as vagrants, and that the total number of vagrants from a county is proportional to the amount of migration from that county. In other words, we do not believe that people from Cornwall, for example, were more likely to be arrested as vagrants than people from Leicestershire. Again, if this was not the case, modelling may not be appropriate.</p>
                        </item>
                        <item>
                            <p>The dataset contains details of vagrants from 32 of the 39 historic English counties (see Figure 4). The remaining 7 counties were not included in the analysis because of possibly incomplete data, and the reasons for this are cited in the original paper.<ref type="footnotemark" target="#note_2"/> If the missing counties had not been geographically clustered as they are, a gravity model might not have been appropriate.</p>
                        </item>
                        <item>
                            <p>The dataset contains very few "recidivists" - repeat offenders. Some migration channels in various points in history and places in the world include a great deal of seasonal, temporary, or repeat migration. If the migration you are attempting to model includes any of these, and you believe them to be distributed unevenly across your possible origin and destinations, a gravity model might not be appropriate.</p>
                        </item>
                    </list>
                    <figure>
                        <desc>Figure 4: A map of historic English counties, showing counties excluded from the analysis</desc>
                        <graphic url="figure4.png"/>
                    </figure>
                    <list type="unordered">
                        <item>A model of this sort should always contain moving entities that are of the same type as one another whenever possible (coffee beans and coffee beans, not coffee beans and bananas). Despite the fact that all of these individuals appear on the same types of lists, the "vagrants" in the sources represent three distinct types of people.</item>
                    </list>
                    <list type="ordered">
                        <item>The "vagabond poor" - the stereotypical poor individual from elsewhere.</item>
                        <item>Demobilised soldiers who used the vagrancy system for a free ride home.</item>
                        <item>Individuals expelled back to London from other counties (not relevant to the original research question and excluded here).</item>
                    </list>
                    <p>The first two groups represent migrants from elsewhere, but because they came to London via quite different paths - one as an economic migrants and one dumped on the docks after finishing work overseas - they were modelled separately in the original article. Splitting these two types of vagrants into two models meant more defensible results. Those were not the only two subsets we could have modelled, as any subset for which there was an intellectual case would also do (e.g. men and women).</p>
                    <p>For the sake of brevity, this tutorial will take readers through the modelling of the 3,262 "vagabond poor", though the process for modelling the demobilised soldiers is exactly the same.</p>
                </div>
                <div type="3">
                    <head>Preview of the Finished Model</head>
                    <p>The result of the modelling process can be seen in Figure 5. As you can see on the map, there are in fact regional anomalies. There is a cluster of counties in the West Midlands (four blue counties) that were over-sending migrants to London. There were also a number of counties in the centre of the map and towards the north that were under-sending migrants (red), and there are a few regional anomalies sprinkled around the country. The remainder of this tutorial will walk you through the process of making those types of discoveries from a set of historical data, starting with the mathematics that allow us to do this type of work.</p>
                    <figure>
                        <desc>Figure 5: The anomalous counties in the original study, showing areas with fewer migrants than expected, more migrants than expected, and about the expected number.</desc>
                        <graphic url="figure5.png"/>
                    </figure>
                    <p>The formula used to arrive at that result is provided below, with the following sections outlining the origins and rationale of that formula.</p>
                    <p>$$μ_{ij} = exp(β_{0} + β_{1}ln(P_{i}) + β_{2}ln(d_{ij}) + β_{3}Wh_{i} + β_{4}Wa_{i} + β_{5}WaT_{i})$$</p>
                </div>
            </div>
            <div type="2">
                <head>Regression Modelling, and the Mathematics Behind the Model</head>
                <p style="alert alert-warning">
                    <p>The following section outlines the intellectual origins of the gravity model formula, and will help you to understand the branch of mathematics from which it comes. This will allow you to develop the vocabulary and background needed to discuss the model's mathematics at a basic level. If you are not familiar or comfortable with mathematical operations, you may find it helpful to read or refresh your knowledge of <ref target="https://en.wikipedia.org/wiki/Order_of_operations">orders of operation</ref>, as this knowledge is needed to solve the mathematical equations correctly.</p>
                </p>
                <p>The example used in this tutorial is one of many "gravity models" or "spatial interaction models" that measure the way entities (often people) use spaces. They are part of what A.G. Wilson referred to as a "family of spatial interaction models", and were developed from R.G. Ravenstein's 1885 attempts to derive "laws" of migration that could explain or even predict the movement of populations, including an assertion that both distance and population are key factors in the flows of migration between two points <ref type="footnotemark" target="#note_3"/>. Wilson outlines many different equations (models), depending on what type of movement is under investigation and what information is known or unknown. For example, you would need to use a different or adapted model (equation) if your case study involved movement between multiple locations and multiple destinations. Gravity models are also the subject of active research, and scholars continue to refine their underlying mathematics as new ideas emerge. The formula used here is based upon the latest research to date, at the time the article was written. It is particularly indebted to earlier work by Tobler, Flowerdew, Aiken, Lovett, Abel, and Congdon, variously published between 1970 and 2010.<ref type="footnotemark" target="#note_4"/>
                </p>
                <p>From a mathematical perspective, our gravity model is a type of <ref target="https://en.wikipedia.org/wiki/Regression_analysis">regression analysis</ref>, a means of comparing sets of variables in search of relationships between them. While not all gravity models use regression, the example in this tutorial does. This section covers in brief regression analyses, moving from a simple linear regression, to a multivariate linear regression, and finally to the negative binomial regression which is the basis of our model. Each builds upon the other.</p>
                <list type="unordered">
                    <item>simple linear regression</item>
                    <item>multivariate linear regression</item>
                    <item>negative binomial regression (our gravity model)</item>
                </list>
                <div type="3">
                    <head>Simple Linear Regression</head>
                    <p>The most basic regression analysis is a <ref target="https://en.wikipedia.org/wiki/Simple_linear_regression">simple linear regression</ref> analysis. A simple linear regression of two variables (eg, county population, and number of vagrants) provides a way to quantify the relationship between those two variables. When you plot the values on a <ref target="https://en.wikipedia.org/wiki/Scatter_plot">scatter plot</ref> (eg, county population on the x-axis, and number of vagrants on the y-axis), looking at the graph makes it clear that there is a loose but reasonably obvious linear relationship between them (Figure 6). Generally speaking, the greater the population, the more vagrants you find. The purpose of a simple linear regression is to calculate the formula that best represents the straight line that comes as close to as many of the points on the graph as possible. Since not all points fall directly on the line, but most are fairly close, Figure 6 suggests that population is a good, but not a perfect predictor of the number of vagrants from a given county.</p>
                    <figure>
                        <desc>Figure 6: A simple linear regression of county population (x-axis) and number of vagrants observed, 1777-1786 (y-axis). To make this graph more readable, Yorkshire has been excluded because of its very large population.</desc>
                        <graphic url="figure6.png"/>
                    </figure>
                    <p>There are many websites that provide calculator functions that will do this for you automatically, and proprietary software including Microsoft Excel and SPSS can also perform this calculation. The formula for a simple linear regression is:</p>
                    <p>$$y = α + βx$$</p>
                    <list type="unordered">
                        <item>$y$ is a value on the y-axis (number of vagrants, in the example above).</item>
                        <item>$α$ is the <ref target="https://en.wikipedia.org/wiki/Y-intercept">y-intercept</ref>. This is the value of $y$ when $x = 0$.</item>
                        <item>$β$ is the <ref target="https://en.wikipedia.org/wiki/Slope">slope</ref> of the regression line.</item>
                        <item>$x$ is a value on the x-axis (the population of the county).</item>
                    </list>
                    <p>Many tutorials can teach you to conduct simple linear regressions.<ref type="footnotemark" target="#note_5"/> When you know $α$ and $β$, you can choose a value for either $x$ (population) or $y$ (number of vagrants), and then calculate the other. You can do that mathematically using the formula above, or you can eyeball it by looking at the graph in Figure 6 if you only need a rough measure. If you want to know the estimated number of vagrants for a county with a population of 200,000 ($A.$ on Figure 6), then you find where $x$ and $y$ meet ($B.$), and finally the y-intercept for that value ($C.$). In other words: if population is 200,000, how many vagrants would we expect? According to the graph, about 90.</p>
                </div>
                <div type="3">
                    <head>Multivariate Linear Regression</head>
                    <p>A <ref target="https://en.wikipedia.org/wiki/Multivariate_statistics">multivariate linear regression</ref> (multiple variable) is a more powerful version of the above. Instead of handling two variables ($y$ and $x$), it can handle an unlimited number. The principles are exactly the same as the simple linear regression above. Again, there are online calculators that can conduct a multivariate linear regression, or we can calculate it using the following equation:</p>
                    <p>$$y = β_{0} + β_{1}(x_{1}) + β_{2}(x_{2}) + ... + β_{p}(x_{p})$$</p>
                    <p>The formula works the same way, and the symbols mean exactly the same as above, with the exception of $β_{0}$ and $p$.</p>
                    <list type="unordered">
                        <item>$β_{0}$ is the y-intercept in a multivariate linear regression (represented as $α$ in the Simple Linear Regression formula). From our perspective, it is the same.</item>
                        <item>$p$ simply stands for "the last/final variable" and is used to show that there is no upper limit to the number of possible variables.</item>
                    </list>
                    <p>Unlike in the simple linear regression formula, in this example, there are multiple variables, each of which has a <ref target="https://en.wikipedia.org/wiki/Line_fitting">line of best fit</ref>, each of which has a <ref target="https://en.wikipedia.org/wiki/Slope">slope</ref> of the line that has to be calculated ($β_{1}$, $β_{2}$, etc). It is difficult to draw a multivariate linear regression on a scatterplot because you would need a new dimension for each added variable. In principle it is the same as the simpler version, but with more axes.</p>
                    <p>You can add and remove the number of variables to suit your own needs. Keeping in mind that $y$ counts as one of the variables (vagrants observed, in this case), a three, four, and five variable version of the above equation looks like this:</p>
                    <p>
                        <hi rend="bold">Three Variable ($y$ Plus 2 Independent Variables):</hi>
                    </p>
                    <p>$$y = β_{0} + (β_{1}x_{1}) + (β_{2}x_{2})$$</p>
                    <p>
                        <hi rend="bold">Four Variable  ($y$ Plus 3 Independent Variables):</hi>
                    </p>
                    <p>$$y = β_{0} + (β_{1}x_{1}) + (β_{2}x_{2}) + (β_{3}x_{3})$$</p>
                    <p>
                        <hi rend="bold">Five Variable  ($y$ Plus 4 Independent Variables):</hi>
                    </p>
                    <p>$$y = β_{0} + (β_{1}x_{1}) + (β_{2}x_{2}) + (β_{3}x_{3}) + (β_{4}x_{4})$$</p>
                    <p>This is not quite our model yet. However, the model we will use is very like this and includes five independent variables plus the number of observed vagrants for each county, described below in detail. For our model, taking a multivariate approach to regression allows us to ask much more complex questions, such as, how many vagrants would we expect if:</p>
                    <list type="unordered">
                        <item>if population is 200,000</item>
                        <item>distance from London is 55km</item>
                        <item>average wages are 80 shillings per month</item>
                        <item>and they have risen by 12% in recent years</item>
                        <item>while the local price of wheat is 65 shillings per bushel?</item>
                    </list>
                    <p>If this imaginary county existed, the answer is: about 206 vagrants. That's very different than the 90 estimated by the simple linear regression, suggesting other factors apart from population had a big influence on the distribution. The next section will explain how we know that 206 is the most likely value for this imaginary county.</p>
                </div>
                <div type="3">
                    <head>Negative Binomial Regression</head>
                    <p>The formula used in our gravity model is extremely similar to the one above. It uses a negative binomial regression model,<ref type="footnotemark" target="#note_6"/> which is a multivariate regression model with some tweaks. These tweaks are necessary because the nature of our sample data is most likely to follow a <ref target="https://en.wikipedia.org/wiki/Negative_binomial_distribution">Negative Binomial Distribution</ref>.</p>
                    <p>In probability statistics, there are a number of different <ref target="https://en.wikipedia.org/wiki/List_of_probability_distributions">probability distributions</ref>. These are often represented visually as a curve, which shows the likelihood of each possible outcome in a given test. These curves vary widely - some are long and low, others have a sharp peak in the middle and very short tails, while others still take on more interesting patterns. Statisticians have come to recognise that certain types of tests using certain types of data are more likely to follow certain probability distributions. Knowing this means that statisticians have been able to tweak formulas to different types of probability tests, to return the most likely outcome. As historians we can use their findings to apply the best possible model to our historical data.</p>
                    <p>As it happens, our vagrants are best suited to a negative binomial distribution. The reasons for this are that they represent count data (1, 2, 53 vagrants) that must be whole numbers (no 0.5 vagrants) and cannot be negative (no -9 vagrants). Earlier gravity modelling conducted in the 1980s tended to use a <ref target="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson Distribution</ref> for modelling human migration. The best approach for gravity models is still a point of academic debate, with some scholars opting for a Negative Binomial approach, and others sticking with the Poisson distribution.<ref type="footnotemark" target="#note_7"/> It is possible that another probability distribution entirely is most appropriate for your own data. If you were modelling trade surpluses or deficits (which could be + or -), your data may not follow a negative binomial distribution, and the author recommends speaking to a statistician about the most appropriate option.</p>
                    <p>What this means for us in this example is that the formula changes slightly. In particular, we no longer solve for $y$, but for the <ref target="https://en.wikipedia.org/wiki/Natural_logarithm">natural logarithm</ref> ($ln$) of the <ref target="http://www.statisticshowto.com/population-mean/">population mean</ref> ($μ$). You can read more about this type of formula in Michael L. Zwilling's work<ref type="footnotemark" target="#note_8"/>.</p>
                    <p>
                        <hi rend="bold">Multivariate Regression Model:</hi>
                    </p>
                    <p>$$y = ...$$</p>
                    <p>
                        <hi rend="bold">Negative Binomial Regression Model:</hi>
                    </p>
                    <p>$$ln(μ) = ...$$</p>
                    <p>The full formula looks like this:</p>
                    <p>$$ln(μ) = β_{0} + (β_{1}x_{1}) + (β_{2}x_{2}) + (β_{3}x_{3}) + (β_{4}x_{4}) + (β_{5}x_{5})$$</p>
                    <p>To make it easier to solve, we can rewrite this formula to isolate $μ$ on the left side of the equation by counteracting the natural log ($ln$) - effectively removing it from the calculation. To do so, we must perform the inverse of natural log on both sides of the equation. The inverse of a natural log ($ln$) is the <ref target="https://en.wikipedia.org/wiki/Exponential_function">exponential function</ref> ($exp$). This means multiplying natural log by the exponential function on the left side of the equation (resulting in 1, and making it redundant since 1($μ$) is $μ$). You must also do the same on the right side.</p>
                    <p>This means everything on the right side of the new equation must be multiplied by $exp()$:</p>
                    <p>$$μ = exp(β_{0} + (β_{1}x_{1}) + (β_{2}x_{2}) + (β_{3}x_{3}) + (β_{4}x_{4}) + (β_{5}x_{5}))$$</p>
                    <p>The above is the basis of the equation used in the <emph>Economic History Review</emph> article upon which this tutorial is based, and should be the starting point for your own studies if you are modelling data that follows a negative binomial distribution. You may notice this is slightly different than the model used in the original article, which is seen below and explained in the next section. The differences are largely superficial and tailored to the very specific case study.<ref type="footnotemark" target="#note_9"/>
                    </p>
                    <p>
                        <hi rend="bold">The Final Gravity Model:</hi>
                    </p>
                    <p>$$μ_{ij} = exp(β_{0} + (β_{1}ln(P_{i}) + (β_{2}ln(d_{ij}) + (β_{3}Wh_{i}) + (β_{4}Wa_{i}) + (β_{5})WaT_{i}))$$</p>
                    <p>$μ_{ij}$ stands for the population interaction between origin $i$ and destination $j$ - in this case, the number of vagrants moving to London from that area. The remaining symbols represent each of the five variables used in the example case study, and will be explained more fully below.</p>
                </div>
            </div>
            <div type="2">
                <head>The Three Steps of Gravity Modelling</head>
                <p>To make this method as accessible as possible, we will take a step-by-step approach to understand the components of the formula and how to calculate it for the example data, which we will begin to compile in the next step.</p>
                <p>In order to determine the most likely distribution of migrants across the 32 counties, the modelling process involves three steps:</p>
                <list type="ordered">
                    <item>Deciding on variables and gathering the relevant data.</item>
                    <item>Determining the relative importance (weighting) of each variable.</item>
                    <item>Applying the weightings for each county to get a predicted number of movements.</item>
                </list>
                <p>Each of those three steps will involve finding certain parts of the equation so that we can ultimately solve it mathematically. This three-step process provides a numerical estimate of migrants (or coffee beans/widgets) for each territory in the model, allowing for a final step: historical interpretation.</p>
                <div type="3">
                    <head>Step 1 - Deciding on Variables and Gathering the Relevant Data</head>
                    <p>The first step is to decide which independent variables / influencing factors to include in the model. These are the variables that we think will influence the distribution of our migrants. How many variables you choose to include and what they are is part art, part science, and part luck.</p>
                    <p>It is art because you understand your data better than anyone, so should have an idea of the factors that <emph>might</emph> be most important. It is science because for most types of migration or trade, other scholars have already published about push or pull factors that are known to influence those types of distributions.<ref type="footnotemark" target="#note_10"/> And luck because in order to use a given factor, you need to have reliable historical data for each and every territory in your model. If those data do not exist, or the records do not allow you to create a complete set for a given variable, you are unable to include it.</p>
                    <p>Influencing factors need to be considered on a case by case basis and to draw on your subject specialist expertise. There is not a <emph>right</emph> answer when it comes to the number or types of variables to use, but it is a good idea not to try to over-model with a long list. A few very relevant factors is probably better than many weak markers.</p>
                    <p>There are also a number of <emph>wrong</emph> ways you can include variables. A gravity model will not work unless each variable meets the following criteria:</p>
                    <list type="unordered">
                        <item>Numerical</item>
                        <item>Complete</item>
                        <item>Reliable</item>
                    </list>
                    <p>
                        <hi rend="bold">Numerical Data Only</hi>
                    </p>
                    <p>As the gravity model is a mathematical equation, all input variables must be numerical. That could be a count (population), spatial measure (area, distance, etc), time (hours from London on foot), percentage (wage increase/decrease), currency value (wages in shillings), or some other <emph>measure</emph> of the places involved in the model.</p>
                    <p>Numbers must be meaningful and cannot be nominal <ref target="https://en.wikipedia.org/wiki/Categorical_variable">categorical variables</ref> which act as a stand-in for a qualitative attribute. For example you <hi rend="bold">cannot</hi> arbitrarily assign a number and use it in the model if the number doesn't have meaning (eg, <code rend="inline">road quality</code> = good, or <code rend="inline">road quality</code> = 4). Though the latter is numerical it is not a measure of road quality. Instead, you might use the average travel speed in miles per hour as a proxy for road quality. Whether average speed is a meaningful measure of road quality is up to you to determine and defend as the author of the study.</p>
                    <p>Generally speaking, if you can measure it or count it, you can model it.</p>
                    <p>
                        <hi rend="bold">Complete Data Only</hi>
                    </p>
                    <p>All categories of data must exist for each point of interest. That means that all of the 32 counties under analysis must have reliable data for each push and pull factor. You cannot have any gaps or blanks, such as one county where you don't have the average wage.</p>
                    <p>
                        <hi rend="bold">Reliable Data Only</hi>
                    </p>
                    <p>The computer science adage "garbage in, garbage out" also applies to gravity models, which are only as reliable as the data used to build them. Beyond choosing robust and reliable historical data from sources you can trust, there are lots of ways to make mistakes that will render the outputs of your model meaningless. For example, it is worth making sure that the data you have exactly match the territories (eg, county data to represent counties, not city data to represent a county).</p>
                    <p>Depending on the time and place of your study, you may find it difficult to obtain a reliable set of data upon which to base your model. The further back in the past one's study, the more difficult that may be. Likewise, it may be easier to conduct these types of analyses in societies that were heavily bureaucratic and left a good surviving paper trail, such as in Europe or North America.</p>
                    <p>To ensure data quality in this case study, each variable was either reliably calculated or derived from published peer-reviewed historical data (see Table 1). Exactly how these data were compiled can be read in the original article where it was explained in depth.<ref type="footnotemark" target="#note_11"/>
                    </p>
                    <table>
                        <caption>Table 2: The symbols used in the gravity model equation to self-document the formula, and their meanings.</caption>
                        <row>
                            <cell role="label">Symbol</cell>
                            <cell role="label">Meaning</cell>
                        </row>
                        <row>
                            <cell>$i$</cell>
                            <cell>the county of origin</cell>
                        </row>
                        <row>
                            <cell>$j$</cell>
                            <cell>London (destination)</cell>
                        </row>
                        <row>
                            <cell>$P$</cell>
                            <cell>Population at origin ($i$)</cell>
                        </row>
                        <row>
                            <cell>$d$</cell>
                            <cell>Distance from origin ($i$) to London ($j$)</cell>
                        </row>
                        <row>
                            <cell>$Wh$</cell>
                            <cell>Price of Wheat at origin ($i$)</cell>
                        </row>
                        <row>
                            <cell>$Wa$</cell>
                            <cell>Average wages at origin ($i$)</cell>
                        </row>
                        <row>
                            <cell>$WaT$</cell>
                            <cell>Wage trajectory at origin ($i$)</cell>
                        </row>
                    </table>
                    <table>
                        <row>
                            <cell role="label">Variable</cell>
                            <cell role="label">Source</cell>
                        </row>
                        <row>
                            <cell>trajectory of wages</cell>
                            <cell>Hunt, "Industrialization and Regional Inequality", pp. 965-6.<ref type="footnotemark" target="#note_15"/>
                            </cell>
                        </row>
                        <row>
                            <cell>average wages at origin</cell>
                            <cell>Hunt, "Industrialization and Regional Inequality", pp. 965-6.<ref type="footnotemark" target="#note_14"/>
                            </cell>
                        </row>
                        <row>
                            <cell>price of wheat</cell>
                            <cell>Cannon and Brunt, "Weekly British Grain Prices"<ref type="footnotemark" target="#note_13"/>
                            </cell>
                        </row>
                        <row>
                            <cell>distance from London</cell>
                            <cell>calculated with software</cell>
                        </row>
                        <row>
                            <cell>population at origin</cell>
                            <cell>1771 values, Wrigley, "English county populations", pp. 54-5.<ref type="footnotemark" target="#note_12"/>
                            </cell>
                        </row>
                    </table>
                    <table>
                        <caption>Table 3: The five variables used in the model, for each of the 32 counties. These are the data that go into the model to calculate the result.</caption>
                        <row>
                            <cell role="label">County</cell>
                            <cell role="label">Vagrants</cell>
                            <cell role="label">$d$ km to London</cell>
                            <cell role="label">$P$ Population (persons)</cell>
                            <cell role="label">$Wa$ Average Wage (shillings)</cell>
                            <cell role="label">$WaT$ Wage Trajectory 1767-95 (% change)</cell>
                            <cell role="label">$Wh$ Wheat Price (shillings)</cell>
                        </row>
                        <row>
                            <cell>Bedfordshire</cell>
                            <cell>26</cell>
                            <cell>61.9</cell>
                            <cell>54836</cell>
                            <cell>87</cell>
                            <cell>1.149</cell>
                            <cell>61.79</cell>
                        </row>
                        <row>
                            <cell>Berkshire</cell>
                            <cell>111</cell>
                            <cell>61.7</cell>
                            <cell>101939</cell>
                            <cell>90</cell>
                            <cell>4.44</cell>
                            <cell>63.07</cell>
                        </row>
                        <row>
                            <cell>Buckinghamshire</cell>
                            <cell>79</cell>
                            <cell>46.7</cell>
                            <cell>95936</cell>
                            <cell>96</cell>
                            <cell>-8.33</cell>
                            <cell>63.09</cell>
                        </row>
                        <row>
                            <cell>Cambridgeshire</cell>
                            <cell>32</cell>
                            <cell>86.8</cell>
                            <cell>80497</cell>
                            <cell>88</cell>
                            <cell>11.36</cell>
                            <cell>60.05</cell>
                        </row>
                        <row>
                            <cell>Cheshire</cell>
                            <cell>34</cell>
                            <cell>255.1</cell>
                            <cell>158038</cell>
                            <cell>80</cell>
                            <cell>35.00</cell>
                            <cell>69.19</cell>
                        </row>
                        <row>
                            <cell>Cornwall</cell>
                            <cell>40</cell>
                            <cell>364.6</cell>
                            <cell>142179</cell>
                            <cell>81</cell>
                            <cell>14.81</cell>
                            <cell>67.94</cell>
                        </row>
                        <row>
                            <cell>Cumberland</cell>
                            <cell>13</cell>
                            <cell>407.3</cell>
                            <cell>96862</cell>
                            <cell>78</cell>
                            <cell>38.46</cell>
                            <cell>64.42</cell>
                        </row>
                        <row>
                            <cell>Derbyshire</cell>
                            <cell>28</cell>
                            <cell>196.9</cell>
                            <cell>122593</cell>
                            <cell>75</cell>
                            <cell>48.00</cell>
                            <cell>68.02</cell>
                        </row>
                        <row>
                            <cell>Devon</cell>
                            <cell>98</cell>
                            <cell>272.5</cell>
                            <cell>279652</cell>
                            <cell>89</cell>
                            <cell>-7.87</cell>
                            <cell>69.98</cell>
                        </row>
                        <row>
                            <cell>Dorset</cell>
                            <cell>27</cell>
                            <cell>176.8</cell>
                            <cell>97262</cell>
                            <cell>81</cell>
                            <cell>22.22</cell>
                            <cell>67.30</cell>
                        </row>
                        <row>
                            <cell>Durham</cell>
                            <cell>25</cell>
                            <cell>380.7</cell>
                            <cell>119779</cell>
                            <cell>78</cell>
                            <cell>33.33</cell>
                            <cell>63.16</cell>
                        </row>
                        <row>
                            <cell>Gloucestershire</cell>
                            <cell>162</cell>
                            <cell>157.1</cell>
                            <cell>215576</cell>
                            <cell>81</cell>
                            <cell>9.88</cell>
                            <cell>66.54</cell>
                        </row>
                        <row>
                            <cell>Hampshire</cell>
                            <cell>78</cell>
                            <cell>102.4</cell>
                            <cell>166648</cell>
                            <cell>96</cell>
                            <cell>6.25</cell>
                            <cell>61.45</cell>
                        </row>
                        <row>
                            <cell>Herefordshire</cell>
                            <cell>45</cell>
                            <cell>190.5</cell>
                            <cell>81882</cell>
                            <cell>70</cell>
                            <cell>28.57</cell>
                            <cell>62.05</cell>
                        </row>
                        <row>
                            <cell>Hertfordshire</cell>
                            <cell>99</cell>
                            <cell>35.3</cell>
                            <cell>95868</cell>
                            <cell>90</cell>
                            <cell>4.44</cell>
                            <cell>63.82</cell>
                        </row>
                        <row>
                            <cell>Huntingdonshire</cell>
                            <cell>21</cell>
                            <cell>87.5</cell>
                            <cell>35370</cell>
                            <cell>89</cell>
                            <cell>7.87</cell>
                            <cell>58.72</cell>
                        </row>
                        <row>
                            <cell>Lancashire</cell>
                            <cell>94</cell>
                            <cell>281.8</cell>
                            <cell>301407</cell>
                            <cell>78</cell>
                            <cell>55.13</cell>
                            <cell>71.65</cell>
                        </row>
                        <row>
                            <cell>Leicestershire</cell>
                            <cell>20</cell>
                            <cell>146.1</cell>
                            <cell>107028</cell>
                            <cell>79</cell>
                            <cell>65.82</cell>
                            <cell>64.84</cell>
                        </row>
                        <row>
                            <cell>Lincolnshire</cell>
                            <cell>41</cell>
                            <cell>179.8</cell>
                            <cell>181814</cell>
                            <cell>84</cell>
                            <cell>26.19</cell>
                            <cell>58.73</cell>
                        </row>
                        <row>
                            <cell>Northamptonshire</cell>
                            <cell>33</cell>
                            <cell>107.6</cell>
                            <cell>128798</cell>
                            <cell>78</cell>
                            <cell>21.79</cell>
                            <cell>63.81</cell>
                        </row>
                        <row>
                            <cell>Northumberland</cell>
                            <cell>58</cell>
                            <cell>440.0</cell>
                            <cell>148148</cell>
                            <cell>72</cell>
                            <cell>70.83</cell>
                            <cell>58.22</cell>
                        </row>
                        <row>
                            <cell>Nottinghamshire</cell>
                            <cell>31</cell>
                            <cell>187.5</cell>
                            <cell>98216</cell>
                            <cell>108</cell>
                            <cell>0.00</cell>
                            <cell>61.30</cell>
                        </row>
                        <row>
                            <cell>Oxfordshire</cell>
                            <cell>78</cell>
                            <cell>86.8</cell>
                            <cell>99354</cell>
                            <cell>84</cell>
                            <cell>25.00</cell>
                            <cell>64.23</cell>
                        </row>
                        <row>
                            <cell>Rutland</cell>
                            <cell>2</cell>
                            <cell>132.5</cell>
                            <cell>15123</cell>
                            <cell>90</cell>
                            <cell>10.00</cell>
                            <cell>64.12</cell>
                        </row>
                        <row>
                            <cell>Shropshire</cell>
                            <cell>75</cell>
                            <cell>214.0</cell>
                            <cell>147303</cell>
                            <cell>76</cell>
                            <cell>18.42</cell>
                            <cell>66.50</cell>
                        </row>
                        <row>
                            <cell>Somerset</cell>
                            <cell>159</cell>
                            <cell>180.4</cell>
                            <cell>234179</cell>
                            <cell>77</cell>
                            <cell>3.90</cell>
                            <cell>68.29</cell>
                        </row>
                        <row>
                            <cell>Staffordshire</cell>
                            <cell>82</cell>
                            <cell>185.3</cell>
                            <cell>175075</cell>
                            <cell>76</cell>
                            <cell>18.42</cell>
                            <cell>67.80</cell>
                        </row>
                        <row>
                            <cell>Warwickshire</cell>
                            <cell>104</cell>
                            <cell>149.3</cell>
                            <cell>152050</cell>
                            <cell>96</cell>
                            <cell>-3.13</cell>
                            <cell>65.05</cell>
                        </row>
                        <row>
                            <cell>Westmorland</cell>
                            <cell>5</cell>
                            <cell>365.0</cell>
                            <cell>38342</cell>
                            <cell>74</cell>
                            <cell>62.16</cell>
                            <cell>71.05</cell>
                        </row>
                        <row>
                            <cell>Wiltshire</cell>
                            <cell>99</cell>
                            <cell>131.7</cell>
                            <cell>182421</cell>
                            <cell>84</cell>
                            <cell>20.24</cell>
                            <cell>63.64</cell>
                        </row>
                        <row>
                            <cell>Worcestershire</cell>
                            <cell>94</cell>
                            <cell>164.4</cell>
                            <cell>130757</cell>
                            <cell>81</cell>
                            <cell>25.93</cell>
                            <cell>65.78</cell>
                        </row>
                        <row>
                            <cell>Yorkshire</cell>
                            <cell>127</cell>
                            <cell>282.2</cell>
                            <cell>651709</cell>
                            <cell>80</cell>
                            <cell>58.33</cell>
                            <cell>61.87</cell>
                        </row>
                    </table>
                </div>
                <table>
                    <caption>Table 4: The parameter weightings for the five variables ($β1$ to $β5$) and the y-intercept ($β0$), used to solve the gravity model equation.</caption>
                    <row>
                        <cell role="label">Variable</cell>
                        <cell role="label">Weighting</cell>
                        <cell role="label">Symbol</cell>
                    </row>
                    <row>
                        <cell>y-intercept</cell>
                        <cell>-3.84678 </cell>
                        <cell>$β0$</cell>
                    </row>
                    <row>
                        <cell>population</cell>
                        <cell>1.235208</cell>
                        <cell>$β1$</cell>
                    </row>
                    <row>
                        <cell>distance</cell>
                        <cell>-0.541863</cell>
                        <cell>$β2$</cell>
                    </row>
                    <row>
                        <cell>wheat price</cell>
                        <cell>-0.023957</cell>
                        <cell>$β3$</cell>
                    </row>
                    <row>
                        <cell>wages</cell>
                        <cell>-0.025184</cell>
                        <cell>$β4$</cell>
                    </row>
                    <row>
                        <cell>wage trajectory</cell>
                        <cell>-0.013779</cell>
                        <cell>$β5$</cell>
                    </row>
                </table>
                <table>
                    <caption>Table 5: The "Observed" and "Estimated" number of vagabond poor from each county, as well as the residual (difference between the two) Available as Table 3 in the original article.</caption>
                    <row>
                        <cell role="label">County</cell>
                        <cell role="label">Observed Value</cell>
                        <cell role="label">Estimated Value</cell>
                        <cell role="label">Residual</cell>
                    </row>
                    <row>
                        <cell>Bedfordshire</cell>
                        <cell>26</cell>
                        <cell>41</cell>
                        <cell>-15</cell>
                    </row>
                    <row>
                        <cell>Berkshire</cell>
                        <cell>111</cell>
                        <cell>76</cell>
                        <cell>35</cell>
                    </row>
                    <row>
                        <cell>Buckinghamshire</cell>
                        <cell>79</cell>
                        <cell>83</cell>
                        <cell>-4</cell>
                    </row>
                    <row>
                        <cell>Cambridgeshire</cell>
                        <cell>32</cell>
                        <cell>48</cell>
                        <cell>-16</cell>
                    </row>
                    <row>
                        <cell>Cheshire</cell>
                        <cell>34</cell>
                        <cell>44</cell>
                        <cell>-10</cell>
                    </row>
                    <row>
                        <cell>Cornwall</cell>
                        <cell>40</cell>
                        <cell>42</cell>
                        <cell>-2</cell>
                    </row>
                    <row>
                        <cell>Cumberland</cell>
                        <cell>13</cell>
                        <cell>21</cell>
                        <cell>-8</cell>
                    </row>
                    <row>
                        <cell>Derbyshire</cell>
                        <cell>28</cell>
                        <cell>36</cell>
                        <cell>-8</cell>
                    </row>
                    <row>
                        <cell>Devon</cell>
                        <cell>98</cell>
                        <cell>121</cell>
                        <cell>-23</cell>
                    </row>
                    <row>
                        <cell>Dorset</cell>
                        <cell>27</cell>
                        <cell>36</cell>
                        <cell>-9</cell>
                    </row>
                    <row>
                        <cell>Durham</cell>
                        <cell>25</cell>
                        <cell>31</cell>
                        <cell>-6</cell>
                    </row>
                    <row>
                        <cell>Gloucestershire</cell>
                        <cell>162</cell>
                        <cell>123</cell>
                        <cell>39</cell>
                    </row>
                    <row>
                        <cell>Hampshire</cell>
                        <cell>78</cell>
                        <cell>92</cell>
                        <cell>-14</cell>
                    </row>
                    <row>
                        <cell>Herefordshire</cell>
                        <cell>45</cell>
                        <cell>39</cell>
                        <cell>6</cell>
                    </row>
                    <row>
                        <cell>Hertfordshire</cell>
                        <cell>99</cell>
                        <cell>95</cell>
                        <cell>4</cell>
                    </row>
                    <row>
                        <cell>Huntingdonshire</cell>
                        <cell>21</cell>
                        <cell>18</cell>
                        <cell>3</cell>
                    </row>
                    <row>
                        <cell>Lancashire</cell>
                        <cell>94</cell>
                        <cell>84</cell>
                        <cell>10</cell>
                    </row>
                    <row>
                        <cell>Leicestershire</cell>
                        <cell>20</cell>
                        <cell>28</cell>
                        <cell>-8</cell>
                    </row>
                    <row>
                        <cell>Lincolnshire</cell>
                        <cell>41</cell>
                        <cell>86</cell>
                        <cell>-45</cell>
                    </row>
                    <row>
                        <cell>Northamptonshire</cell>
                        <cell>33</cell>
                        <cell>78</cell>
                        <cell>-45</cell>
                    </row>
                    <row>
                        <cell>Northumberland</cell>
                        <cell>58</cell>
                        <cell>29</cell>
                        <cell>29</cell>
                    </row>
                    <row>
                        <cell>Nottinghamshire</cell>
                        <cell>31</cell>
                        <cell>28</cell>
                        <cell>3</cell>
                    </row>
                    <row>
                        <cell>Oxfordshire</cell>
                        <cell>78</cell>
                        <cell>52</cell>
                        <cell>26</cell>
                    </row>
                    <row>
                        <cell>Rutland</cell>
                        <cell>2</cell>
                        <cell>4</cell>
                        <cell>-2</cell>
                    </row>
                    <row>
                        <cell>Shropshire</cell>
                        <cell>75</cell>
                        <cell>66</cell>
                        <cell>9</cell>
                    </row>
                    <row>
                        <cell>Somerset</cell>
                        <cell>159</cell>
                        <cell>145</cell>
                        <cell>14</cell>
                    </row>
                    <row>
                        <cell>Staffordshire</cell>
                        <cell>82</cell>
                        <cell>85</cell>
                        <cell>-3</cell>
                    </row>
                    <row>
                        <cell>Warwickshire</cell>
                        <cell>104</cell>
                        <cell>70</cell>
                        <cell>34</cell>
                    </row>
                    <row>
                        <cell>Westmorland</cell>
                        <cell>5</cell>
                        <cell>5</cell>
                        <cell>0</cell>
                    </row>
                    <row>
                        <cell>Wiltshire</cell>
                        <cell>99</cell>
                        <cell>95</cell>
                        <cell>4</cell>
                    </row>
                    <row>
                        <cell>Worcestershire</cell>
                        <cell>94</cell>
                        <cell>53</cell>
                        <cell>41</cell>
                    </row>
                    <row>
                        <cell>Yorkshire</cell>
                        <cell>127</cell>
                        <cell>207</cell>
                        <cell>-80</cell>
                    </row>
                </table>
                <div type="3">
                    <head>Step 4 - Historical Interpretation</head>
                    <p>At this stage, the modelling process is complete and the final stage is historical interpretation.</p>
                    <p>The original published article upon which this case study was based, is devoted primarily to interpreting what the results of the modelling mean to our understanding of lower class migration in the eighteenth century. As seen in the map in Figure 5, there were parts of the country that the model strongly suggested were either over- or under-sending lower class migrants to London.</p>
                    <p>The co-authors offered their interpretations as to why those patterns may have appeared. These interpretations varied by place. In areas of the North of England that were rapidly industrialising, such as Yorkshire or Manchester, the opportunities locally appeared to give people fewer reasons to leave, resulting in lower than expected migration to London. In declining areas to the west, such as Bristol, the lure of London was stronger as more people left seeking work in the capital.</p>
                    <p>Not all of the patterns were expected. Northumberland in the far north east proved to be a regional anomaly, sending far more (female) migrants to London than we would expect to see. Without the outputs of the model, it is unlikely that we would have thought to consider Northumberland at all, particularly because it was so far from the Metropolis and we presumed would have weak ties to London. The model thus provided new evidence for us to consider as historians and changed our understanding of the London-Northumberland relationship. A full discussion of our findings can be read in the original article.<ref type="footnotemark" target="#note_18"/>
                    </p>
                </div>
            </div>
            <table>
                <caption>Table 6: An example of how the formula used above could be repurposed for a study of Colombian coffee exporting patterns in 1950.</caption>
                <row>
                    <cell role="label">Criteria</cell>
                    <cell role="label">Coffee Exporting Example</cell>
                </row>
                <row>
                    <cell>ONE point of origin</cell>
                    <cell>coffee exports from the port of Barranquilla, Colombia</cell>
                </row>
                <row>
                    <cell>MULTIPLE finite destinations</cell>
                    <cell>the 21 countries of the Western Hemisphere in 1950</cell>
                </row>
                <row>
                    <cell>FIVE explanatory variables</cell>
                    <cell>(1) number of Atlantic Ocean ports in receiving country (2) miles from Colombia, (3) Gross Domestic Product of receiving country, (4) Domestic Coffee grown in tons, (5) coffee shops per 10,000 people</cell>
                </row>
            </table>
            <div type="2">
                <head>Acknowledgements</head>
                <p>With thanks to Angela Kedgley, Sarah Lloyd, Tim Hitchcock, Joe Cozens, Katrina Navickas, and Leanne Calvert for reading and commenting on earlier drafts of this article. Also thanks to the <emph>British Academy</emph> for funding the writing workshop in Bogotá, Colombia at which this article was drafted. And finally to Adam Dennett for introducing me to these wonderful formulae and unleashing their potential for historians.</p>
            </div>
            <div type="2">
                <head>Endnotes</head>
                <p>
                    <ref type="footnotemark" target="#note_1"/> : For a deeper understanding of vagrancy see Hitchcock, Tim, Adam Crymble, and Louise Falcini, "Loose, Idle, and Disorderly: Vagrancy Removal in Late Eighteenth Century Middlesex", <emph>Social History</emph>, vol. 39, no. 4 (2014), 509-527.
<ref type="footnotemark" target="#note_2"/> : Crymble, A, A. Dennett, and T. Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, vol. 71, no. 3 (2018), 751.
<ref type="footnotemark" target="#note_3"/> : Ravenstein, R.G., 'The Laws of Migration', <emph>Journal of the Statistical Society of London</emph>, 48 (1885), 167-235; Wilson, A. G., ‘A family of spatial interaction models, and associated developments’, Environment and Planning A, 3 (1971), pp. 1–32.
<ref type="footnotemark" target="#note_4"/> : Tobler, W.R., 'A Computer Movie Simulating Urban Growth in the Detroit Region', <emph>Economic Geography</emph>, 46 (1970), 234-240; Flowerdew, R. and Aitkin, M., ‘A method of fitting the gravity model based on the Poisson distribution’, <emph>Journal of Regional Science</emph>, 22 (1982), pp. 191–202; Flowerdew, R. and Lovett, A., ‘Fitting constrained Poisson regression models to interurban migration flows’, <emph>Geographical Analysis</emph>, 20 (1988), pp. 297–307; Congdon, P., ‘Approaches to modeling overdispersion in the analysis of migration’, <emph>Environment and Planning</emph> A, 25 (1993), pp. 1481–510; Flowerdew, R., ‘Modelling migration with Poisson regression’, in J. Stillwell, O. Duke-Williams, and A. Dennett, eds., <emph>Technologies for migration and commuting analysis: spatial interaction data applications</emph> (Hershey, Pa., 2010), pp. 261–79; Abel, G. J., ‘Estimation of international migration flow tables in Europe: international migration flow tables’, <emph>Journal of the Royal Statistical Society</emph>, Series A (Statistics in Society), 173 (2010), pp. 797–825.
<ref type="footnotemark" target="#note_5"/> : For English speakers, the author recommends Eugene O'Loughlin, 'How To...Perform Simple Linear Regression by Hand', <emph>YouTube</emph> (23 December 2015): <ref target="https://www.youtube.com/watch?v=GhrxgbQnEEU">https://www.youtube.com/watch?v=GhrxgbQnEEU</ref>.
<ref type="footnotemark" target="#note_6"/> : "Chapter 326: Negative Binomial Regression", <emph>NCSS Stats Software</emph> (n.d.): <ref target="https://ncss-wpengine.netdna-ssl.com/wp-content/themes/ncss/pdf/Procedures/NCSS/Negative_Binomial_Regression.pdf">https://ncss-wpengine.netdna-ssl.com/wp-content/themes/ncss/pdf/Procedures/NCSS/Negative_Binomial_Regression.pdf</ref>
                    <ref type="footnotemark" target="#note_7"/> : Flowerdew, R. and Aitkin, M., ‘A method of fitting the gravity model based on the Poisson distribution’, <emph>Journal of Regional Science</emph>, 22 (1982), pp. 191–202; Flowerdew, R. and Lovett, A., ‘Fitting constrained Poisson regression models to interurban migration flows’, <emph>Geographical Analysis</emph>, 20 (1988), pp. 297–307; Congdon, P., ‘Approaches to modeling overdispersion in the analysis of migration’, <emph>Environment and Planning</emph> A, 25 (1993), pp. 1481–510; Flowerdew, R., ‘Modelling migration with Poisson regression’, in J. Stillwell, O. Duke-Williams, and A. Dennett, eds., <emph>Technologies for migration and commuting analysis: spatial interaction data applications</emph> (Hershey, Pa., 2010), pp. 261–79.
<ref type="footnotemark" target="#note_8"/> : Michael L. Zwilling, "Negative Binomial Regression", <emph>The Mathematica Journal</emph>, vol. 15 (2013): <ref target="http://www.mathematica-journal.com/2013/06/negative-binomial-regression/">http://www.mathematica-journal.com/2013/06/negative-binomial-regression/</ref>.
<ref type="footnotemark" target="#note_9"/> : Crymble, A, A. Dennett, and T. Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, vol. 71, no. 3 (2018), 747-771.
<ref type="footnotemark" target="#note_10"/> : For example, see: Grigg, D.B. "E.G. Ravenstein and the 'laws of migration", <emph>Journal of Historical Geography</emph>, vol. 3, no. 1 (1977), pp. 44-54.
<ref type="footnotemark" target="#note_11"/> : Crymble, A, A. Dennett, and T. Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, vol. 71, no. 3 (2018), 753-754.
<ref type="footnotemark" target="#note_12"/> : Wrigley, E.A., "English County Populations in the Later Eighteenth Century", <emph>Economic History Review</emph>, vol. 60 (2007), pp. 54-55.
<ref type="footnotemark" target="#note_13"/> : Cannon, E. and L. Brunt, "Weekly British Grain Prices from the <emph>London Gazette</emph>, 1770-1820", [computer file] (Colchester, 2004): UK Data Archive [distributor], SN: 4383.
<ref type="footnotemark" target="#note_14"/> : Hunt, E.H., "Industrialization and Regional Inequality: Wages in Britain, 1760-1914", <emph>Journal of Economic History</emph>, vol. 46 (1986), pp. 965-966.
<ref type="footnotemark" target="#note_15"/> : Hunt, E.H., "Industrialization and Regional Inequality: Wages in Britain, 1760-1914", <emph>Journal of Economic History</emph>, vol. 46 (1986), pp. 965-966.
<ref type="footnotemark" target="#note_16"/> : Crymble, A, A. Dennett, and T. Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, vol. 71, no. 3 (2018), 769.
<ref type="footnotemark" target="#note_17"/> : For English speakers, the author recommends Eugene O'Loughlin, 'How To...Calculate Pearson's Correlation Coefficient', <emph>YouTube</emph> (17 December 2015): <ref target="https://www.youtube.com/watch?v=2SCg8Kuh0tE&amp;t=10s">https://www.youtube.com/watch?v=2SCg8Kuh0tE&amp;t=10s</ref>.
<ref type="footnotemark" target="#note_18"/> : Crymble, A, A. Dennett, and T. Hitchcock, "Modelling regional imbalances in English plebeian migration to late eighteenth-century London", <emph>Economic History Review</emph>, vol. 71, no. 3 (2018), 747-771.</p>
            </div>
        </body>
    </text>
</TEI>
