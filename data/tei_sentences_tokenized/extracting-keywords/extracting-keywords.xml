<TEI xmlns="http://www.tei-c.org/ns/1.0" xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="extracting-keywords" type="original" xml:base="extracting-keywords/extracting-keywords/extracting-keywords.xml">
    <teiHeader>
        <fileDesc>
            <titleStmt>
                <title>Using Gazetteers to Extract Sets of Keywords from Free-Flowing Texts</title>
                <author role="original_author">Adam Crymble</author>
                <editor role="reviewers">
                    <persName>Guy McClellan</persName>
                    <persName>Amanda Morton</persName>
                    <persName>Frederik Elwert</persName>
                </editor>
                <editor role="editors">Fred Gibbs</editor>
            </titleStmt>
            <publicationStmt>
                <distributor>Programming Historian</distributor>
                <idno type="doi">10.46430/phen0045</idno>
                <date type="published">12/01/2015</date>
            </publicationStmt>
            <sourceDesc>
                <p>Born digital, in a markdown format. This lesson is original.</p>
            </sourceDesc>
        </fileDesc>
        <profileDesc>
            <abstract>
                <p>This lesson will teach you how to use Python to extract a set of keywords very quickly and systematically from a set of texts.</p>
            </abstract>
            <textClass>
                <keywords>
                    <term xml:lang="en">data-manipulation</term>
                </keywords>
            </textClass>
        </profileDesc>
    </teiHeader>
    <text xml:lang="en">
        <body><div type="2" n="1"><head><w>Lesson</w><w>Goals</w></head><p><w>If</w><w>you</w><w>have</w><w>a</w><w>copy</w><w>of</w><w>a</w><w>text</w><w>in</w><w>electronic</w><w>format</w><w>stored</w><w>on</w><w>your</w><w>computer</w><w>,</w><w>it</w><w>is</w><w>relatively</w><w>easy</w><w>to</w><w>keyword</w><w>search</w><w>for</w><w>a</w><w>single</w><w>term</w><pc>.</pc><w>Often</w><w>you</w><w>can</w><w>do</w><w>this</w><w>by</w><w>using</w><w>the</w><w>built-in</w><w>search</w><w>features</w><w>in</w><w>your</w><w>favourite</w><w>text</w><w>editor</w><pc>.</pc><w>However</w><w>,</w><w>scholars</w><w>are</w><w>increasingly</w><w>needing</w><w>to</w><w>find</w><w>instances</w><w>of</w><w>many</w><w>terms</w><w>within</w><w>a</w><w>text</w><w>or</w><w>texts</w><pc>.</pc><w>For</w><w>example</w><w>,</w><w>a</w><w>scholar</w><w>may</w><w>want</w><w>to</w><w>use</w><w>a</w><ref target="http://en.wikipedia.org/wiki/Gazetteer"><w>gazetteer</w></ref><w>to</w><w>extract</w><w>all</w><w>mentions</w><w>of</w><w>English</w><w>placenames</w><w>within</w><w>a</w><w>collection</w><w>of</w><w>texts</w><w>so</w><w>that</w><w>those</w><w>places</w><w>can</w><w>later</w><w>be</w><w>plotted</w><w>on</w><w>a</w><w>map</w><pc>.</pc><w>Alternatively</w><w>,</w><w>they</w><w>may</w><w>want</w><w>to</w><w>extract</w><w>all</w><w>male</w><w>given</w><w>names</w><w>,</w><w>all</w><w>pronouns</w><w>,</w><ref target="http://en.wikipedia.org/wiki/Stop_words"><w>stop</w><w>words</w></ref><w>,</w><w>or</w><w>any</w><w>other</w><w>set</w><w>of</w><w>words</w><pc>.</pc><w>Using</w><w>those</w><w>same</w><w>built-in</w><w>search</w><w>features</w><w>to</w><w>achieve</w><w>this</w><w>more</w><w>complex</w><w>goal</w><w>is</w><w>time</w><w>consuming</w><w>and</w><w>clunky</w><pc>.</pc><w>This</w><w>lesson</w><w>will</w><w>teach</w><w>you</w><w>how</w><w>to</w><w>use</w><w>Python</w><w>to</w><w>extract</w><w>a</w><w>set</w><w>of</w><w>keywords</w><w>very</w><w>quickly</w><w>and</w><w>systematically</w><w>from</w><w>a</w><w>set</w><w>of</w><w>texts</w><pc>.</pc></p><p><w>It</w><w>is</w><w>expected</w><w>that</w><w>once</w><w>you</w><w>have</w><w>completed</w><w>this</w><w>lesson</w><w>,</w><w>you</w><w>will</w><w>be</w><w>able</w><w>to</w><w>generalise</w><w>the</w><w>skills</w><w>to</w><w>extract</w><w>custom</w><w>sets</w><w>of</w><w>keywords</w><w>from</w><w>any</w><w>set</w><w>of</w><w>locally</w><w>saved</w><w>files</w><pc>.</pc></p></div><div type="2" n="2"><head><w>For</w><w>Whom</w><w>is</w><w>this</w><w>Useful</w><pc>?</pc></head><p><w>This</w><w>lesson</w><w>is</w><w>useful</w><w>for</w><w>anyone</w><w>who</w><w>works</w><w>with</w><w>historical</w><w>sources</w><w>that</w><w>are</w><w>stored</w><w>locally</w><w>on</w><w>their</w><w>own</w><w>computer</w><w>,</w><w>and</w><w>that</w><w>are</w><w>transcribed</w><w>into</w><w>mutable</w><w>electronic</w><w>text</w><w>(</w><w>eg</w><w>,</w><w>.txt</w><w>,</w><w>.xml</w><w>,</w><w>.rtf</w><w>,</w><w>.md</w><w>)</w><pc>.</pc><w>It</w><w>is</w><w>particularly</w><w>useful</w><w>for</w><w>people</w><w>interested</w><w>in</w><w>identifying</w><w>subsets</w><w>of</w><w>documents</w><w>containing</w><w>one</w><w>or</w><w>more</w><w>of</w><w>a</w><w>fairly</w><w>large</w><w>number</w><w>of</w><w>keywords</w><pc>.</pc><w>This</w><w>might</w><w>be</w><w>useful</w><w>for</w><w>identifying</w><w>a</w><w>relevant</w><w>subset</w><w>for</w><w>closer</w><w>reading</w><w>,</w><w>or</w><w>for</w><w>extracting</w><w>and</w><w>structuring</w><w>the</w><w>keywords</w><w>in</w><w>a</w><w>format</w><w>that</w><w>can</w><w>be</w><w>used</w><w>in</w><w>another</w><w>tool</w><w>:</w><w>as</w><w>input</w><w>for</w><w>a</w><w>mapping</w><w>exercise</w><w>,</w><w>for</w><w>example</w><pc>.</pc></p><p><w>The</w><w>present</w><w>tutorial</w><w>will</w><w>show</w><w>users</w><w>how</w><w>to</w><w>extract</w><w>all</w><w>mentions</w><w>of</w><w>English</w><w>and</w><w>Welsh</w><w>county</w><w>names</w><w>from</w><w>a</w><w>series</w><w>of</w><w>6,692</w><w>mini-biographies</w><w>of</w><w>individuals</w><w>who</w><w>began</w><w>their</w><w>studies</w><w>at</w><w>the</w><w>University</w><w>of</w><w>Oxford</w><w>during</w><w>the</w><w>reign</w><w>of</w><w>James</w><w>I</w><w>of</w><w>England</w><w>(</w><w>1603-1625</w><w>)</w><pc>.</pc><w>These</w><w>records</w><w>were</w><w>transcribed</w><w>by</w><ref target="http://www.british-history.ac.uk/alumni-oxon/1500-1714"><w>British</w><w>History</w><w>Online</w></ref><w>,</w><w>from</w><w>the</w><w>printed</w><w>version</w><w>of</w><emph><w>Alumni</w><w>Oxonienses</w><w>,</w><w>1500-1714</w></emph><pc>.</pc><w>These</w><w>biographies</w><w>contain</w><w>information</w><w>about</w><w>each</w><w>graduate</w><w>,</w><w>which</w><w>includes</w><w>the</w><w>date</w><w>of</w><w>their</w><w>studies</w><w>and</w><w>the</w><w>college</w><w>(</w><w>s</w><w>)</w><w>they</w><w>attended</w><pc>.</pc><w>Often</w><w>entries</w><w>contain</w><w>additional</w><w>information</w><w>when</w><w>known</w><w>,</w><w>including</w><w>date</w><w>or</w><w>birth</w><w>and</w><w>death</w><w>,</w><w>the</w><w>name</w><w>or</w><w>occupation</w><w>of</w><w>their</w><w>father</w><w>,</w><w>where</w><w>they</w><w>originated</w><w>,</w><w>and</w><w>what</w><w>they</w><w>went</w><w>on</w><w>to</w><w>do</w><w>in</w><w>later</w><w>life</w><pc>.</pc><w>The</w><w>biographies</w><w>are</w><w>a</w><w>rich</w><w>resource</w><w>,</w><w>providing</w><w>reasonably</w><w>comparable</w><w>data</w><w>about</w><w>a</w><w>large</w><w>number</w><w>of</w><w>similar</w><w>individuals</w><w>(</w><w>rich</w><w>men</w><w>who</w><w>went</w><w>to</w><w>Oxford</w><w>)</w><pc>.</pc><w>The</w><w>6,692</w><w>entries</w><w>have</w><w>been</w><w>pre-processed</w><w>by</w><w>the</w><w>author</w><w>and</w><w>saved</w><w>to</w><w>a</w><ref target="http://en.wikipedia.org/wiki/Comma-separated_values"><w>CSV</w><w>file</w></ref><w>with</w><w>one</w><w>entry</w><w>per</w><w>row</w><pc>.</pc></p><p><w>In</w><w>this</w><w>tutorial</w><w>,</w><w>the</w><w>dataset</w><w>involves</w><w>geographical</w><w>keywords</w><pc>.</pc><w>Once</w><w>extracted</w><w>,</w><w>these</w><w>placenames</w><w>could</w><w>be</w><w>geo-referenced</w><w>to</w><w>their</w><w>place</w><w>on</w><w>the</w><w>globe</w><w>and</w><w>then</w><w>mapped</w><w>using</w><w>digital</w><w>mapping</w><pc>.</pc><w>This</w><w>might</w><w>make</w><w>it</w><w>possible</w><w>to</w><w>discern</w><w>which</w><w>colleges</w><w>attracted</w><w>students</w><w>from</w><w>what</w><w>parts</w><w>of</w><w>the</w><w>country</w><w>,</w><w>or</w><w>to</w><w>determine</w><w>if</w><w>these</w><w>patterns</w><w>changed</w><w>over</w><w>time</w><pc>.</pc><w>For</w><w>a</w><w>practical</w><w>tutorial</w><w>on</w><w>taking</w><w>this</w><w>next</w><w>step</w><w>,</w><w>see</w><w>the</w><w>lesson</w><w>by</w><w>Fred</w><w>Gibbs</w><w>mentioned</w><w>at</w><w>the</w><w>end</w><w>of</w><w>this</w><w>lesson</w><pc>.</pc><w>Readers</w><w>may</w><w>also</w><w>be</w><w>interested</w><w>in</w><ref target="/lessons/georeferencing-qgis"><w>georeferencing</w><w>in</w><w>QGIS</w><w>2.0</w></ref><w>,</w><w>also</w><w>available</w><w>from</w><w>the</w><emph><w>Programming</w><w>Historian</w></emph><pc>.</pc></p><p><w>This</w><w>approach</w><w>is</w><w>not</w><w>limited</w><w>to</w><w>geographical</w><w>keywords</w><w>,</w><w>however</w><pc>.</pc><w>It</w><w>could</w><w>also</w><w>be</w><w>used</w><w>to</w><w>extract</w><w>given</w><w>names</w><w>,</w><w>prepositions</w><w>,</w><w>food</w><w>words</w><w>,</w><w>or</w><w>any</w><w>other</w><w>set</w><w>of</w><w>terms</w><w>defined</w><w>by</w><w>the</w><w>user</w><pc>.</pc><w>This</w><w>process</w><w>could</w><w>therefore</w><w>be</w><w>useful</w><w>for</w><w>someone</w><w>seeking</w><w>to</w><w>isolate</w><w>individual</w><w>entries</w><w>containing</w><w>any</w><w>of</w><w>these</w><w>keywords</w><w>,</w><w>or</w><w>for</w><w>someone</w><w>looking</w><w>to</w><w>calculate</w><w>the</w><w>frequency</w><w>of</w><w>their</w><w>keywords</w><w>within</w><w>a</w><w>corpus</w><w>of</w><w>texts</w><pc>.</pc><w>This</w><w>tutorial</w><w>provides</w><w>pathways</w><w>into</w><w>textual</w><w>or</w><w>geospatial</w><w>analyses</w><w>,</w><w>rather</w><w>than</w><w>research</w><w>answers</w><w>in</w><w>its</w><w>own</w><w>right</w><pc>.</pc></p><p><w>Data</w><w>management</w><w>skills</w><w>are</w><w>increasingly</w><w>crucial</w><w>for</w><w>historians</w><w>and</w><w>textual</w><w>scholars</w><w>,</w><w>and</w><w>anyone</w><w>working</w><w>with</w><w>particularly</w><w>messy</w><w>or</w><w>difficult</w><w>texts</w><w>might</w><w>consider</w><w>looking</w><w>into</w><ref target="/lessons/cleaning-data-with-openrefine"><w>Cleaning</w><w>Data</w><w>with</w><w>OpenRefine</w></ref><w>by</w><w>Seth</w><w>van</w><w>Hooland</w><w>et</w><w>al</w><pc>.</pc><w>The</w><w>approach</w><w>outlined</w><w>in</w><w>this</w><w>tutorial</w><w>is</w><w>not</w><w>optimised</w><w>for</w><w>working</w><w>with</w><w>poorly</w><w>transcribed</w><w>texts</w><w>such</w><w>as</w><w>text</w><w>converted</w><w>through</w><ref target="https://en.wikipedia.org/wiki/Optical_character_recognition"><w>Optical</w><w>Character</w><w>Recognition</w></ref><w>if</w><w>the</w><w>software</w><w>has</w><w>a</w><w>high</w><w>error</w><w>rate</w><pc>.</pc><w>Readers</w><w>working</w><w>with</w><w>early</w><w>modern</w><w>texts</w><w>with</w><w>non-standardised</w><w>spelling</w><w>may</w><w>also</w><w>find</w><w>this</w><w>approach</w><w>challenging</w><w>,</w><w>as</w><w>the</w><w>gazetteer</w><w>one</w><w>uses</w><w>must</w><w>contain</w><w>exact</w><w>matches</w><w>of</w><w>the</w><w>words</w><w>sought</w><pc>.</pc><w>However</w><w>,</w><w>with</w><w>a</w><w>good</w><w>enough</w><w>gazetteer</w><w>,</w><w>this</w><w>approach</w><w>could</w><w>prove</w><w>quite</w><w>useful</w><w>for</w><w>early</w><w>modernites</w><w>,</w><w>and</w><w>may</w><w>exceed</w><w>what</w><w>'s</w><w>practical</w><w>with</w><w>traditional</w><w>keyword</w><w>searching</w><w>by</w><w>making</w><ref target="https://en.wikipedia.org/wiki/Approximate_string_matching"><w>fuzzy</w><w>searching</w></ref><w>possible</w><pc>.</pc></p><p><w>This</w><w>tutorial</w><w>assumes</w><w>that</w><w>you</w><w>have</w><w>already</w><w>installed</w><w>Python</w><w>version</w><w>3</w><w>on</w><w>your</w><w>computer</w><pc>.</pc><w>The</w><w>lesson</w><w>will</w><w>use</w><w>the</w><w>Command</w><w>Line</w><w>to</w><w>run</w><w>Python</w><w>,</w><w>as</w><w>this</w><w>is</w><w>more</w><w>flexible</w><w>and</w><w>makes</w><w>it</w><w>possible</w><w>for</w><w>use</w><w>in</w><w>classrooms</w><w>or</w><w>computer</w><w>labs</w><w>in</w><w>which</w><w>students</w><w>do</w><w>not</w><w>have</w><w>the</w><w>ability</w><w>to</w><w>download</w><w>and</w><w>install</w><w>interactive</w><w>development</w><w>environments</w><w>(</w><w>IDEs</w><w>)</w><w>like</w><w>Komodo</w><w>Edit</w><pc>.</pc><w>Readers</w><w>who</w><w>would</w><w>prefer</w><w>to</w><w>use</w><w>an</w><w>IDE</w><w>might</w><w>like</w><w>to</w><w>first</w><w>read</w><ref target="/lessons/introduction-and-installation"><w>Python</w><w>Introduction</w><w>and</w><w>Installation</w></ref><w>,</w><w>but</w><w>this</w><w>is</w><w>optional</w><pc>.</pc><w>The</w><w>tutorial</w><w>also</w><w>makes</w><w>some</w><w>basic</w><w>assumptions</w><w>about</w><w>your</w><w>Python</w><w>skills</w><pc>.</pc><w>It</w><w>assumes</w><w>you</w><w>know</w><w>what</w><w>the</w><w>following</w><w>Python</w><w>data</w><w>structures</w><w>are</w><w>(</w><w>though</w><w>not</w><w>knowing</w><w>will</w><w>not</w><w>prevent</w><w>the</w><w>code</w><w>from</w><w>working</w><w>should</w><w>you</w><w>follow</w><w>all</w><w>of</w><w>the</w><w>steps</w><w>in</w><w>the</w><w>tutorial</w><w>)</w><w>:</w></p><list type="unordered"><item><ref target="https://docs.python.org/3/tutorial/datastructures.html"><w>List</w></ref></item><item><ref target="https://docs.python.org/3/tutorial/controlflow.html"><w>For</w><w>Loop</w></ref></item><item><ref target="https://docs.python.org/3/library/string.html"><w>String</w></ref></item></list><p><w>The</w><w>lesson</w><w>touches</w><w>on</w><w>Regular</w><w>Expressions</w><w>,</w><w>so</w><w>some</w><w>readers</w><w>may</w><w>find</w><w>it</w><w>handy</w><w>to</w><w>have</w><w>the</w><w>relevant</w><w>Programming</w><w>Historian</w><w>lessons</w><w>by</w><ref target="/lessons/understanding-regular-expressions"><w>Doug</w><w>Knox</w></ref><w>or</w><ref target="/lessons/cleaning-ocrd-text-with-regular-expressions"><w>Laura</w><w>Turner</w><w>O'Hara</w></ref><w>open</w><w>to</w><w>consult</w><w>as</w><w>needed</w><pc>.</pc></p></div><div type="2" n="3"><head><w>Familiarising</w><w>yourself</w><w>with</w><w>the</w><w>data</w></head><p><w>The</w><w>first</w><w>step</w><w>of</w><w>this</w><w>process</w><w>is</w><w>to</w><w>take</w><w>a</w><w>look</w><w>at</w><w>the</w><w>data</w><w>that</w><w>we</w><w>will</w><w>be</w><w>using</w><w>in</w><w>the</w><w>lesson</w><pc>.</pc><w>As</w><w>mentioned</w><w>,</w><w>the</w><w>data</w><w>includes</w><w>biographical</w><w>details</w><w>of</w><w>approximately</w><w>6,692</w><w>graduates</w><w>who</w><w>began</w><w>study</w><w>at</w><w>the</w><w>University</w><w>of</w><w>Oxford</w><w>in</w><w>the</w><w>early</w><w>seventeenth</w><w>century</w><pc>.</pc></p><p><ref target="/assets/The_Dataset_-_Alumni_Oxonienses-Jas1.csv"><w>The_Dataset_-_Alumni_Oxonienses-Jas1.csv</w></ref><w>(</w><w>1.4MB</w><w>)</w></p><figure><desc><w>Screenshot</w><w>of</w><w>the</w><w>first</w><w>forty</w><w>entries</w><w>in</w><w>the</w><w>dataset</w></desc><graphic url="extracting-keywords-1.png"/></figure><p><w>Download</w><w>the</w><w>dataset</w><w>and</w><w>spend</w><w>a</w><w>couple</w><w>of</w><w>minutes</w><w>looking</w><w>at</w><w>the</w><w>types</w><w>of</w><w>information</w><w>available</w><pc>.</pc><w>You</w><w>should</w><w>notice</w><w>three</w><w>columns</w><w>of</w><w>information</w><pc>.</pc><w>The</w><w>first</w><w>,</w><w>'Name</w><w>'</w><w>,</w><w>contains</w><w>the</w><w>name</w><w>of</w><w>the</w><w>graduate</w><pc>.</pc><w>The</w><w>second</w><w>:</w><w>'Details</w><w>'</w><w>,</w><w>contains</w><w>the</w><w>biographical</w><w>information</w><w>known</w><w>about</w><w>that</w><w>person</w><pc>.</pc><w>The</w><w>final</w><w>column</w><w>,</w><w>'Matriculation</w><w>Year</w><w>'</w><w>,</w><w>contains</w><w>the</w><w>year</w><w>in</w><w>which</w><w>the</w><w>person</w><w>matriculated</w><w>(</w><w>began</w><w>their</w><w>studies</w><w>)</w><pc>.</pc><w>This</w><w>final</w><w>column</w><w>was</w><w>extracted</w><w>from</w><w>the</w><w>details</w><w>column</w><w>in</w><w>the</w><w>pre-processing</w><w>stage</w><w>of</w><w>this</w><w>tutorial</w><pc>.</pc><w>The</w><w>first</w><w>two</w><w>columns</w><w>are</w><w>as</w><w>you</w><w>would</w><w>find</w><w>them</w><w>on</w><w>the</w><w>British</w><w>History</w><w>Online</w><w>version</w><w>of</w><w>the</w><emph><w>Alumni</w><w>Oxonienses</w></emph><pc>.</pc><w>If</w><w>you</w><w>notice</w><w>more</w><w>than</w><w>three</w><w>columns</w><w>then</w><w>your</w><w>spreadsheet</w><w>programme</w><w>has</w><w>incorrectly</w><w>set</w><w>the</w><ref target="https://en.wikipedia.org/wiki/Delimiter"><w>delimiter</w></ref><w>between</w><w>columns</w><pc>.</pc><w>It</w><w>should</w><w>be</w><w>set</w><w>to</w><w>``</w><w>,</w><w>''</w><w>(</w><w>double</w><w>quotes</w><w>,</w><w>comma</w><w>)</w><pc>.</pc><w>How</w><w>you</w><w>do</w><w>this</w><w>depends</w><w>on</w><w>your</w><w>spreadsheet</w><w>programme</w><w>,</w><w>but</w><w>you</w><w>should</w><w>be</w><w>able</w><w>to</w><w>find</w><w>the</w><w>solution</w><w>online</w><pc>.</pc></p><p><w>Most</w><w>(</w><w>but</w><w>not</w><w>all</w><w>)</w><w>of</w><w>these</w><w>bibliographic</w><w>entries</w><w>contain</w><w>enough</w><w>information</w><w>to</w><w>tell</w><w>us</w><w>what</w><w>county</w><w>the</w><w>graduate</w><w>came</w><w>from</w><pc>.</pc><w>Notice</w><w>that</w><w>a</w><w>large</w><w>number</w><w>of</w><w>entries</w><w>contain</w><w>placenames</w><w>that</w><w>correspond</w><w>to</w><w>either</w><w>major</w><w>cities</w><w>(</w><w>'of</w><w>London</w><w>'</w><w>,</w><w>in</w><w>the</w><w>first</w><w>entry</w><w>)</w><w>or</w><w>English</w><w>counties</w><w>(</w><w>'of</w><w>Middlesex</w><w>'</w><w>in</w><w>entry</w><w>5</w><w>or</w><w>'of</w><w>Wilts</w><w>'</w><w>-</w><w>short</w><w>for</w><w>Wiltshire</w><w>in</w><w>entry</w><w>6</w><w>)</w><pc>.</pc><w>If</w><w>you</w><w>are</w><w>not</w><w>British</w><w>you</w><w>may</w><w>not</w><w>be</w><w>familiar</w><w>with</w><w>these</w><w>county</w><w>names</w><pc>.</pc><w>You</w><w>can</w><w>find</w><w>a</w><w>list</w><w>of</w><ref target="http://en.wikipedia.org/wiki/Historic_counties_of_England"><w>historic</w><w>counties</w><w>of</w><w>England</w></ref><w>on</w><w>Wikipedia</w><pc>.</pc></p><p><w>Unfortunately</w><w>,</w><w>the</w><w>information</w><w>is</w><w>not</w><w>always</w><w>available</w><w>in</w><w>the</w><w>same</w><w>format</w><pc>.</pc><w>Sometimes</w><w>it</w><w>'s</w><w>the</w><w>first</w><w>thing</w><w>mentioned</w><w>in</w><w>an</w><w>entry</w><pc>.</pc><w>Sometimes</w><w>it</w><w>'s</w><w>in</w><w>the</w><w>middle</w><pc>.</pc><w>Our</w><w>challenge</w><w>is</w><w>to</w><w>extract</w><w>those</w><w>counties</w><w>of</w><w>origin</w><w>from</w><w>within</w><w>this</w><w>messy</w><w>text</w><w>,</w><w>and</w><w>store</w><w>it</w><w>in</w><w>a</w><w>new</w><w>column</w><w>next</w><w>to</w><w>that</w><w>person</w><w>'s</w><w>entry</w><pc>.</pc></p></div><div type="2" n="4"><head><w>Build</w><w>your</w><w>gazetteer</w></head><p><w>In</w><w>order</w><w>to</w><w>extract</w><w>the</w><w>relevant</w><w>place</w><w>names</w><w>,</w><w>we</w><w>first</w><w>have</w><w>to</w><w>decide</w><w>what</w><w>they</w><w>are</w><pc>.</pc><w>We</w><w>need</w><w>a</w><w>list</w><w>of</w><w>places</w><w>,</w><w>often</w><w>called</w><w>a</w><w>gazetteer</w><pc>.</pc><w>Many</w><w>of</w><w>the</w><w>place</w><w>names</w><w>mentioned</w><w>in</w><w>the</w><w>records</w><w>are</w><w>shortforms</w><w>,</w><w>such</w><w>as</w><w>'Wilts</w><w>'</w><w>instead</w><w>of</w><w>'Wiltshire</w><w>'</w><w>,</w><w>or</w><w>'Salop</w><w>'</w><w>instead</w><w>of</w><w>'Shropshire</w><w>'</w><pc>.</pc><w>Getting</w><w>all</w><w>of</w><w>these</w><w>variations</w><w>may</w><w>be</w><w>tricky</w><pc>.</pc><w>For</w><w>a</w><w>start</w><w>,</w><w>let</w><w>'s</w><w>build</w><w>a</w><w>basic</w><w>gazetteer</w><w>of</w><w>English</w><w>counties</w><pc>.</pc></p><p><w>Make</w><w>a</w><w>new</w><w>directory</w><w>(</w><w>folder</w><w>)</w><w>on</w><w>your</w><w>computer</w><w>where</w><w>you</w><w>will</w><w>save</w><w>all</w><w>of</w><w>your</w><w>work</w><pc>.</pc><w>Create</w><w>a</w><w>text</w><w>file</w><w>called</w><code rend="inline"><w>gazetteer.txt</w></code><w>and</w><w>using</w><w>the</w><w>entries</w><w>listed</w><w>on</w><w>the</w><w>Wikipedia</w><w>page</w><w>listed</w><w>above</w><w>,</w><w>add</w><w>each</w><w>county</w><w>to</w><w>a</w><w>new</w><w>line</w><w>on</w><w>the</w><w>text</w><w>file</w><pc>.</pc><w>It</w><w>should</w><w>look</w><w>something</w><w>like</w><w>this</w><w>:</w></p><ab><code lang="language-text" xml:id="code_extracting-keywords_0" corresp="code_extracting-keywords_0.txt" rend="block"/></ab><p><w>Make</w><w>sure</w><w>that</w><w>there</w><w>are</w><w>no</w><w>blank</w><w>lines</w><w>in</w><w>the</w><w>gazetteer</w><w>file</w><pc>.</pc><w>If</w><w>there</w><w>are</w><w>,</w><w>your</w><w>program</w><w>will</w><w>think</w><w>all</w><w>spaces</w><w>are</w><w>a</w><w>matching</w><w>keyword</w><pc>.</pc><w>Some</w><w>text</w><w>editing</w><w>programs</w><w>(</w><w>particularly</w><w>in</w><w>Linux</w><w>)</w><w>will</w><w>want</w><w>to</w><w>add</w><w>a</w><w>blank</w><w>line</w><w>at</w><w>the</w><w>end</w><w>of</w><w>your</w><w>file</w><pc>.</pc><w>If</w><w>this</w><w>is</w><w>the</w><w>case</w><w>,</w><w>try</w><w>another</w><w>text</w><w>editor</w><pc>.</pc><w>It</w><w>'s</w><w>best</w><w>to</w><w>use</w><w>software</w><w>that</w><w>puts</w><w>you</w><w>in</w><w>control</w><pc>.</pc><w>For</w><w>more</w><w>on</w><w>this</w><w>problem</w><w>,</w><w>see</w><ref target="http://stackoverflow.com/questions/3056740/gedit-adds-line-at-end-of-file"><w>the</w><w>explanation</w><w>on</w><w>Stack</w><w>Overflow</w></ref><w>-</w><w>with</w><w>thanks</w><w>to</w><w>John</w><w>Levin</w><w>for</w><w>the</w><w>link</w><pc>.</pc></p><p><w>If</w><w>you</w><w>ever</w><w>need</w><w>to</w><w>add</w><w>to</w><w>this</w><w>set</w><w>of</w><w>keywords</w><w>,</w><w>you</w><w>can</w><w>open</w><w>this</w><w>file</w><w>in</w><w>your</w><w>text</w><w>editor</w><w>and</w><w>add</w><w>new</w><w>words</w><w>,</w><w>each</w><w>on</w><w>their</w><w>own</w><w>line</w><pc>.</pc><w>Komodo</w><w>Edit</w><w>is</w><w>a</w><w>good</w><w>text</w><w>editor</w><w>for</w><w>this</w><w>task</w><w>,</w><w>especially</w><w>if</w><w>you</w><w>have</w><w>set</w><w>it</w><w>up</w><w>to</w><w>run</w><w>with</w><w>Python</w><w>,</w><w>but</w><w>you</w><w>can</w><w>also</w><w>use</w><w>any</w><w>plain</w><w>text</w><w>editor</w><w>as</w><w>long</w><w>as</w><w>it</w><w>is</w><emph><w>not</w></emph><w>a</w><ref target="http://en.wikipedia.org/wiki/Word_processor"><w>word</w><w>processor</w></ref><w>such</w><w>as</w><w>Microsoft</w><w>Word</w><w>or</w><w>Open</w><w>Office</w><pc>.</pc><w>Word</w><w>processors</w><w>are</w><w>inappropriate</w><w>for</w><w>writing</w><w>code</w><w>because</w><w>of</w><w>how</w><w>they</w><w>stylise</w><w>apostrophes</w><w>and</w><w>quotes</w><w>,</w><w>causing</w><w>havoc</w><w>for</w><w>your</w><w>code</w><pc>.</pc></p></div><div type="2" n="5"><head><w>Loading</w><w>your</w><w>texts</w></head><p><w>The</w><w>next</w><w>step</w><w>is</w><w>to</w><w>put</w><w>the</w><w>texts</w><w>that</w><w>you</w><w>want</w><w>to</w><w>search</w><w>into</w><w>another</w><w>text</w><w>file</w><w>,</w><w>with</w><w>one</w><w>entry</w><w>per</w><w>line</w><pc>.</pc><w>The</w><w>easiest</w><w>way</w><w>to</w><w>do</w><w>that</w><w>is</w><w>to</w><w>open</w><w>the</w><w>spreadsheet</w><w>and</w><w>select</w><w>all</w><w>of</w><w>the</w><w>second</w><w>(</w><w>details</w><w>)</w><w>column</w><w>,</w><w>then</w><w>paste</w><w>the</w><w>contents</w><w>into</w><w>a</w><w>.txt</w><w>file</w><pc>.</pc><w>Call</w><w>the</w><w>file</w><code rend="inline"><w>texts.txt</w></code><w>and</w><w>save</w><w>it</w><w>to</w><w>the</w><w>same</w><w>directory</w><w>as</w><w>your</w><code rend="inline"><w>gazetteer.txt</w></code><w>file</w><pc>.</pc><w>Your</w><w>directory</w><w>should</w><w>look</w><w>something</w><w>like</w><w>this</w><w>:</w></p><figure><desc><w>Contents</w><w>of</w><w>your</w><w>working</w><w>directory</w></desc><graphic url="extracting-keywords-2.png"/></figure><p><w>The</w><w>reason</w><w>we</w><w>do</w><w>this</w><w>is</w><w>to</w><w>keep</w><w>the</w><w>original</w><w>data</w><w>(</w><w>the</w><w>.CSV</w><w>file</w><w>)</w><w>away</w><w>from</w><w>the</w><w>Python</w><w>program</w><w>we</w><w>are</w><w>about</w><w>to</w><w>write</w><w>,</w><w>on</w><w>the</w><w>off-chance</w><w>that</w><w>we</w><w>accidentally</w><w>change</w><w>something</w><w>without</w><w>noticing</w><pc>.</pc><w>In</w><w>my</w><w>opinion</w><w>,</w><w>this</w><w>approach</w><w>also</w><w>makes</w><w>for</w><w>easier</w><w>to</w><w>read</w><w>code</w><w>,</w><w>which</w><w>is</w><w>important</w><w>when</w><w>learning</w><pc>.</pc><w>It</w><w>is</w><w>not</w><w>strictly</w><w>necessary</w><w>to</w><w>use</w><w>a</w><w>.txt</w><w>file</w><w>for</w><w>this</w><w>step</w><w>,</w><w>as</w><w>Python</w><w>does</w><w>have</w><w>ways</w><w>of</w><w>opening</w><w>and</w><w>reading</w><w>CSV</w><w>files</w><pc>.</pc><w>At</w><w>the</w><w>end</w><w>of</w><w>this</w><w>lesson</w><w>we</w><w>will</w><w>look</w><w>at</w><w>how</w><w>to</w><w>use</w><w>the</w><w>CSV</w><w>reading</w><w>and</w><w>writing</w><w>features</w><w>in</w><w>Python</w><w>,</w><w>but</w><w>this</w><w>is</w><w>an</w><w>optional</w><w>advanced</w><w>step</w><pc>.</pc></p></div><div type="2" n="6"><head><w>Write</w><w>your</w><w>Python</w><w>program</w></head><p><w>The</w><w>last</w><w>step</w><w>is</w><w>to</w><w>write</w><w>a</w><w>program</w><w>that</w><w>will</w><w>check</w><w>each</w><w>of</w><w>the</w><w>texts</w><w>for</w><w>each</w><w>of</w><w>the</w><w>keywords</w><w>in</w><w>the</w><w>gazetteer</w><w>,</w><w>and</w><w>then</w><w>to</w><w>provide</w><w>an</w><w>output</w><w>that</w><w>will</w><w>tell</w><w>us</w><w>which</w><w>entries</w><w>in</w><w>our</w><w>spreadsheet</w><w>contain</w><w>which</w><w>of</w><w>those</w><w>words</w><pc>.</pc><w>There</w><w>are</w><w>lots</w><w>of</w><w>ways</w><w>that</w><w>this</w><w>could</w><w>be</w><w>achieved</w><pc>.</pc><w>When</w><w>planning</w><w>to</w><w>write</w><w>a</w><w>program</w><w>,</w><w>it</w><w>is</w><w>always</w><w>a</w><w>good</w><w>idea</w><w>to</w><w>devise</w><w>an</w><w>algorithm</w><pc>.</pc><w>An</w><w>algorithm</w><w>is</w><w>a</w><w>set</w><w>of</w><w>human-readable</w><w>steps</w><w>that</w><w>will</w><w>solve</w><w>the</w><w>problem</w><pc>.</pc><w>It</w><w>'s</w><w>a</w><w>list</w><w>of</w><w>what</w><w>you</w><w>are</w><w>going</w><w>to</w><w>do</w><w>,</w><w>which</w><w>you</w><w>then</w><w>convert</w><w>into</w><w>the</w><w>appropriate</w><w>programmatic</w><w>instructions</w><pc>.</pc><w>The</w><w>approach</w><w>we</w><w>will</w><w>take</w><w>here</w><w>uses</w><w>the</w><w>following</w><w>algorithm</w><w>:</w></p><list type="ordered"><item><w>Load</w><w>the</w><w>list</w><w>of</w><w>keywords</w><w>that</w><w>you</w><w>'ve</w><w>created</w><w>in</w><code rend="inline"><w>gazetteer.txt</w></code><w>and</w><w>save</w><w>them</w><w>each</w><w>to</w><w>a</w><w>Python</w><w>list</w></item><item><w>Load</w><w>the</w><w>texts</w><w>from</w><code rend="inline"><w>texts.txt</w></code><w>and</w><w>save</w><w>each</w><w>one</w><w>to</w><w>another</w><w>Python</w><w>list</w></item><item><w>Then</w><w>for</w><w>each</w><w>biographical</w><w>entry</w><w>,</w><w>remove</w><w>the</w><w>unwanted</w><w>punctuation</w><w>(</w><w>periods</w><w>,</w><w>commas</w><w>,</w><w>etc</w><w>)</w></item><item><w>Then</w><w>check</w><w>for</w><w>the</w><w>presence</w><w>of</w><w>one</w><w>or</w><w>more</w><w>of</w><w>the</w><w>keywords</w><w>from</w><w>your</w><w>list</w><pc>.</pc><w>If</w><w>it</w><w>finds</w><w>a</w><w>match</w><w>,</w><w>store</w><w>it</w><w>while</w><w>it</w><w>checks</w><w>for</w><w>other</w><w>matches</w><pc>.</pc><w>If</w><w>it</w><w>finds</w><w>no</w><w>match</w><w>,</w><w>move</w><w>on</w><w>to</w><w>the</w><w>next</w><w>entry</w></item><item><w>Finally</w><w>,</w><w>output</w><w>the</w><w>results</w><w>in</w><w>a</w><w>format</w><w>that</w><w>can</w><w>be</w><w>easily</w><w>transferred</w><w>back</w><w>to</w><w>the</w><w>CSV</w><w>file</w><pc>.</pc></item></list><div type="3" n="6.1"><head><w>Step</w><w>1</w><w>:</w><w>Load</w><w>the</w><w>Keywords</w></head><p><w>Using</w><w>your</w><w>text</w><w>editor</w><w>,</w><w>create</w><w>a</w><w>new</w><w>empty</w><w>file</w><w>,</w><w>and</w><w>add</w><w>the</w><w>following</w><w>lines</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_1" corresp="code_extracting-keywords_1.txt" rend="block"/></ab><p><w>The</w><w>first</w><w>line</w><w>is</w><w>a</w><w>comment</w><w>for</w><w>our</w><w>own</w><w>benefit</w><w>,</w><w>to</w><w>tells</w><w>us</w><w>(</w><w>the</w><w>human</w><w>)</w><w>what</w><w>the</w><w>code</w><w>does</w><pc>.</pc><w>All</w><w>Python</w><w>lines</w><w>beginning</w><w>with</w><w>a</w><w>#</w><w>are</w><w>a</w><w>comment</w><pc>.</pc><w>When</w><w>the</w><w>code</w><w>runs</w><w>it</w><w>will</w><w>ignore</w><w>the</w><w>comments</w><pc>.</pc><w>They</w><w>are</w><w>for</w><w>human</w><w>use</w><w>only</w><pc>.</pc><w>A</w><w>well</w><w>commented</w><w>piece</w><w>of</w><w>code</w><w>is</w><w>easier</w><w>to</w><w>return</w><w>to</w><w>later</w><w>because</w><w>you</w><w>will</w><w>have</w><w>the</w><w>means</w><w>of</w><w>decyphering</w><w>your</w><w>earlier</w><w>creation</w><pc>.</pc></p><p><w>The</w><w>second</w><w>line</w><w>opens</w><w>the</w><code rend="inline"><w>gazetteer.txt</w></code><w>file</w><w>,</w><w>and</w><w>reads</w><w>it</w><w>,</w><w>which</w><w>is</w><w>signified</w><w>by</w><w>the</w><w>'</w><w>r</w><w>'</w><w>(</w><w>as</w><w>opposed</w><w>to</w><w>'</w><w>w</w><w>'</w><w>for</w><w>write</w><w>,</w><w>or</w><w>'</w><w>a</w><w>'</w><w>for</w><w>append</w><w>)</w><pc>.</pc><w>That</w><w>means</w><w>we</w><w>will</w><w>not</w><w>be</w><w>changing</w><w>the</w><w>contents</w><w>of</w><w>the</w><w>file</w><pc>.</pc><w>Only</w><w>reading</w><w>it</w><pc>.</pc></p><p><w>The</w><w>third</w><w>line</w><w>reads</w><w>everything</w><w>in</w><w>that</w><w>file</w><w>,</w><w>converts</w><w>it</w><w>to</w><code rend="inline"><w>lower</w><w>(</w><w>)</w></code><w>case</w><w>,</w><w>and</w><w>splits</w><w>the</w><w>contents</w><w>into</w><w>a</w><w>Python</w><w>list</w><w>,</w><w>using</w><w>the</w><ref target="http://stackoverflow.com/questions/11497376/new-line-python"><w>newline</w><w>character</w></ref><w>as</w><w>the</w><w>delimiter</w><pc>.</pc><w>Effectively</w><w>that</w><w>means</w><w>each</w><w>time</w><w>the</w><w>program</w><w>comes</w><w>across</w><w>a</w><w>new</w><w>line</w><w>,</w><w>it</w><w>stores</w><w>it</w><w>as</w><w>a</w><w>new</w><w>entry</w><pc>.</pc><w>We</w><w>then</w><w>save</w><w>that</w><w>Python</w><w>list</w><w>containing</w><w>the</w><w>39</w><w>counties</w><w>into</w><w>a</w><w>variable</w><w>that</w><w>we</w><w>have</w><w>called</w><code rend="inline"><w>allKeywords</w></code><pc>.</pc></p><p><w>The</w><w>fourth</w><w>line</w><w>closes</w><w>the</w><w>open</w><w>text</w><w>file</w><pc>.</pc><w>The</w><w>fifth</w><w>line</w><w>prints</w><w>out</w><w>the</w><w>results</w><w>,</w><w>and</w><w>the</w><w>sixth</w><w>line</w><w>tells</w><w>us</w><w>how</w><w>many</w><w>results</w><w>were</w><w>found</w><pc>.</pc></p><p><w>Save</w><w>this</w><w>file</w><w>as</w><code rend="inline"><w>extractKeywords.py</w></code><w>,</w><w>again</w><w>to</w><w>the</w><w>same</w><w>folder</w><w>as</w><w>the</w><w>other</w><w>files</w><w>,</w><w>and</w><w>then</w><w>run</w><w>it</w><w>with</w><w>Python</w><pc>.</pc><w>To</w><w>do</w><w>this</w><w>from</w><w>the</w><w>command</w><w>line</w><w>,</w><w>first</w><w>you</w><w>need</w><w>to</w><w>launch</w><w>your</w><w>command</w><w>line</w><w>terminal</w><pc>.</pc></p><p><w>On</w><w>Windows</w><w>it</w><w>is</w><w>called</w><code rend="inline"><w>Command</w><w>Prompt</w></code><pc>.</pc><w>Windows</w><w>users</w><w>may</w><w>find</w><w>it</w><w>easier</w><w>to</w><w>launch</w><w>Python</w><w>by</w><w>opening</w><w>the</w><w>folder</w><w>containing</w><w>your</w><code rend="inline"><w>extractKeywords.py</w></code><w>file</w><w>,</w><w>then</w><w>press</w><code rend="inline"><w>shift</w></code><w>+</w><code rend="inline"><w>right-click</w></code><w>and</w><w>then</w><w>select</w><w>'open</w><w>command</w><w>window</w><w>here</w><w>'</w><pc>.</pc><w>Assuming</w><w>you</w><w>have</w><w>Python</w><w>installed</w><w>,</w><w>you</w><w>should</w><w>be</w><w>able</w><w>to</w><w>run</w><w>your</w><w>programme</w><w>using</w><w>the</w><w>command</w><w>beginning</w><w>with</w><w>'python</w><w>'</w><w>below</w><pc>.</pc></p><p><w>On</w><w>Mac</w><w>OS</w><w>X</w><w>,</w><w>this</w><w>is</w><w>found</w><w>in</w><w>the</w><code rend="inline"><w>Applications</w></code><w>folder</w><w>and</w><w>is</w><w>called</w><code rend="inline"><w>Terminal</w></code><pc>.</pc><w>Once</w><w>the</w><w>Terminal</w><w>window</w><w>is</w><w>open</w><w>,</w><w>you</w><w>need</w><w>to</w><w>point</w><w>your</w><w>Terminal</w><w>at</w><w>the</w><w>directory</w><w>that</w><w>contains</w><w>all</w><w>of</w><w>the</w><w>files</w><w>you</w><w>have</w><w>just</w><w>created</w><pc>.</pc><w>I</w><w>have</w><w>called</w><w>my</w><w>directory</w><w>'ExtractingKeywordSets</w><w>'</w><w>and</w><w>I</w><w>have</w><w>it</w><w>on</w><w>my</w><w>computer</w><w>'s</w><w>Desktop</w><pc>.</pc><w>To</w><w>change</w><w>the</w><w>Terminal</w><w>to</w><w>this</w><w>directory</w><w>,</w><w>I</w><w>use</w><w>the</w><w>following</w><w>command</w><w>:</w></p><ab><code lang="language-bash" xml:id="code_extracting-keywords_2" corresp="code_extracting-keywords_2.txt" rend="block"/></ab><p><w>You</w><w>would</w><w>need</w><w>to</w><w>change</w><w>the</w><w>above</w><w>to</w><w>reflect</w><w>the</w><w>name</w><w>you</w><w>gave</w><w>your</w><w>directory</w><w>,</w><w>and</w><w>where</w><w>you</w><w>put</w><w>it</w><w>on</w><w>your</w><w>machine</w><pc>.</pc><w>Note</w><w>that</w><w>Windows</w><w>uses</w><w>``</w><w>instead</w><w>of</w><w>'/</w><w>'</w><w>in</w><w>file</w><w>paths</w><pc>.</pc><w>If</w><w>you</w><w>get</w><w>stuck</w><w>,</w><w>rename</w><w>your</w><w>directory</w><w>to</w><code rend="inline"><w>ExtractingKeywordSets</w></code><w>and</w><w>place</w><w>it</w><w>on</w><w>the</w><w>Desktop</w><w>so</w><w>that</w><w>you</w><w>can</w><w>follow</w><w>along</w><pc>.</pc></p><p><w>You</w><w>can</w><w>now</w><w>run</w><w>the</w><w>program</w><w>you</w><w>'ve</w><w>written</w><w>with</w><w>the</w><w>following</w><w>command</w><w>:</w></p><ab><code lang="language-bash" xml:id="code_extracting-keywords_3" corresp="code_extracting-keywords_3.txt" rend="block"/></ab><p><w>Once</w><w>you</w><w>have</w><w>run</w><w>the</w><w>program</w><w>you</w><w>should</w><w>see</w><w>your</w><w>gazetteer</w><w>printed</w><w>as</w><w>a</w><w>Python</w><w>list</w><w>in</w><w>the</w><w>command</w><w>output</w><w>,</w><w>along</w><w>with</w><w>the</w><w>number</w><w>of</w><w>entries</w><w>in</w><w>your</w><w>list</w><w>(</w><w>39</w><w>)</w><pc>.</pc><w>If</w><w>you</w><w>can</w><w>,</w><w>great</w><pc>!</pc><w>Move</w><w>on</w><w>to</w><w>step</w><w>2</w><pc>.</pc><w>If</w><w>the</w><w>last</w><w>line</w><w>of</w><w>your</w><w>output</w><w>tells</w><w>you</w><w>that</w><w>there</w><w>was</w><w>1</w><w>result</w><w>,</w><w>that</w><w>means</w><w>the</w><w>code</w><w>has</w><w>not</w><w>worked</w><w>properly</w><w>,</w><w>since</w><w>we</w><w>know</w><w>that</w><w>there</w><w>should</w><w>be</w><w>39</w><w>keywords</w><w>in</w><w>your</w><w>gazetteer</w><pc>.</pc><w>Double</w><w>check</w><w>your</w><w>code</w><w>to</w><w>make</w><w>sure</w><w>you</w><w>hav</w><w>n't</w><w>included</w><w>any</w><w>typos</w><pc>.</pc><w>If</w><w>you</w><w>still</w><w>ca</w><w>n't</w><w>solve</w><w>the</w><w>problem</w><w>,</w><w>try</w><w>changing</w><w>``</w><w>\n</w><w>''</w><w>to</w><w>``</w><w>\r</w><w>''</w><w>on</w><w>line</w><w>three</w><pc>.</pc><w>Some</w><w>text</w><w>editors</w><w>will</w><w>use</w><ref target="http://en.wikipedia.org/wiki/Carriage_return"><w>carriage</w><w>returns</w></ref><w>instead</w><w>of</w><w>'newline</w><w>characters</w><w>'</w><w>when</w><w>creating</w><w>a</w><w>new</w><w>line</w><pc>.</pc><w>The</w><w>\r</w><w>means</w><w>'carriage</w><w>return</w><w>'</w><w>and</w><w>should</w><w>solve</w><w>your</w><w>problem</w><w>if</w><w>you</w><w>'re</w><w>experiencing</w><w>one</w><pc>.</pc></p></div><div type="3" n="6.2"><head><w>Step</w><w>2</w><w>:</w><w>Load</w><w>the</w><w>texts</w></head><p><w>The</w><w>second</w><w>step</w><w>is</w><w>very</w><w>similar</w><w>to</w><w>the</w><w>first</w><pc>.</pc><w>Except</w><w>this</w><w>time</w><w>we</w><w>will</w><w>load</w><w>the</w><code rend="inline"><w>texts.txt</w></code><w>in</w><w>addition</w><w>to</w><w>the</w><code rend="inline"><w>gazetteer.txt</w></code><w>file</w></p><p><w>Add</w><w>the</w><w>following</w><w>lines</w><w>to</w><w>the</w><w>end</w><w>of</w><w>your</w><w>code</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_4" corresp="code_extracting-keywords_4.txt" rend="block"/></ab><p><w>If</w><w>you</w><w>got</w><w>step</w><w>1</w><w>to</w><w>work</w><w>,</w><w>you</w><w>should</w><w>understand</w><w>this</w><w>bit</w><w>as</w><w>well</w><pc>.</pc><w>Before</w><w>you</w><w>run</w><w>the</w><w>code</w><w>,</w><w>make</w><w>sure</w><w>that</w><w>you</w><w>have</w><w>saved</w><w>your</w><w>program</w><w>or</w><w>you</w><w>may</w><w>accidentally</w><w>run</w><w>the</w><w>OLD</w><w>version</w><w>and</w><w>will</w><w>be</w><w>confused</w><w>with</w><w>the</w><w>result</w><pc>.</pc><w>Once</w><w>you</w><w>'ve</w><w>done</w><w>that</w><w>,</w><w>rerun</w><w>the</w><w>code</w><pc>.</pc><w>As</w><w>a</w><w>shortcut</w><w>,</w><w>instead</w><w>of</w><w>writing</w><w>out</w><w>the</w><w>command</w><w>again</w><w>in</w><w>the</w><w>Terminal</w><w>,</w><w>you</w><w>can</w><w>press</w><w>the</w><w>up</w><w>arrow</w><w>,</w><w>which</w><w>should</w><w>display</w><w>the</w><w>last</w><w>command</w><w>you</w><w>entered</w><pc>.</pc><w>If</w><w>you</w><w>keep</w><w>pressing</w><w>the</w><w>up</w><w>or</w><w>down</w><w>arrows</w><w>,</w><w>you</w><w>can</w><w>scroll</w><w>through</w><w>previous</w><w>commands</w><w>,</w><w>saving</w><w>yourself</w><w>the</w><w>time</w><w>needed</w><w>to</w><w>retype</w><w>them</w><pc>.</pc><w>Once</w><w>you</w><w>'ve</w><w>found</w><w>the</w><w>command</w><w>for</w><w>running</w><w>the</w><w>program</w><w>,</w><w>press</w><w>the</w><w>return</w><w>key</w><w>to</w><w>run</w><w>the</w><w>code</w><pc>.</pc></p><p><w>If</w><w>the</w><w>code</w><w>worked</w><w>,</w><w>you</w><w>should</w><w>see</w><w>a</w><w>big</w><w>wall</w><w>of</w><w>text</w><pc>.</pc><w>Those</w><w>are</w><w>the</w><w>texts</w><w>we</w><w>input</w><w>into</w><w>the</w><w>program</w><pc>.</pc><w>As</w><w>long</w><w>as</w><w>you</w><w>see</w><w>them</w><w>,</w><w>you</w><w>'re</w><w>ok.</w><w>Before</w><w>moving</w><w>on</w><w>to</w><w>the</w><w>next</w><w>step</w><w>,</w><w>delete</w><w>the</w><w>three</w><w>lines</w><w>from</w><w>your</w><w>code</w><w>beginning</w><w>with</w><w>'print</w><w>'</w><pc>.</pc><w>Now</w><w>that</w><w>we</w><w>know</w><w>they</w><w>are</w><w>printing</w><w>the</w><w>contents</w><w>of</w><w>these</w><w>files</w><w>properly</w><w>we</w><w>do</w><w>not</w><w>need</w><w>to</w><w>continue</w><w>to</w><w>check</w><pc>.</pc><w>Move</w><w>on</w><w>to</w><w>step</w><w>3</w><pc>.</pc></p></div><div type="3" n="6.3"><head><w>Step</w><w>3</w><w>:</w><w>Remove</w><w>unwanted</w><w>punctuation</w></head><p><w>When</w><w>matching</w><w>strings</w><w>,</w><w>you</w><w>have</w><w>to</w><w>make</w><w>sure</w><w>the</w><w>punctuation</w><w>does</w><w>n't</w><w>get</w><w>in</w><w>the</w><w>way</w><pc>.</pc><w>Technically</w><w>,</w><w>'London</w><pc>.</pc><w>'</w><w>is</w><w>a</w><w>different</w><w>string</w><w>than</w><w>'London</w><w>'</w><w>or</w><w>'</w><w>;</w><w>London</w><w>'</w><w>because</w><w>of</w><w>the</w><w>added</w><w>punctuation</w><pc>.</pc><w>These</w><w>three</w><w>strings</w><w>which</w><w>all</w><w>mean</w><w>the</w><w>same</w><w>thing</w><w>to</w><w>us</w><w>as</w><w>human</w><w>readers</w><w>will</w><w>be</w><w>viewed</w><w>by</w><w>the</w><w>computer</w><w>as</w><w>distinct</w><w>entities</w><pc>.</pc><w>To</w><w>solve</w><w>that</w><w>problem</w><w>,</w><w>the</w><w>easiest</w><w>thing</w><w>to</w><w>do</w><w>is</w><w>just</w><w>to</w><w>remove</w><w>all</w><w>of</w><w>the</w><w>punctuation</w><pc>.</pc><w>You</w><w>can</w><w>do</w><w>this</w><w>with</w><ref target="http://en.wikipedia.org/wiki/Regular_expression"><w>regular</w><w>expressions</w></ref><w>,</w><w>and</w><ref target="/lessons/understanding-regular-expressions"><w>Doug</w><w>Knox</w></ref><w>and</w><ref target="/lessons/cleaning-ocrd-text-with-regular-expressions"><w>Laura</w><w>Turner</w><w>O'Hara</w></ref><w>have</w><w>provided</w><w>great</w><w>introductions</w><w>at</w><emph><w>Programming</w><w>Historian</w></emph><w>for</w><w>doing</w><w>so</w><pc>.</pc></p><p><w>To</w><w>keep</w><w>things</w><w>simple</w><w>,</w><w>this</w><w>program</w><w>will</w><w>just</w><w>replace</w><w>the</w><w>most</w><w>common</w><w>types</w><w>of</w><w>punctuation</w><w>with</w><w>nothing</w><w>instead</w><w>(</w><w>effectively</w><w>deleting</w><w>punctuation</w><w>)</w><pc>.</pc></p><p><w>Add</w><w>the</w><w>following</w><w>lines</w><w>to</w><w>your</w><w>program</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_5" corresp="code_extracting-keywords_5.txt" rend="block"/></ab><p><w>The</w><w>'allTexts</w><w>'</w><w>list</w><w>variable</w><w>contains</w><w>all</w><w>of</w><w>our</w><w>texts</w><pc>.</pc><w>Using</w><w>a</w><w>for</w><w>loop</w><w>,</w><w>we</w><w>will</w><w>look</w><w>at</w><w>each</w><w>entry</w><w>in</w><w>turn</w><pc>.</pc></p><p><w>Since</w><w>we</w><w>are</w><w>interested</w><w>in</w><w>single</w><w>words</w><w>,</w><w>we</w><w>will</w><w>split</w><w>the</w><w>text</w><w>into</w><w>single</w><w>words</w><w>by</w><w>using</w><w>the</w><w>.split</w><w>(</w><w>)</w><w>method</w><w>,</w><w>looking</w><w>explicitly</w><w>for</w><w>spaces</w><w>:</w><code rend="inline"><w>entry.split</w><w>(</w><w>'</w><w>'</w><w>)</w></code><pc>.</pc><w>Note</w><w>that</w><w>there</w><w>is</w><w>a</w><w>single</w><w>space</w><w>between</w><w>those</w><w>quotation</w><w>marks</w><pc>.</pc><w>Since</w><w>words</w><w>are</w><w>generally</w><w>separated</w><w>by</w><w>spaces</w><w>,</w><w>this</w><w>should</w><w>work</w><w>fairly</w><w>well</w><pc>.</pc><w>This</w><w>means</w><w>we</w><w>now</w><w>have</w><w>a</w><w>Python</w><w>list</w><w>called</w><w>'allWords</w><w>'</w><w>that</w><w>contains</w><w>each</w><w>word</w><w>in</w><w>a</w><w>single</w><w>bibliographic</w><w>entry</w><pc>.</pc></p><p><w>We</w><w>use</w><w>another</w><w>for</w><w>loop</w><w>to</w><w>look</w><w>through</w><w>each</w><w>word</w><w>in</w><w>that</w><w>list</w><w>,</w><w>and</w><w>wherever</w><w>we</w><w>find</w><w>a</w><w>comma</w><w>,</w><w>period</w><w>,</w><w>or</w><w>semi-colon</w><w>,</w><w>we</w><w>replace</w><w>it</w><w>with</w><w>nothing</w><w>,</w><w>effectively</w><w>deleting</w><w>it</w><pc>.</pc><w>Note</w><w>that</w><w>there</w><w>is</w><w>no</w><w>space</w><w>between</w><w>those</w><w>quotation</w><w>marks</w><w>in</w><w>the</w><w>last</w><w>three</w><w>lines</w><pc>.</pc></p><p><w>We</w><w>now</w><w>have</w><w>a</w><w>clean</w><w>set</w><w>of</w><w>words</w><w>that</w><w>we</w><w>can</w><w>compare</w><w>against</w><w>our</w><w>gazetteer</w><w>entries</w><w>,</w><w>looking</w><w>for</w><w>matches</w><pc>.</pc></p></div><div type="3" n="6.4"><head><w>Step</w><w>4</w><w>:</w><w>Look</w><w>for</w><w>matching</w><w>keywords</w></head><p><w>As</w><w>the</w><w>words</w><w>from</w><w>our</w><w>text</w><w>are</w><w>already</w><w>in</w><w>a</w><w>list</w><w>called</w><w>'allWords</w><w>'</w><w>,</w><w>and</w><w>all</w><w>of</w><w>our</w><w>keywords</w><w>are</w><w>in</w><w>a</w><w>list</w><w>called</w><w>'allKeywords</w><w>'</w><w>,</w><w>all</w><w>we</w><w>have</w><w>to</w><w>do</w><w>now</w><w>is</w><w>check</w><w>our</w><w>texts</w><w>for</w><w>the</w><w>keywords</w><pc>.</pc></p><p><w>First</w><w>,</w><w>we</w><w>need</w><w>somewhere</w><w>to</w><w>store</w><w>details</w><w>of</w><w>any</w><w>matches</w><w>we</w><w>have</w><pc>.</pc><w>Immediately</w><w>after</w><w>the</w><w>'for</w><w>entry</w><w>in</w><w>allTexts</w><w>:</w><w>'</w><w>line</w><w>,</w><w>at</w><w>one</w><w>level</w><w>of</w><w>indentation</w><w>,</w><w>add</w><w>the</w><w>following</w><w>two</w><w>lines</w><w>of</w><w>code</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_6" corresp="code_extracting-keywords_6.txt" rend="block"/></ab><p><w>Indentation</w><w>is</w><w>important</w><w>in</w><w>Python</w><pc>.</pc><w>The</w><w>above</w><w>two</w><w>lines</w><w>should</w><w>be</w><w>indented</w><w>one</w><w>tab</w><w>deeper</w><w>than</w><w>the</w><w>for</w><w>loop</w><w>above</w><w>it</w><pc>.</pc><w>That</w><w>means</w><w>the</w><w>code</w><w>is</w><w>to</w><w>run</w><w>every</w><w>time</w><w>the</w><w>for</w><w>loop</w><w>runs</w><w>-</w><w>it</w><w>is</w><w>part</w><w>of</w><w>the</w><w>loop</w><pc>.</pc><w>If</w><w>your</w><w>text</w><w>editor</w><w>does</w><w>not</w><w>allow</w><w>tabs</w><w>,</w><w>you</w><w>can</w><w>use</w><w>spaces</w><w>instead</w><pc>.</pc></p><p><w>The</w><w>'storedMatches</w><w>'</w><w>variable</w><w>is</w><w>a</w><w>blank</w><w>list</w><w>,</w><w>where</w><w>we</w><w>can</w><w>store</w><w>our</w><w>matching</w><w>keywords</w><pc>.</pc><w>The</w><w>'matches</w><w>'</w><w>variable</w><w>is</w><w>known</w><w>as</w><w>a</w><w>'flag</w><w>'</w><w>,</w><w>which</w><w>we</w><w>will</w><w>use</w><w>in</w><w>the</w><w>next</w><w>step</w><w>when</w><w>we</w><w>start</w><w>printing</w><w>the</w><w>output</w><pc>.</pc></p><p><w>To</w><w>do</w><w>the</w><w>actual</w><w>matching</w><w>,</w><w>add</w><w>the</w><w>following</w><w>lines</w><w>of</w><w>code</w><w>to</w><w>the</w><w>bottom</w><w>of</w><w>your</w><w>program</w><w>,</w><w>again</w><w>minding</w><w>the</w><w>indentation</w><w>(</w><w>2</w><w>levels</w><w>from</w><w>the</w><w>left</w><w>margin</w><w>)</w><w>,</w><w>making</w><w>sure</w><w>you</w><w>save</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_7" corresp="code_extracting-keywords_7.txt" rend="block"/></ab><p><w>If</w><w>you</w><w>are</w><w>worried</w><w>that</w><w>you</w><w>have</w><w>your</w><w>indentation</w><w>wrong</w><w>,</w><w>scroll</w><w>ahead</w><w>towards</w><w>the</w><w>bottom</w><w>of</w><w>the</w><w>lesson</w><w>and</w><w>check</w><w>the</w><w>finished</w><w>code</w><pc>.</pc></p><p><w>Take</w><w>a</w><w>look</w><w>at</w><w>your</w><w>whole</w><w>program</w><pc>.</pc><w>These</w><w>lines</w><w>follow</w><w>immediately</w><w>after</w><w>the</w><w>last</w><w>section</w><w>in</w><w>which</w><w>you</w><w>removed</w><w>the</w><w>punctuation</w><pc>.</pc><w>So</w><w>each</w><w>time</w><w>a</w><w>word</w><w>had</w><w>its</w><w>punctuation</w><w>removed</w><w>(</w><w>if</w><w>it</w><w>had</w><w>punctuation</w><w>to</w><w>remove</w><w>in</w><w>the</w><w>first</w><w>place</w><w>)</w><w>it</w><w>was</w><w>immediately</w><w>checked</w><w>to</w><w>see</w><w>if</w><w>it</w><w>was</w><w>in</w><w>the</w><w>list</w><w>of</w><w>keywords</w><w>in</w><w>your</w><w>gazetteer</w><w>file</w><pc>.</pc><w>If</w><w>it</w><w>was</w><w>a</w><w>match</w><w>,</w><w>we</w><w>check</w><w>that</w><w>we</w><w>do</w><w>not</w><w>already</w><w>have</w><w>this</w><w>word</w><w>recorded</w><w>in</w><w>our</w><w>'storedMatches</w><w>'</w><w>variable</w><pc>.</pc><w>If</w><w>we</w><w>do</w><w>,</w><w>we</w><w>skip</w><w>ahead</w><w>to</w><w>the</w><w>next</w><w>word</w><pc>.</pc><w>If</w><w>it</w><w>is</w><w>not</w><w>already</w><w>recorded</w><w>,</w><w>we</w><w>append</w><w>it</w><w>to</w><w>the</w><w>'storedMatches</w><w>'</w><w>list</w><pc>.</pc><w>This</w><w>is</w><w>keeping</w><w>track</w><w>of</w><w>the</w><w>matching</w><w>words</w><w>for</w><w>us</w><w>for</w><w>each</w><w>text</w><pc>.</pc><w>When</w><w>we</w><w>find</w><w>a</w><w>match</w><w>,</w><w>we</w><w>also</w><w>increase</w><w>our</w><w>'matches</w><w>'</w><w>flag</w><w>by</w><w>1</w><pc>.</pc><w>This</w><w>lets</w><w>us</w><w>know</w><w>how</w><w>many</w><w>matches</w><w>we</w><w>have</w><w>found</w><w>for</w><w>that</w><w>entry</w><pc>.</pc></p><p><w>This</w><w>code</w><w>will</w><w>automatically</w><w>check</w><w>each</w><w>word</w><w>in</w><w>a</w><w>text</w><w>,</w><w>keeping</w><w>track</w><w>of</w><w>matches</w><w>in</w><w>the</w><w>'storedMatches</w><w>'</w><w>list</w><pc>.</pc><w>When</w><w>it</w><w>gets</w><w>to</w><w>the</w><w>end</w><w>of</w><w>a</w><w>text</w><w>,</w><w>it</w><w>will</w><w>empty</w><w>out</w><w>the</w><w>'storedMatches</w><w>'</w><w>variable</w><w>and</w><w>start</w><w>again</w><pc>.</pc><w>Printing</w><w>out</w><w>the</w><w>'matches</w><w>'</w><w>variable</w><w>just</w><w>lets</w><w>us</w><w>see</w><w>how</w><w>many</w><w>matches</w><w>we</w><w>got</w><w>for</w><w>each</w><w>text</w><pc>.</pc><w>When</w><w>you</w><w>run</w><w>this</w><w>code</w><w>you</w><w>should</w><w>see</w><w>somewhere</w><w>between</w><w>0</w><w>and</w><w>2</w><w>for</w><w>most</w><w>entries</w><pc>.</pc><w>If</w><w>it</w><w>says</w><w>0</w><w>for</w><w>everything</w><w>then</w><w>check</w><w>your</w><w>code</w><w>again</w><pc>.</pc><w>If</w><w>you</w><w>only</w><w>have</w><w>one</w><w>entry</w><w>outputting</w><w>then</w><w>go</w><w>back</w><w>to</w><w>step</w><w>one</w><w>and</w><w>make</w><w>sure</w><w>your</w><w>program</w><w>is</w><w>identifying</w><w>the</w><w>right</w><w>number</w><w>of</w><w>keywords</w><w>(</w><w>39</w><w>)</w><pc>.</pc></p><figure><desc><w>Correct</w><w>output</w><w>of</w><w>the</w><w>code</w><w>to</w><w>this</w><w>point</w></desc><graphic url="extracting-keywords-3.png"/></figure><p><w>If</w><w>it</w><w>looks</w><w>like</w><w>it</w><w>worked</w><w>,</w><w>delete</w><w>the</w><w>'print</w><w>matches</w><w>'</w><w>line</w><w>and</w><w>move</w><w>to</w><w>the</w><w>next</w><w>step</w><pc>.</pc></p></div><div type="3" n="6.5"><head><w>Step</w><w>5</w><w>:</w><w>Output</w><w>results</w></head><p><w>If</w><w>you</w><w>have</w><w>got</w><w>to</w><w>this</w><w>stage</w><w>,</w><w>then</w><w>your</w><w>Python</w><w>program</w><w>is</w><w>already</w><w>finding</w><w>the</w><w>matching</w><w>keywords</w><w>from</w><w>your</w><w>gazetteer</w><pc>.</pc><w>All</w><w>we</w><w>need</w><w>to</w><w>do</w><w>now</w><w>is</w><w>print</w><w>them</w><w>out</w><w>to</w><w>the</w><w>command</w><w>output</w><w>pane</w><w>in</w><w>a</w><w>format</w><w>that</w><w>'s</w><w>easy</w><w>to</w><w>work</w><w>with</w><pc>.</pc></p><p><w>Add</w><w>the</w><w>following</w><w>lines</w><w>to</w><w>your</w><w>program</w><w>,</w><w>minding</w><w>the</w><w>indentation</w><w>as</w><w>always</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_8" corresp="code_extracting-keywords_8.txt" rend="block"/></ab><p><w>This</w><w>code</w><w>checks</w><w>if</w><w>the</w><w>number</w><w>of</w><w>matches</w><w>is</w><w>equal</w><w>to</w><w>0</w><pc>.</pc><w>If</w><w>so</w><w>,</w><w>then</w><w>we</w><w>hav</w><w>n't</w><w>found</w><w>any</w><w>keywords</w><w>and</w><w>we</w><w>do</w><w>n't</w><w>need</w><w>to</w><w>print</w><w>them</w><w>out</w><pc>.</pc><w>However</w><w>,</w><w>we</w><w>are</w><w>going</w><w>to</w><w>print</w><w>a</w><w>blank</w><w>space</w><w>,</w><w>because</w><w>we</w><w>want</w><w>our</w><w>output</w><w>to</w><w>contain</w><w>the</w><w>same</w><w>number</w><w>of</w><w>lines</w><w>as</w><w>did</w><w>our</w><w>input</w><w>(</w><w>we</w><w>want</w><w>1</w><w>line</w><w>of</w><w>output</w><w>per</w><w>line</w><w>of</w><w>text</w><w>that</w><w>we</w><w>searched</w><w>)</w><pc>.</pc><w>This</w><w>will</w><w>make</w><w>it</w><w>easier</w><w>to</w><w>paste</w><w>the</w><w>output</w><w>directly</w><w>into</w><w>our</w><w>CSV</w><w>file</w><w>and</w><w>have</w><w>all</w><w>of</w><w>the</w><w>entries</w><w>line</w><w>up</w><w>properly</w><w>with</w><w>their</w><w>corresponding</w><w>text</w><pc>.</pc></p><p><w>If</w><w>there</w><w>IS</w><w>a</w><w>match</w><w>,</w><w>then</w><w>the</w><w>program</w><w>creates</w><w>a</w><w>new</w><w>variable</w><w>called</w><w>'matchString</w><w>'</w><w>(</w><w>it</w><w>could</w><w>have</w><w>been</w><w>called</w><w>just</w><w>about</w><w>anything</w><pc>.</pc><w>That</w><w>'s</w><w>just</w><w>the</w><w>name</w><w>I</w><w>chose</w><w>because</w><w>it</w><w>'s</w><w>a</w><w>string</w><w>of</w><w>matches</w><w>)</w><pc>.</pc><w>Then</w><w>for</w><w>each</w><w>of</w><w>the</w><w>matching</w><w>keywords</w><w>that</w><w>were</w><w>kept</w><w>in</w><w>'storedMatches</w><w>'</w><w>,</w><w>it</w><w>appends</w><w>the</w><w>keyword</w><w>to</w><w>'matchString</w><w>'</w><w>,</w><w>along</w><w>with</w><w>a</w><w>tab</w><w>(</w><w>``</w><w>\t</w><w>''</w><w>)</w><w>character</w><pc>.</pc><w>The</w><w>tab</w><w>character</w><w>is</w><w>useful</w><w>for</w><w>CSV</w><w>files</w><w>because</w><w>when</w><w>you</w><w>paste</w><w>it</w><w>into</w><w>a</w><w>spreadsheet</w><w>,</w><w>content</w><w>separated</w><w>by</w><w>a</w><w>tab</w><w>will</w><w>automatically</w><w>go</w><w>into</w><w>an</w><w>adjacent</w><w>cell</w><pc>.</pc><w>This</w><w>means</w><w>that</w><w>if</w><w>a</w><w>single</w><w>text</w><w>has</w><w>more</w><w>than</w><w>one</w><w>match</w><w>,</w><w>we</w><w>'ll</w><w>be</w><w>able</w><w>to</w><w>automatically</w><w>paste</w><w>one</w><w>match</w><w>per</w><w>cell</w><pc>.</pc><w>This</w><w>makes</w><w>it</w><w>easier</w><w>to</w><w>keep</w><w>the</w><w>keywords</w><w>separate</w><w>once</w><w>we</w><w>have</w><w>them</w><w>back</w><w>in</w><w>our</w><w>CSV</w><w>file</w><pc>.</pc></p><p><w>When</w><w>all</w><w>of</w><w>the</w><w>matching</w><w>keywords</w><w>have</w><w>been</w><w>added</w><w>to</w><w>'matchString</w><w>'</w><w>,</w><w>the</w><w>program</w><w>prints</w><w>it</w><w>out</w><w>to</w><w>the</w><w>command</w><w>output</w><w>before</w><w>moving</w><w>on</w><w>to</w><w>the</w><w>next</w><w>text</w><pc>.</pc></p><p><w>If</w><w>you</w><w>save</w><w>your</w><w>work</w><w>and</w><w>run</w><w>the</w><w>program</w><w>,</w><w>you</w><w>should</w><w>now</w><w>have</w><w>code</w><w>that</w><w>achieves</w><w>all</w><w>of</w><w>the</w><w>steps</w><w>from</w><w>the</w><w>algorithm</w><w>and</w><w>outputs</w><w>the</w><w>results</w><w>to</w><w>your</w><w>command</w><w>output</w><pc>.</pc></p><p><w>The</w><w>finished</w><w>code</w><w>should</w><w>look</w><w>like</w><w>this</w><w>:</w></p></div></div><div type="2" n="7"><head><w>Finished</w><w>Code</w></head><ab><code lang="language-python" xml:id="code_extracting-keywords_9" corresp="code_extracting-keywords_9.txt" rend="block"/></ab><p><w>If</w><w>you</w><w>do</w><w>not</w><w>like</w><w>the</w><w>output</w><w>format</w><w>,</w><w>you</w><w>can</w><w>change</w><w>it</w><w>by</w><w>adjusting</w><w>the</w><w>second</w><w>last</w><w>line</w><w>of</w><w>code</w><pc>.</pc><w>For</w><w>example</w><w>,</w><w>you</w><w>could</w><w>save</w><w>each</w><w>entry</w><w>to</w><w>a</w><w>new</w><w>line</w><w>in</w><w>a</w><w>.txt</w><w>file</w><w>rather</w><w>than</w><w>to</w><w>the</w><w>screen</w><pc>.</pc><w>To</w><w>do</w><w>that</w><w>you</w><w>would</w><w>replace</w><w>'print</w><w>matchString</w><w>'</w><w>with</w><w>the</w><w>following</w><w>code</w><w>(</w><w>make</w><w>sure</w><w>it</w><w>is</w><w>at</w><w>one</w><w>level</w><w>of</w><w>indentation</w><w>,</w><w>just</w><w>as</w><w>was</w><w>the</w><w>replaced</w><w>line</w><w>)</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_10" corresp="code_extracting-keywords_10.txt" rend="block"/></ab><p><w>Note</w><w>the</w><w>'</w><w>a</w><w>'</w><w>instead</w><w>of</w><w>the</w><w>'</w><w>r</w><w>'</w><w>we</w><w>used</w><w>earlier</w><pc>.</pc><w>This</w><w>'appends</w><w>'</w><w>the</w><w>text</w><w>to</w><w>the</w><w>file</w><w>called</w><code rend="inline"><w>output.txt</w></code><w>,</w><w>which</w><w>will</w><w>be</w><w>saved</w><w>in</w><w>your</w><w>working</w><w>directory</w><pc>.</pc><w>You</w><w>will</w><w>have</w><w>to</w><w>take</w><w>care</w><w>,</w><w>because</w><w>running</w><w>the</w><w>program</w><w>several</w><w>times</w><w>will</w><w>continue</w><w>to</w><w>append</w><w>all</w><w>of</w><w>the</w><w>outputs</w><w>to</w><w>this</w><w>file</w><w>,</w><w>creating</w><w>a</w><w>very</w><w>long</w><w>file</w><pc>.</pc><w>There</w><w>are</w><w>ways</w><w>around</w><w>this</w><w>,</w><w>which</w><w>we</w><w>will</w><w>cover</w><w>in</w><w>a</w><w>moment</w><w>,</w><w>and</w><w>you</w><w>might</w><w>consider</w><w>looking</w><w>into</w><w>how</w><w>the</w><w>'</w><w>w</w><w>'</w><w>(</w><w>write</w><w>)</w><w>feature</w><w>works</w><w>,</w><w>and</w><w>experimenting</w><w>with</w><w>output</w><w>formats</w><pc>.</pc><w>There</w><w>is</w><w>more</w><w>information</w><w>related</w><w>to</w><w>these</w><w>features</w><w>in</w><ref target="/lessons/working-with-text-files"><w>'Working</w><w>with</w><w>Text</w><w>Files</w><w>in</w><w>Python</w><w>'</w></ref><pc>.</pc></p></div><div type="2" n="8"><head><w>Refining</w><w>the</w><w>Gazetteer</w></head><p><w>You</w><w>can</w><w>copy</w><w>and</w><w>paste</w><w>that</w><w>output</w><w>directly</w><w>into</w><w>your</w><w>spreadsheet</w><w>next</w><w>to</w><w>the</w><w>first</w><w>entry</w><pc>.</pc><w>Check</w><w>that</w><w>the</w><w>matches</w><w>lined</w><w>up</w><w>properly</w><pc>.</pc><w>Your</w><w>last</w><w>entry</w><w>of</w><w>your</w><w>spreadsheet</w><w>should</w><w>correspond</w><w>to</w><w>the</w><w>correctly</w><w>extracted</w><w>keywords</w><pc>.</pc><w>In</w><w>this</w><w>case</w><w>,</w><w>the</w><w>last</w><w>entry</w><w>should</w><w>be</w><w>blank</w><w>,</w><w>but</w><w>the</w><w>second</w><w>last</w><w>one</w><w>should</w><w>read</w><w>'dorset</w><w>'</w><pc>.</pc></p><figure><desc><w>The</w><w>output</w><w>pasted</w><w>back</w><w>into</w><w>the</w><w>CSV</w><w>file</w></desc><graphic url="extracting-keywords-4.png"/></figure><p><w>At</w><w>this</w><w>point</w><w>,</w><w>you</w><w>might</w><w>like</w><w>to</w><w>refine</w><w>the</w><w>gazetteer</w><w>,</w><w>as</w><w>a</w><w>lot</w><w>of</w><w>place</w><w>names</w><w>have</w><w>been</w><w>missed</w><pc>.</pc><w>Many</w><w>of</w><w>them</w><w>are</w><w>shortforms</w><w>,</w><w>or</w><w>archaic</w><w>spellings</w><w>(</w><w>Wilts</w><w>,</w><w>Salop</w><w>,</w><w>Sarum</w><w>,</w><w>Northants</w><w>,</w><w>etc</w><w>)</w><pc>.</pc><w>You</w><w>could</w><w>go</w><w>through</w><w>looking</w><w>at</w><w>all</w><w>the</w><w>empty</w><w>cells</w><w>and</w><w>seeing</w><w>if</w><w>you</w><w>can</w><w>find</w><w>keywords</w><w>that</w><w>you</w><w>'ve</w><w>missed</w><pc>.</pc><w>It</w><w>may</w><w>help</w><w>to</w><w>know</w><w>that</w><w>you</w><w>can</w><w>find</w><w>the</w><w>next</w><w>empty</w><w>cell</w><w>in</w><w>a</w><w>column</w><w>in</w><w>Excel</w><w>by</w><w>pressing</w><w>CTRL</w><w>+</w><w>down</w><w>arrow</w><w>(</w><w>CMD</w><w>+</w><w>down</w><w>arrow</w><w>on</w><w>Mac</w><w>)</w><pc>.</pc></p><p><w>One</w><w>of</w><w>the</w><w>easiest</w><w>ways</w><w>to</w><w>find</w><w>all</w><w>of</w><w>the</w><w>missing</w><w>entries</w><w>is</w><w>to</w><w>sort</w><w>your</w><w>spreadsheet</w><w>by</w><w>the</w><w>new</w><w>columns</w><w>you</w><w>'ve</w><w>just</w><w>added</w><pc>.</pc><w>If</w><w>you</w><w>sort</w><w>the</w><w>matches</w><w>alphabetically</w><w>for</w><w>each</w><w>of</w><w>the</w><w>new</w><w>columns</w><w>,</w><w>then</w><w>the</w><w>entries</w><w>at</w><w>the</w><w>bottom</w><w>of</w><w>the</w><w>spreadsheet</w><w>will</w><w>all</w><w>be</w><w>unclassified</w><pc>.</pc><w>You</w><w>can</w><w>do</w><w>this</w><w>by</w><w>selecting</w><w>the</w><w>whole</w><w>spreadsheet</w><w>and</w><w>clicking</w><w>on</w><w>the</w><w>Data</w><w>-</w><w>&gt;</w><w>Sort</w><w>menu</w><w>item</w><pc>.</pc><w>You</w><w>can</w><w>then</w><w>sort</w><w>a-z</w><w>for</w><w>each</w><w>of</w><w>the</w><w>new</w><w>columns</w><pc>.</pc></p><p><w>Before</w><w>you</w><w>sort</w><w>a</w><w>spreadsheet</w><w>,</w><w>it</w><w>'s</w><w>often</w><w>a</w><w>good</w><w>idea</w><w>to</w><w>add</w><w>an</w><w>'original</w><w>order</w><w>'</w><w>column</w><w>in</w><w>case</w><w>you</w><w>want</w><w>to</w><w>sort</w><w>them</w><w>back</w><pc>.</pc><w>To</w><w>do</w><w>this</w><w>,</w><w>add</w><w>a</w><w>new</w><w>column</w><w>,</w><w>and</w><w>in</w><w>the</w><w>first</w><w>3</w><w>rows</w><w>,</w><w>type</w><w>1</w><w>,</w><w>2</w><w>,</w><w>and</w><w>3</w><w>respectively</w><pc>.</pc><w>Then</w><w>highlight</w><w>the</w><w>three</w><w>cells</w><w>and</w><w>put</w><w>your</w><w>cursor</w><w>over</w><w>the</w><w>bottom</w><w>right</w><w>corner</w><pc>.</pc><w>If</w><w>you</w><w>are</w><w>using</w><w>Microsoft</w><w>Excel</w><w>your</w><w>cursor</w><w>will</w><w>change</w><w>into</w><w>a</w><w>black</w><w>cross</w><pc>.</pc><w>When</w><w>you</w><w>see</w><w>this</w><w>,</w><w>click</w><w>and</w><w>hold</w><w>the</w><w>mouse</w><w>button</w><w>and</w><w>drag</w><w>the</w><w>cursor</w><w>down</w><w>until</w><w>you</w><w>reach</w><w>the</w><w>bottom</w><w>of</w><w>the</w><w>spreadsheet</w><w>(</w><w>down</w><w>to</w><w>the</w><w>last</w><w>entry</w><w>)</w><w>before</w><w>you</w><w>let</w><w>go</w><pc>.</pc><w>This</w><w>should</w><w>automatically</w><w>number</w><w>the</w><w>rows</w><w>consecutively</w><w>so</w><w>that</w><w>you</w><w>can</w><w>always</w><w>re-sort</w><w>your</w><w>entries</w><w>back</w><w>to</w><w>the</w><w>original</w><w>order</w><pc>.</pc></p><figure><desc><w>Adding</w><w>an</w><w>original</w><w>order</w><w>column</w><w>and</w><w>sorting</w><w>the</w><w>entries</w></desc><graphic url="extracting-keywords-5.png"/></figure><p><w>Now</w><w>you</w><w>can</w><w>sort</w><w>the</w><w>data</w><w>and</w><w>read</w><w>some</w><w>of</w><w>the</w><w>entries</w><w>for</w><w>which</w><w>no</w><w>match</w><w>was</w><w>found</w><pc>.</pc><w>If</w><w>you</w><w>find</w><w>there</w><w>is</w><w>a</w><w>place</w><w>name</w><w>in</w><w>there</w><w>,</w><w>add</w><w>it</w><w>to</w><w>your</w><w>'gazetteer.txt</w><w>'</w><w>file</w><w>,</w><w>one</w><w>entry</w><w>per</w><w>line</w><pc>.</pc><w>You</w><w>do</w><w>n't</w><w>have</w><w>to</w><w>be</w><w>exhaustive</w><w>at</w><w>this</w><w>stage</w><pc>.</pc><w>You</w><w>could</w><w>add</w><w>a</w><w>handful</w><w>more</w><w>entries</w><w>and</w><w>then</w><w>try</w><w>the</w><w>code</w><w>again</w><w>to</w><w>see</w><w>what</w><w>impact</w><w>they</w><w>had</w><w>on</w><w>the</w><w>result</w><pc>.</pc></p><figure><desc><w>Missed</w><w>place</w><w>name</w><w>words</w><w>highlighted</w><w>in</w><w>yellow</w></desc><graphic url="extracting-keywords-6.png"/></figure><p><w>Before</w><w>you</w><w>re-run</w><w>your</w><w>Python</w><w>code</w><w>,</w><w>you</w><w>'ll</w><w>have</w><w>to</w><w>update</w><w>your</w><code rend="inline"><w>texts.txt</w></code><w>file</w><w>so</w><w>that</w><w>the</w><w>program</w><w>runs</w><w>on</w><w>the</w><w>texts</w><w>in</w><w>the</w><w>correct</w><w>order</w><pc>.</pc><w>Since</w><w>the</w><w>code</w><w>will</w><w>output</w><w>the</w><w>matches</w><w>in</w><w>the</w><w>same</w><w>order</w><w>that</w><w>it</w><w>receives</w><w>the</w><w>files</w><w>in</w><code rend="inline"><w>texts.txt</w></code><w>,</w><w>it</w><w>'s</w><w>important</w><w>not</w><w>to</w><w>get</w><w>this</w><w>jumbled</w><w>up</w><w>if</w><w>you</w><w>'ve</w><w>been</w><w>sorting</w><w>your</w><w>spreadsheet</w><w>where</w><w>you</w><w>intend</w><w>to</w><w>store</w><w>your</w><w>outputs</w><pc>.</pc><w>You</w><w>can</w><w>either</w><w>re-sort</w><w>the</w><w>spreadsheet</w><w>back</w><w>to</w><w>the</w><w>original</w><w>order</w><w>before</w><w>you</w><w>run</w><w>the</w><w>program</w><w>,</w><w>or</w><w>you</w><w>can</w><w>copy</w><w>all</w><w>of</w><w>the</w><w>cells</w><w>in</w><w>the</w><w>'details</w><w>'</w><w>column</w><w>again</w><w>and</w><w>paste</w><w>and</w><w>save</w><w>them</w><w>into</w><w>the</w><code rend="inline"><w>texts.txt</w></code><w>file</w><pc>.</pc></p><p><w>I</w><w>'d</w><w>challenge</w><w>you</w><w>to</w><w>make</w><w>a</w><w>few</w><w>refinements</w><w>to</w><w>your</w><w>gazetteer</w><w>before</w><w>moving</w><w>ahead</w><w>,</w><w>just</w><w>to</w><w>make</w><w>sure</w><w>you</w><w>have</w><w>the</w><w>hang</w><w>of</w><w>it</w><pc>.</pc></p><p><w>Once</w><w>you</w><w>are</w><w>happy</w><w>with</w><w>that</w><w>,</w><w>you</w><w>can</w><w>snag</w><w>my</w><ref target="/assets/extracting-keywords-final-gazetteer.txt"><w>completed</w><w>list</w><w>of</w><w>English</w><w>and</w><w>Welsh</w><w>counties</w><w>,</w><w>shortforms</w><w>,</w><w>and</w><w>various</w><w>other</w><w>cities</w><w>(</w><w>London</w><w>,</w><w>Bristol</w><w>etc</w><w>)</w><w>and</w><w>places</w><w>(</w><w>Jersey</w><w>,</w><w>Ireland</w><w>,</w><w>etc</w><w>)</w></ref><pc>.</pc><w>My</w><w>completed</w><w>list</w><w>contains</w><w>157</w><w>entries</w><w>,</w><w>and</w><w>should</w><w>get</w><w>you</w><w>all</w><w>of</w><w>the</w><w>entries</w><w>that</w><w>can</w><w>be</w><w>extracted</w><w>from</w><w>the</w><w>texts</w><w>in</w><w>this</w><w>collection</w><pc>.</pc></p><p><w>At</w><w>this</w><w>point</w><w>you</w><w>could</w><w>stop</w><w>,</w><w>as</w><w>you</w><w>'ve</w><w>achieved</w><w>what</w><w>you</w><w>set</w><w>out</w><w>to</w><w>do</w><pc>.</pc><w>This</w><w>lesson</w><w>taught</w><w>you</w><w>how</w><w>to</w><w>use</w><w>a</w><w>short</w><w>Python</w><w>program</w><w>to</w><w>search</w><w>a</w><w>fairly</w><w>large</w><w>number</w><w>of</w><w>texts</w><w>for</w><w>a</w><w>set</w><w>of</w><w>keywords</w><w>defined</w><w>by</w><w>you</w><pc>.</pc></p><p><w>With</w><w>the</w><w>outputs</w><w>from</w><w>this</w><w>lesson</w><w>,</w><w>you</w><w>could</w><w>fairly</w><w>quickly</w><w>map</w><w>these</w><w>entries</w><w>by</w><w>geolocating</w><w>the</w><w>place</w><w>names</w><pc>.</pc><w>This</w><w>might</w><w>reveal</w><w>new</w><w>insights</w><w>into</w><w>spatial</w><w>patterns</w><w>of</w><w>Oxford</w><w>alumni</w><pc>.</pc></p><p><w>Having</w><w>the</w><w>ability</w><w>to</w><w>search</w><w>for</w><w>large</w><w>numbers</w><w>of</w><w>keywords</w><w>at</w><w>the</w><w>same</w><w>time</w><w>opens</w><w>up</w><w>flexibility</w><w>for</w><w>your</w><w>research</w><w>process</w><w>,</w><w>and</w><w>makes</w><w>it</w><w>feasible</w><w>to</w><w>do</w><w>work</w><w>that</w><w>might</w><w>otherwise</w><w>just</w><w>have</w><w>seemed</w><w>like</w><w>it</w><w>would</w><w>take</w><w>too</w><w>long</w><pc>.</pc><w>You</w><w>could</w><w>try</w><w>a</w><w>completely</w><w>different</w><w>set</w><w>of</w><w>words</w><w>,</w><w>or</w><w>use</w><w>this</w><w>technique</w><w>on</w><w>another</w><w>set</w><w>of</w><w>texts</w><w>entirely</w><pc>.</pc><w>The</w><w>research</w><w>questions</w><w>are</w><w>of</w><w>course</w><w>,</w><w>endless</w><pc>.</pc></p><p><w>If</w><w>you</w><w>would</w><w>like</w><w>to</w><w>refine</w><w>the</w><w>program</w><w>further</w><w>,</w><w>we</w><w>can</w><w>use</w><w>Python</w><w>to</w><w>read</w><w>directly</w><w>from</w><w>the</w><w>CSV</w><w>file</w><w>and</w><w>to</w><w>print</w><w>the</w><w>results</w><w>to</w><w>a</w><w>new</w><w>CSV</w><w>file</w><w>so</w><w>that</w><w>everything</w><w>happens</w><w>automatically</w><w>from</w><w>the</w><w>Terminal</w><w>window</w><w>without</w><w>the</w><w>need</w><w>for</w><w>cutting</w><w>and</w><w>pasting</w><pc>.</pc></p></div><div type="2" n="9"><head><w>Printing</w><w>the</w><w>Results</w><w>Back</w><w>to</w><w>the</w><w>CSV</w><w>File</w><w>Using</w><w>Python</w></head><p><w>Python</w><w>has</w><w>a</w><w>built</w><w>in</w><w>code</w><w>library</w><w>that</w><w>can</w><w>handle</w><w>working</w><w>with</w><w>CSV</w><w>files</w><w>,</w><w>called</w><code rend="inline"><w>csv</w></code></p><p><w>To</w><w>use</w><w>it</w><w>and</w><w>its</w><w>features</w><w>,</w><w>you</w><w>first</w><w>have</w><w>to</w><w>import</w><w>it</w><pc>.</pc><w>At</w><w>the</w><w>top</w><w>of</w><w>your</w><code rend="inline"><w>extractKeywords.py</w></code><w>program</w><w>,</w><w>add</w><w>the</w><w>following</w><w>line</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_11" corresp="code_extracting-keywords_11.txt" rend="block"/></ab><p><w>Now</w><w>we</w><w>are</w><w>going</w><w>to</w><w>make</w><w>some</w><w>changes</w><w>to</w><w>our</w><w>original</w><w>program</w><pc>.</pc><w>Instead</w><w>of</w><w>cutting</w><w>all</w><w>of</w><w>the</w><w>texts</w><w>into</w><w>a</w><code rend="inline"><w>texts.txt</w></code><w>file</w><w>,</w><w>we</w><w>'ll</w><w>use</w><w>Python</w><w>to</w><w>read</w><w>the</w><w>data</w><w>directly</w><w>into</w><w>our</w><w>'allTexts</w><w>'</w><w>variable</w><pc>.</pc><w>Replace</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_12" corresp="code_extracting-keywords_12.txt" rend="block"/></ab><p><w>With</w><w>this</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_13" corresp="code_extracting-keywords_13.txt" rend="block"/></ab><p><w>As</w><w>this</w><w>is</w><w>an</w><w>advanced</w><w>option</w><w>,</w><w>I</w><w>wo</w><w>n't</w><w>explain</w><w>what</w><w>every</w><w>line</w><w>does</w><w>in</w><w>detail</w><w>,</w><w>but</w><w>you</w><w>can</w><w>take</w><w>a</w><w>look</w><w>at</w><w>the</w><w>comments</w><w>in</w><w>the</w><w>code</w><w>to</w><w>get</w><w>an</w><w>idea</w><pc>.</pc><w>Effectively</w><w>this</w><w>uses</w><w>Python</w><w>to</w><w>read</w><w>the</w><w>CSV</w><w>file</w><w>and</w><w>stores</w><w>all</w><w>of</w><w>the</w><w>information</w><w>in</w><w>the</w><w>'Details</w><w>'</w><w>column</w><w>in</w><w>the</w><w>same</w><w>'allTexts</w><w>'</w><w>variable</w><w>that</w><w>we</w><w>had</w><w>it</w><w>in</w><w>previously</w><w>,</w><w>in</w><w>exactly</w><w>the</w><w>same</w><w>format</w><w>as</w><w>before</w><pc>.</pc><w>This</w><w>code</w><w>also</w><w>stores</w><w>each</w><w>row</w><w>of</w><w>the</w><w>CSV</w><w>file</w><w>into</w><w>another</w><w>list</w><w>called</w><w>'fullRow</w><w>'</w><w>,</w><w>which</w><w>will</w><w>be</w><w>used</w><w>for</w><w>writing</w><w>a</w><w>new</w><w>CSV</w><w>file</w><w>containing</w><w>our</w><w>program</w><w>'s</w><w>outputs</w><pc>.</pc></p><p><w>There</w><w>are</w><w>a</w><w>few</w><w>extra</w><w>lines</w><w>of</w><w>code</w><w>here</w><w>,</w><w>but</w><w>you</w><w>did</w><w>n't</w><w>need</w><w>to</w><w>cut</w><w>and</w><w>paste</w><w>anything</w><w>into</w><w>the</w><code rend="inline"><w>texts.txt</w></code><w>file</w><w>,</w><w>and</w><w>there</w><w>'s</w><w>no</w><w>risk</w><w>here</w><w>of</w><w>your</w><w>sorting</w><w>of</w><w>your</w><w>spreadsheet</w><w>causing</w><w>any</w><w>issues</w><w>about</w><w>the</w><w>order</w><w>of</w><w>inputs</w><w>and</w><w>outputs</w><pc>.</pc><w>This</w><w>is</w><w>therefore</w><w>a</w><w>more</w><w>robust</w><w>option</w><pc>.</pc><w>You</w><w>can</w><w>print</w><w>out</w><w>either</w><w>of</w><w>these</w><w>variables</w><w>using</w><w>the</w><w>'print</w><w>'</w><w>feature</w><w>,</w><w>to</w><w>make</w><w>sure</w><w>they</w><w>contain</w><w>what</w><w>you</w><w>'d</w><w>expect</w><w>of</w><w>them</w><pc>.</pc></p><p><hi rend="bold"><w>TROUBLESHOOTING</w></hi><w>:</w><w>If</w><w>you</w><w>get</w><w>the</w><w>following</w><w>error</w><w>when</w><w>you</w><w>attempt</w><w>to</w><w>read</w><w>your</w><w>CSV</w><w>file</w><w>using</w><w>Python</w><w>,</w><w>the</w><w>CSV</w><w>file</w><w>may</w><w>have</w><w>been</w><w>saved</w><w>on</w><w>a</w><w>Mac</w><w>,</w><w>and</w><w>the</w><w>Python</w><w>CSV</w><w>library</w><w>is</w><w>only</w><w>able</w><w>to</w><w>read</w><w>Windows-compatible</w><w>CSV</w><w>files</w></p><ab><code lang="language-text" xml:id="code_extracting-keywords_14" corresp="code_extracting-keywords_14.txt" rend="block"/></ab><p><w>To</w><w>solve</w><w>this</w><w>problem</w><w>,</w><w>open</w><w>your</w><w>CSV</w><w>file</w><w>in</w><w>a</w><w>spreadsheet</w><w>program</w><w>(</w><w>eg.</w><w>,</w><w>Excel</w><w>)</w><w>and</w><w>'Save</w><w>As</w><w>'</w><w>and</w><w>under</w><w>format</w><w>chose</w><w>'Windows</w><w>Comma</w><w>Separated</w><w>(</w><w>csv</w><w>)</w><w>'</w><pc>.</pc><w>This</w><w>should</w><w>solve</w><w>the</w><w>problem</w><pc>.</pc><w>To</w><w>read</w><w>more</w><w>on</w><w>this</w><w>issue</w><w>,</w><w>see</w><ref target="http://stackoverflow.com/questions/17315635/csv-new-line-character-seen-in-unquoted-field-error"><w>Stack</w><w>Overflow</w></ref></p></div><div type="2" n="10"><head><w>Creating</w><w>a</w><w>new</w><w>CSV</w><w>file</w></head><p><w>Next</w><w>we</w><w>need</w><w>to</w><w>create</w><w>a</w><w>new</w><w>CSV</w><w>file</w><w>where</w><w>the</w><w>results</w><w>of</w><w>the</w><w>analysis</w><w>can</w><w>be</w><w>stored</w><pc>.</pc><w>It</w><w>'s</w><w>always</w><w>a</w><w>good</w><w>idea</w><w>to</w><w>make</w><w>a</w><w>new</w><w>file</w><w>rather</w><w>than</w><w>try</w><w>to</w><w>append</w><w>it</w><w>to</w><w>your</w><w>only</w><w>copy</w><w>of</w><w>the</w><w>original</w><w>data</w><pc>.</pc><w>It</w><w>'s</w><w>also</w><w>a</w><w>good</w><w>idea</w><w>to</w><w>append</w><w>the</w><w>current</w><w>date</w><w>and</w><w>time</w><w>to</w><w>the</w><w>filename</w><w>for</w><w>your</w><w>new</w><w>file</w><pc>.</pc><w>That</w><w>way</w><w>you</w><w>can</w><w>run</w><w>the</w><w>code</w><w>lots</w><w>of</w><w>times</w><w>as</w><w>you</w><w>refine</w><w>everything</w><w>and</w><w>it</w><w>will</w><w>always</w><w>be</w><w>clear</w><w>which</w><w>file</w><w>contains</w><w>your</w><w>most</w><w>recent</w><w>ouputs</w><pc>.</pc></p><p><w>To</w><w>do</w><w>this</w><w>,</w><w>import</w><w>the</w><w>'time</w><w>'</w><w>library</w><w>just</w><w>below</w><w>where</w><w>you</w><w>imported</w><w>the</w><w>'csv</w><w>'</w><w>library</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_extracting-keywords_15" corresp="code_extracting-keywords_15.txt" rend="block"/></ab><p><w>And</w><w>then</w><w>add</w><w>the</w><w>following</w><w>two</w><w>lines</w><w>of</w><w>code</w><w>right</w><w>below</w><w>where</w><w>you</w><w>were</w><w>just</w><w>working</w><w>with</w><w>the</w><w>new</w><w>CSV</w><w>code</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_16" corresp="code_extracting-keywords_16.txt" rend="block"/></ab><p><w>This</w><w>will</w><w>create</w><w>a</w><w>variable</w><w>called</w><w>'filename</w><w>'</w><w>,</w><w>which</w><w>we</w><w>'ll</w><w>use</w><w>when</w><w>we</w><w>make</w><w>the</w><w>new</w><w>output</w><w>file</w><pc>.</pc></p><p><w>The</w><w>rest</w><w>of</w><w>the</w><w>process</w><w>involves</w><w>creating</w><w>that</w><w>new</w><w>output</w><w>file</w><w>,</w><w>putting</w><w>in</w><w>the</w><w>correct</w><w>headers</w><w>,</w><w>pasting</w><w>in</w><w>the</w><w>original</w><w>data</w><w>,</w><w>and</w><w>then</w><w>pasting</w><w>in</w><w>our</w><w>new</w><w>outputs</w><w>from</w><w>our</w><w>gazetteer</w><w>matching</w><pc>.</pc><w>That</w><w>involves</w><w>quite</w><w>a</w><w>few</w><w>tweaks</w><w>to</w><w>the</w><w>original</w><w>code</w><w>,</w><w>so</w><w>to</w><w>keep</w><w>everything</w><w>as</w><w>clear</w><w>as</w><w>possible</w><w>,</w><w>I</w><w>'ve</w><w>included</w><w>the</w><w>finished</w><w>code</w><w>below</w><pc>.</pc><w>I</w><w>have</w><w>appended</w><w>'NEW</w><pc>!</pc><w>'</w><w>,</w><w>'OLD</w><pc>!</pc><w>'</w><w>and</w><w>'CHANGED</w><pc>!</pc><w>'</w><w>in</w><w>the</w><w>comments</w><w>for</w><w>each</w><w>section</w><w>so</w><w>that</w><w>you</w><w>can</w><w>see</w><w>at</w><w>a</w><w>glance</w><w>which</w><w>bits</w><w>have</w><w>changed</w><w>:</w></p><ab><code lang="language-python" xml:id="code_extracting-keywords_17" corresp="code_extracting-keywords_17.txt" rend="block"/></ab><p><w>The</w><w>code</w><w>is</w><w>heavily</w><w>commented</w><w>so</w><w>if</w><w>you</w><w>spend</w><w>some</w><w>time</w><w>,</w><w>you</w><w>should</w><w>be</w><w>able</w><w>to</w><w>figure</w><w>it</w><w>out</w><pc>.</pc><w>Save</w><w>this</w><w>code</w><w>and</w><w>rerun</w><w>it</w><w>using</w><w>Python</w><w>and</w><w>you</w><w>should</w><w>get</w><w>a</w><w>file</w><w>called</w><code rend="inline"><w>output.csv</w></code><w>appearing</w><w>in</w><w>your</w><w>working</w><w>directory</w><w>,</w><w>which</w><w>if</w><w>you</w><w>open</w><w>it</w><w>should</w><w>contain</w><w>all</w><w>of</w><w>the</w><w>same</w><w>information</w><w>as</w><w>you</w><w>had</w><w>before</w><w>,</w><w>but</w><w>without</w><w>the</w><w>need</w><w>to</w><w>do</w><w>any</w><w>cutting</w><w>or</w><w>pasting</w><pc>.</pc></p><p><w>To</w><w>give</w><w>a</w><w>brief</w><w>outline</w><w>of</w><w>what</w><w>has</w><w>been</w><w>changed</w><w>from</w><w>the</w><w>original</w><w>version</w><w>:</w></p><list type="ordered"><item><w>The</w><w>texts</w><w>were</w><w>extracted</w><w>automatically</w><w>from</w><w>the</w><w>original</w><w>datafile</w><w>instead</w><w>of</w><w>having</w><w>to</w><w>paste</w><w>them</w><w>into</w><w>a</w><code rend="inline"><w>texts.txt</w></code><w>file</w><pc>.</pc></item><item><w>Using</w><w>the</w><w>'time</w><w>'</w><w>library</w><w>,</w><w>we</w><w>used</w><w>the</w><w>current</w><w>date</w><w>and</w><w>time</w><w>to</w><w>create</w><w>a</w><w>unique</w><w>and</w><w>easily</w><w>decypherable</w><w>filename</w><w>for</w><w>our</w><w>output</w><w>file</w><pc>.</pc></item><item><w>Using</w><w>the</w><w>'csv</w><w>'</w><w>library</w><w>we</w><w>created</w><w>a</w><w>new</w><w>.csv</w><w>file</w><w>using</w><w>that</w><w>filename</w><w>,</w><w>and</w><w>put</w><w>in</w><w>the</w><w>column</w><w>headers</w><w>we</w><w>wanted</w><w>to</w><w>use</w><pc>.</pc></item><item><w>We</w><w>then</w><w>ran</w><w>the</w><w>same</w><w>matching</w><w>code</w><w>as</w><w>before</w><w>,</w><w>checking</w><w>'allTexts</w><w>'</w><w>against</w><w>'allWords</w><w>'</w><w>and</w><w>storing</w><w>the</w><w>results</w><pc>.</pc></item><item><w>Instead</w><w>of</w><w>printing</w><w>the</w><w>results</w><w>to</w><w>the</w><w>screen</w><w>,</w><w>we</w><w>stored</w><w>each</w><w>row</w><w>'s</w><w>original</w><w>data</w><w>(</w><w>Name</w><w>,</w><w>Details</w><w>,</w><w>Matriculation</w><w>Year</w><w>)</w><w>+</w><w>the</w><w>matches</w><w>to</w><w>a</w><ref target="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences"><w>tuple</w></ref><w>called</w><w>'newRow</w><w>'</w><pc>.</pc></item><item><w>Using</w><w>the</w><w>'csv</w><w>'</w><w>library</w><w>we</w><w>wrote</w><w>the</w><w>'newRow</w><w>'</w><w>data</w><w>to</w><w>the</w><w>new</w><w>CSV</w><w>file</w><w>,</w><w>one</w><w>row</w><w>at</w><w>a</w><w>time</w><pc>.</pc></item></list><p><w>This</w><w>approach</w><w>created</w><w>longer</w><w>and</w><w>more</w><w>complex</w><w>code</w><w>,</w><w>but</w><w>the</w><w>result</w><w>is</w><w>a</w><w>powerful</w><w>program</w><w>that</w><w>reads</w><w>from</w><w>a</w><w>CSV</w><w>file</w><w>,</w><w>matches</w><w>the</w><w>texts</w><w>against</w><w>the</w><w>contents</w><w>of</w><w>a</w><w>gazetteer</w><w>,</w><w>and</w><w>then</w><w>automatically</w><w>writes</w><w>the</w><w>output</w><w>to</w><w>a</w><w>clean</w><w>new</w><w>CSV</w><w>file</w><w>with</w><w>no</w><w>intermediary</w><w>steps</w><w>for</w><w>you</w><w>the</w><w>user</w><pc>.</pc><w>You</w><w>did</w><w>n't</w><w>have</w><w>to</w><w>go</w><w>that</w><w>extra</w><w>mile</w><w>,</w><w>but</w><w>hopefully</w><w>you</w><w>can</w><w>see</w><w>the</w><w>advantages</w><w>if</w><w>you</w><w>made</w><w>it</w><w>all</w><w>the</w><w>way</w><w>through</w><pc>.</pc></p></div><div type="2" n="11"><head><w>Suggested</w><w>Further</w><w>Reading</w></head><p><w>Readers</w><w>who</w><w>have</w><w>completed</w><w>this</w><w>lesson</w><w>might</w><w>be</w><w>interested</w><w>in</w><w>then</w><w>geo-referencing</w><w>the</w><w>output</w><w>using</w><w>the</w><w>Google</w><w>API</w><w>and</w><w>mapping</w><w>the</w><w>results</w><pc>.</pc><w>You</w><w>can</w><w>learn</w><w>more</w><w>about</w><w>this</w><w>process</w><w>from</w><w>Fred</w><w>Gibbs</w><w>'s</w><w>tutorial</w><w>,</w><ref target="http://fredgibbs.net/tutorials/extract-geocode-placenames-from-text-file.html"><w>Extract</w><w>and</w><w>Geocode</w><w>Placenames</w><w>from</w><w>a</w><w>Text</w><w>File</w></ref><pc>.</pc><w>This</w><w>will</w><w>let</w><w>you</w><w>visualise</w><w>the</w><w>practical</w><w>outputs</w><w>of</w><w>this</w><w>tutorial</w><pc>.</pc><w>Alternatively</w><w>,</w><w>readers</w><w>may</w><w>be</w><w>interested</w><w>in</w><ref target="/lessons/georeferencing-qgis"><w>Jim</w><w>Clifford</w><w>et</w><pc>.</pc><w>al</w><w>'s</w><w>tutorial</w><w>on</w><w>georeferencing</w><w>in</w><w>QGIS</w><w>2.0</w></ref><w>,</w><w>an</w><w>open</w><w>source</w><ref target="https://en.wikipedia.org/wiki/Geographic_information_system"><w>GIS</w></ref><w>program</w><pc>.</pc></p></div></body>
    </text>
</TEI>
