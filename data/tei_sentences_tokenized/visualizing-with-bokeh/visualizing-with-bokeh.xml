<TEI xmlns="http://www.tei-c.org/ns/1.0" xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="visualizing-with-bokeh" type="original" xml:base="visualizing-with-bokeh/visualizing-with-bokeh/visualizing-with-bokeh.xml">
    <teiHeader>
        <fileDesc>
            <titleStmt>
                <title>Visualizing Data with Bokeh and Pandas</title>
                <author role="original_author">Charlie Harper</author>
                <editor role="reviewers">
                    <persName>Zoe LeBlanc</persName>
                    <persName>Ben Schmidt</persName>
                </editor>
                <editor role="editors">
                    <persName>James Baker</persName>
                    <persName>Ian Milligan</persName>
                </editor>
            </titleStmt>
            <publicationStmt>
                <distributor>Programming Historian</distributor>
                <idno type="doi">10.46430/phen0081</idno>
                <date type="published">07/27/2018</date>
            </publicationStmt>
            <sourceDesc>
                <p>Born digital, in a markdown format. This lesson is original.</p>
            </sourceDesc>
        </fileDesc>
        <profileDesc>
            <abstract>
                <p>In this lesson you will learn how to visually explore and present data in Python by using the Bokeh and Pandas libraries.</p>
            </abstract>
            <textClass>
                <keywords>
                    <term xml:lang="en">python</term>
                    <term xml:lang="en">data-manipulation</term>
                    <term xml:lang="en">mapping</term>
                    <term xml:lang="en">data-visualization</term>
                </keywords>
            </textClass>
        </profileDesc>
    </teiHeader>
    <text xml:lang="en">
        <body><div type="2" n="1"><head><w>Contents</w></head></div><div type="2" n="2"><head><w>Overview</w></head><p><w>The</w><w>ability</w><w>to</w><w>load</w><w>raw</w><w>data</w><w>,</w><w>sample</w><w>it</w><w>,</w><w>and</w><w>then</w><w>visually</w><w>explore</w><w>and</w><w>present</w><w>it</w><w>is</w><w>a</w><w>valuable</w><w>skill</w><w>across</w><w>disciplines</w><pc>.</pc><w>In</w><w>this</w><w>tutorial</w><w>,</w><w>you</w><w>will</w><w>learn</w><w>how</w><w>to</w><w>do</w><w>this</w><w>in</w><w>Python</w><w>by</w><w>using</w><w>the</w><w>Bokeh</w><w>and</w><w>Pandas</w><w>libraries</w><pc>.</pc><w>Specifically</w><w>,</w><w>we</w><w>will</w><w>work</w><w>through</w><w>visualizing</w><w>and</w><w>exploring</w><w>aspects</w><w>of</w><w>WWII</w><w>bombing</w><w>runs</w><w>conducted</w><w>by</w><w>Allied</w><w>powers</w><pc>.</pc></p><p><w>At</w><w>the</w><w>end</w><w>of</w><w>the</w><w>lesson</w><w>you</w><w>will</w><w>be</w><w>able</w><w>to</w><w>:</w></p><list type="unordered"><item><w>Load</w><w>tabular</w><w>CSV</w><w>data</w></item><item><w>Perform</w><w>basic</w><w>data</w><w>manipulation</w><w>,</w><w>such</w><w>as</w><w>aggregating</w><w>and</w><w>sub-sampling</w><w>raw</w><w>data</w></item><item><w>Visualize</w><w>quantitative</w><w>,</w><w>categorical</w><w>,</w><w>and</w><w>geographic</w><w>data</w><w>for</w><w>web</w><w>display</w></item><item><w>Add</w><w>varying</w><w>types</w><w>of</w><w>interactivity</w><w>to</w><w>your</w><w>visualizations</w></item></list><p><w>To</w><w>reach</w><w>these</w><w>goals</w><w>,</w><w>we</w><w>'ll</w><w>work</w><w>through</w><w>a</w><w>variety</w><w>of</w><w>visualization</w><w>examples</w><w>using</w><w>THOR</w><w>,</w><w>a</w><w>dataset</w><w>that</w><w>describes</w><w>historical</w><w>bombing</w><w>operations</w><pc>.</pc></p><div type="3" n="2.1"><head><w>The</w><w>WWII</w><w>THOR</w><w>Dataset</w></head><p><w>The</w><w>Theater</w><w>History</w><w>of</w><w>Operations</w><w>Reports</w><w>(</w><w>THOR</w><w>)</w><w>lists</w><w>aerial</w><w>bombing</w><w>operations</w><w>during</w><w>World</w><w>War</w><w>I</w><w>,</w><w>World</w><w>War</w><w>II</w><w>,</w><w>the</w><w>Korean</w><w>War</w><w>,</w><w>and</w><w>the</w><w>Vietnam</w><w>War</w><w>undertaken</w><w>by</w><w>the</w><w>United</w><w>States</w><w>and</w><w>Allied</w><w>Powers</w><pc>.</pc><w>The</w><w>records</w><w>were</w><w>compiled</w><w>from</w><w>declassified</w><w>documents</w><w>by</w><w>Lt.</w><w>Col.</w><w>Jenns</w><w>Robertson</w><pc>.</pc><w>THOR</w><w>is</w><w>made</w><w>publicly</w><w>available</w><w>through</w><w>a</w><w>partnership</w><w>between</w><w>the</w><w>US</w><w>Department</w><w>of</w><w>Defense</w><w>and</w><ref target="https://data.world/datamil"><w>data.world</w></ref><pc>.</pc></p><p><w>Each</w><w>row</w><w>in</w><w>the</w><w>THOR</w><w>dataset</w><w>contains</w><w>information</w><w>on</w><w>a</w><w>single</w><w>mission</w><w>or</w><w>bombing</w><w>run</w><pc>.</pc><w>This</w><w>information</w><w>can</w><w>include</w><w>the</w><w>mission</w><w>date</w><w>,</w><w>takeoff</w><w>and</w><w>target</w><w>locations</w><w>,</w><w>the</w><w>target</w><w>type</w><w>,</w><w>aircraft</w><w>involved</w><w>,</w><w>and</w><w>the</w><w>types</w><w>and</w><w>weights</w><w>of</w><w>bombs</w><w>dropped</w><w>on</w><w>the</w><w>target</w><pc>.</pc><w>The</w><ref target="https://data.world/datamil/thor-data-dictionary"><w>THOR</w><w>data</w><w>dictionary</w></ref><w>provides</w><w>detailed</w><w>information</w><w>on</w><w>the</w><w>structure</w><w>of</w><w>the</w><w>dataset</w><pc>.</pc></p><p><w>For</w><w>this</w><w>tutorial</w><w>,</w><w>we</w><w>'ll</w><w>use</w><w>a</w><w>modified</w><w>version</w><w>of</w><w>the</w><w>WWII</w><w>THOR</w><w>dataset</w><pc>.</pc><w>The</w><w>original</w><w>,</w><w>full-version</w><w>of</w><w>the</w><w>dataset</w><w>consists</w><w>of</w><w>62</w><w>columns</w><w>of</w><w>information</w><w>digitized</w><w>from</w><w>the</w><w>paper</w><w>forms</w><pc>.</pc><w>To</w><w>make</w><w>this</w><w>dataset</w><w>more</w><w>manageable</w><w>for</w><w>our</w><w>purposes</w><w>,</w><w>this</w><w>has</w><w>been</w><w>reduced</w><w>to</w><w>19</w><w>columns</w><w>that</w><w>include</w><w>core</w><w>mission</w><w>information</w><w>and</w><w>bombing</w><w>data</w><pc>.</pc><w>These</w><w>columns</w><w>are</w><w>discussed</w><w>below</w><w>when</w><w>we</w><w>first</w><w>load</w><w>the</w><w>data</w><pc>.</pc><w>The</w><w>unabridged</w><w>dataset</w><w>is</w><w>available</w><w>for</w><w>download</w><ref target="https://data.world/datamil/world-war-ii-thor-data"><w>here</w></ref><pc>.</pc></p><p><w>The</w><w>dataset</w><w>used</w><w>in</w><w>this</w><w>tutorial</w><w>is</w><w>contained</w><w>in</w><ref target="https://github.com/programminghistorian/ph-submissions/tree/gh-pages/assets/visualizing-with-bokeh/thor_wwii.csv"><w>thor_wwii.csv</w></ref><pc>.</pc><w>This</w><w>file</w><w>is</w><w>required</w><w>to</w><w>complete</w><w>most</w><w>of</w><w>the</w><w>examples</w><w>below</w><pc>.</pc></p><p><w>We</w><w>'ll</w><w>use</w><w>Bokeh</w><w>and</w><w>Pandas</w><w>to</w><w>address</w><w>some</w><w>of</w><w>the</w><w>following</w><w>questions</w><w>:</w></p><list type="unordered"><item><w>What</w><w>types</w><w>and</w><w>weights</w><w>of</w><w>munitions</w><w>were</w><w>dropped</w><w>during</w><w>World</w><w>War</w><w>II</w><w>(</w><w>WWII</w><w>)</w><pc>?</pc><w>What</w><w>patterns</w><w>can</w><w>we</w><w>discern</w><w>in</w><w>the</w><w>use</w><w>of</w><w>different</w><w>types</w><w>of</w><w>munitions</w><pc>?</pc></item><item><w>How</w><w>did</w><w>the</w><w>types</w><w>and</w><w>weights</w><w>of</w><w>munitions</w><w>dropped</w><w>change</w><w>over</w><w>the</w><w>course</w><w>of</w><w>WWII</w><pc>?</pc><w>How</w><w>do</w><w>these</w><w>changes</w><w>correspond</w><w>to</w><w>major</w><w>military</w><w>events</w><pc>?</pc></item><item><w>What</w><w>targets</w><w>were</w><w>munitions</w><w>dropped</w><w>on</w><w>during</w><w>the</w><w>war</w><pc>?</pc><w>Were</w><w>particular</w><w>types</w><w>of</w><w>munitions</w><w>limited</w><w>to</w><w>certain</w><w>theaters</w><w>of</w><w>operations</w><w>or</w><w>targets</w><pc>?</pc></item></list></div><div type="3" n="2.2"><head><w>Other</w><w>Possible</w><w>Datasets</w></head><p><w>If</w><w>this</w><w>dataset</w><w>does</w><w>n't</w><w>fit</w><w>your</w><w>interests</w><w>or</w><w>if</w><w>you</w><w>'d</w><w>like</w><w>more</w><w>practice</w><w>after</w><w>completing</w><w>this</w><w>tutorial</w><w>,</w><w>here</w><w>are</w><w>a</w><w>few</w><w>other</w><w>interesting</w><w>datasets</w><w>that</w><w>you</w><w>might</w><w>wish</w><w>to</w><w>use</w><w>with</w><w>Bokeh</w><w>and</w><w>Pandas</w><w>:</w></p><list type="unordered"><item><p><ref target="https://data.world/history/scottish-witchcraft/"><w>Scottish</w><w>Witchcraft</w><w>Trials</w></ref><w>:</w><w>A</w><w>multi-table</w><w>set</w><w>of</w><w>data</w><w>on</w><w>over</w><w>4,000</w><w>people</w><w>accused</w><w>of</w><w>witchcraft</w><w>between</w><w>1536</w><w>and</w><w>1736</w><pc>.</pc></p></item><item><p><ref target="https://data.world/history/civil-unrest-event-data"><w>Civil</w><w>Unrest</w><w>Events</w></ref><w>:</w><w>A</w><w>single</w><w>table</w><w>cataloging</w><w>over</w><w>60,000</w><w>events</w><w>of</w><w>civil</w><w>unrest</w><w>across</w><w>the</w><w>world</w><w>since</w><w>the</w><w>end</w><w>of</w><w>World</w><w>War</w><w>II</w><pc>.</pc></p></item><item><p><ref target="https://www.slavevoyages.org/voyage/database"><w>Trans-Atlantic</w><w>Slave</w><w>Trade</w><w>Database</w></ref><w>:</w><w>Searchable</w><w>and</w><w>customizable</w><w>tabular</w><w>data</w><w>on</w><w>36,000</w><w>slaving</w><w>voyages</w><w>that</w><w>transported</w><w>over</w><w>10</w><w>million</w><w>slaves</w><w>from</w><w>the</w><w>16th</w><w>to</w><w>19th</w><w>centuries</w><pc>.</pc></p></item></list><p><w>All</w><w>three</w><w>datasets</w><w>contain</w><w>comparable</w><w>quantitative</w><w>,</w><w>qualitative</w><w>,</w><w>and</w><w>temporal</w><w>data</w><w>to</w><w>those</w><w>found</w><w>in</w><w>the</w><w>THOR</w><w>dataset</w><pc>.</pc><w>The</w><w>Civil</w><w>Unrest</w><w>Events</w><w>and</w><w>Trans-Atlantic</w><w>Slave</w><w>Trade</w><w>datasets</w><w>both</w><w>contain</w><w>spatial</w><w>data</w><w>,</w><w>though</w><w>this</w><w>is</w><w>lacking</w><w>from</w><w>the</w><w>Scottish</w><w>Witchcraft</w><w>Trials</w><w>data</w><pc>.</pc></p></div></div><div type="2" n="3"><head><w>Getting</w><w>Started</w></head><div type="3" n="3.1"><head><w>Prerequisites</w></head><p><w>This</w><w>tutorial</w><w>can</w><w>be</w><w>completed</w><w>using</w><w>any</w><w>operating</w><w>systems</w><pc>.</pc><w>It</w><w>requires</w><w>Python</w><w>3</w><w>and</w><w>a</w><w>web</w><w>browser</w><pc>.</pc><w>You</w><w>may</w><w>use</w><w>any</w><w>text</w><w>editor</w><w>to</w><w>write</w><w>your</w><w>code</w><pc>.</pc></p><p><w>This</w><w>tutorial</w><w>assumes</w><w>that</w><w>you</w><w>have</w><w>a</w><w>basic</w><w>knowledge</w><w>of</w><w>the</w><w>Python</w><w>language</w><w>and</w><w>its</w><w>associated</w><w>data</w><w>structures</w><w>,</w><w>particularly</w><w>lists</w><pc>.</pc></p><p><w>If</w><w>you</w><w>work</w><w>in</w><w>Python</w><w>2</w><w>,</w><w>you</w><w>will</w><w>need</w><w>to</w><w>create</w><w>a</w><w>virtual</w><w>environment</w><w>for</w><w>Python</w><w>3</w><w>,</w><w>and</w><w>even</w><w>if</w><w>you</w><w>work</w><w>in</w><w>Python</w><w>3</w><w>,</w><w>creating</w><w>a</w><w>virtual</w><w>environment</w><w>for</w><w>this</w><w>tutorial</w><w>is</w><w>good</w><w>practice</w><pc>.</pc></p></div><div type="3" n="3.2"><head><w>Creating</w><w>a</w><w>Python</w><w>3</w><w>Virtual</w><w>Environment</w></head><p><w>A</w><w>Python</w><w>virutal</w><w>environment</w><w>is</w><w>an</w><w>isolated</w><w>environment</w><w>in</w><w>which</w><w>you</w><w>can</w><w>install</w><w>libraries</w><w>and</w><w>execute</w><w>code</w><pc>.</pc><w>Many</w><w>different</w><w>virtual</w><w>evironments</w><w>can</w><w>be</w><w>created</w><w>to</w><w>work</w><w>with</w><w>different</w><w>versions</w><w>of</w><w>Python</w><w>and</w><w>Python</w><w>libraries</w><pc>.</pc><w>Virtual</w><w>environments</w><w>are</w><w>useful</w><w>because</w><w>they</w><w>ensure</w><w>you</w><w>have</w><w>only</w><w>the</w><w>necessary</w><w>libraries</w><w>installed</w><w>and</w><w>that</w><w>you</w><w>do</w><w>not</w><w>encounter</w><w>version</w><w>conflicts</w><pc>.</pc><w>An</w><w>additional</w><w>benefit</w><w>of</w><w>virtual</w><w>environments</w><w>is</w><w>that</w><w>you</w><w>can</w><w>pass</w><w>them</w><w>to</w><w>others</w><w>so</w><w>that</w><w>you</w><w>know</w><w>your</w><w>code</w><w>will</w><w>execute</w><w>on</w><w>another</w><w>machine</w><pc>.</pc></p><p><ref target="https://conda.io/miniconda.html"><w>Miniconda</w></ref><w>is</w><w>one</w><w>easy</w><w>way</w><w>to</w><w>create</w><w>virtual</w><w>environments</w><w>that</w><w>is</w><w>simple</w><w>to</w><w>install</w><w>across</w><w>operating</w><w>systems</w><pc>.</pc><w>You</w><w>should</w><w>download</w><w>Miniconda</w><w>and</w><w>follow</w><w>the</w><w>instructions</w><w>for</w><ref target="https://conda.io/projects/conda/en/stable/user-guide/install/windows.html"><w>Windows</w></ref><w>,</w><ref target="https://conda.io/projects/conda/en/stable/user-guide/install/macos.html"><w>Mac</w></ref><w>,</w><w>or</w><ref target="https://conda.io/projects/conda/en/stable/user-guide/install/linux.html"><w>Linux</w></ref><w>as</w><w>appropriate</w><w>for</w><w>your</w><w>operating</w><w>system</w><pc>.</pc></p><p><w>Once</w><w>you</w><w>have</w><w>downloaded</w><w>and</w><w>installed</w><w>Miniconda</w><w>for</w><w>your</w><w>operating</w><w>system</w><w>,</w><w>you</w><w>can</w><w>check</w><w>that</w><w>it</w><w>has</w><w>installed</w><w>correctly</w><w>by</w><w>opening</w><w>a</w><w>command</w><w>line</w><w>and</w><w>typing</w><w>:</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_0" corresp="code_visualizing-with-bokeh_0.txt" rend="block"/></ab><p><w>If</w><w>you</w><w>see</w><w>version</w><w>information</w><w>similar</w><w>to</w><w>the</w><w>following</w><w>,</w><w>then</w><w>Miniconda</w><w>has</w><w>installed</w><w>correctly</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_1" corresp="code_visualizing-with-bokeh_1.txt" rend="block"/></ab><p><w>We</w><w>'ll</w><w>use</w><w>Miniconda</w><w>to</w><w>create</w><w>a</w><w>Python</w><w>3</w><w>virtual</w><w>environment</w><w>named</w><emph><w>bokeh-env</w></emph><w>for</w><w>this</w><w>tutorial</w><pc>.</pc><w>In</w><w>the</w><w>command</w><w>line</w><w>type</w><w>the</w><w>following</w><w>:</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_2" corresp="code_visualizing-with-bokeh_2.txt" rend="block"/></ab><p><w>Say</w><w>'yes</w><w>'</w><w>when</w><w>you</w><w>are</w><w>prompted</w><w>to</w><w>install</w><w>new</w><w>packages</w><pc>.</pc></p><p><w>To</w><w>activate</w><w>the</w><emph><w>bokeh-env</w></emph><w>virtual</w><w>environment</w><w>,</w><w>the</w><w>command</w><w>differs</w><w>slightly</w><w>depending</w><w>on</w><w>your</w><w>operating</w><w>system</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_3" corresp="code_visualizing-with-bokeh_3.txt" rend="block"/></ab><p><w>Your</w><w>command</w><w>line</w><w>should</w><w>now</w><w>show</w><w>that</w><w>you</w><w>are</w><w>in</w><w>the</w><emph><w>bokeh-env</w></emph><w>virtual</w><w>environment</w><pc>.</pc></p><p><w>When</w><w>you</w><w>would</w><w>like</w><w>to</w><w>leave</w><w>the</w><w>virtual</w><w>environment</w><w>,</w><w>you</w><w>can</w><w>type</w><w>the</w><w>command</w><w>appropriate</w><w>for</w><w>your</w><w>operating</w><w>system</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_4" corresp="code_visualizing-with-bokeh_4.txt" rend="block"/></ab></div><div type="3" n="3.3"><head><w>Installing</w><w>Packages</w></head><p><w>In</w><w>your</w><w>activated</w><emph><w>bokeh-env</w></emph><w>virtual</w><w>environment</w><w>,</w><w>issue</w><w>the</w><w>following</w><w>command</w><w>to</w><w>install</w><w>the</w><w>python</w><w>packages</w><w>for</w><w>this</w><w>tutorial</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_5" corresp="code_visualizing-with-bokeh_5.txt" rend="block"/></ab><p><w>To</w><w>get</w><w>the</w><w>exact</w><w>versions</w><w>used</w><w>to</w><w>write</w><w>this</w><w>tutorial</w><w>(</w><w>note</w><w>:</w><w>these</w><w>may</w><w>not</w><w>be</w><w>the</w><w>most</w><w>recent</w><w>versions</w><w>of</w><w>each</w><w>python</w><w>package</w><w>)</w><w>you</w><w>can</w><w>pass</w><w>the</w><w>following</w><w>version</w><w>numbers</w><w>to</w><code rend="inline"><w>pip</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_6" corresp="code_visualizing-with-bokeh_6.txt" rend="block"/></ab></div><div type="3" n="3.4"><head><w>Running</w><w>Code</w><w>Examples</w></head><p rend="alert"><w>At</w><w>this</w><w>point</w><w>in</w><w>the</w><w>lesson</w><w>,</w><w>you</w><w>have</w><w>a</w><w>choice</w><w>of</w><w>two</w><w>ways</w><w>to</w><w>experiment</w><w>with</w><w>``</w><w>Running</w><w>Code</w><w>Examples</w><w>''</w><pc>.</pc><w>You</w><w>can</w><w>either</w><w>proceed</w><w>in</w><w>the</w><w>command</w><w>line</w><w>and</w><w>do</w><w>the</w><w>coding</w><w>by</w><w>hand</w><w>,</w><w>or</w><w>run</w><w>the</w><w>Jupyter</w><w>notebook</w><w>provided</w><ref target="https://github.com/programminghistorian/ph-submissions/tree/gh-pages/assets/visualizing-with-bokeh/visualizing-with-bokeh.ipynb"><w>here</w></ref><pc>.</pc><w>Beginners</w><w>who</w><w>simply</w><w>want</w><w>to</w><w>get</w><w>a</w><w>sense</w><w>of</w><w>how</w><w>the</w><w>code</w><w>operates</w><w>,</w><w>rather</w><w>than</w><w>write</w><w>it</w><w>themselves</w><w>,</w><w>may</w><w>find</w><w>the</w><w>Jupyter</w><w>notebook</w><w>option</w><w>especially</w><w>helpful</w><pc>.</pc></p><p><w>It</w><w>is</w><w>easiest</w><w>first</w><w>to</w><w>create</w><w>a</w><w>single</w><w>directory</w><w>and</w><w>save</w><w>each</w><w>code</w><w>example</w><w>as</w><w>a</w><emph><w>.py</w></emph><w>within</w><w>it</w><pc>.</pc><w>When</w><w>you</w><w>are</w><w>ready</w><w>to</w><w>run</w><w>the</w><w>code</w><w>file</w><w>,</w><w>navigate</w><w>to</w><w>this</w><w>directory</w><w>in</w><w>your</w><w>command</w><w>prompt</w><w>and</w><w>make</w><w>sure</w><w>your</w><w>virtual</w><w>environment</w><w>is</w><w>activated</w><pc>.</pc><w>Remember</w><w>that</w><w>you</w><w>can</w><w>always</w><w>activate</w><w>the</w><w>environment</w><w>with</w><w>the</w><w>following</w><w>command</w><w>appropriate</w><w>for</w><w>your</w><w>operating</w><w>system</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_7" corresp="code_visualizing-with-bokeh_7.txt" rend="block"/></ab><p><w>Within</w><w>the</w><w>virtual</w><w>environment</w><w>,</w><w>you</w><w>can</w><w>run</w><w>your</w><w>code</w><w>by</w><w>typing</w><w>:</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_8" corresp="code_visualizing-with-bokeh_8.txt" rend="block"/></ab><p><w>A</w><w>Jupyter</w><w>Notebook</w><w>containing</w><w>the</w><w>code</w><w>used</w><w>in</w><w>this</w><w>tutorial</w><w>is</w><w>also</w><ref target="https://github.com/programminghistorian/ph-submissions/tree/gh-pages/assets/visualizing-with-bokeh/visualizing-with-bokeh.ipynb"><w>available</w></ref><w>in</w><w>case</w><w>you</w><w>prefer</w><w>to</w><w>work</w><w>through</w><w>the</w><w>tutorial</w><w>without</w><w>installing</w><w>a</w><w>virtual</w><w>environment</w><pc>.</pc><w>You</w><w>can</w><w>learn</w><w>more</w><w>about</w><w>Jupyter</w><w>Notebook</w><ref target="http://jupyter.org"><w>here</w></ref><pc>.</pc><w>If</w><w>you</w><w>have</w><w>created</w><w>a</w><w>virtual</w><w>environment</w><w>using</w><w>Miniconda</w><w>,</w><w>as</w><w>discussed</w><w>above</w><w>,</w><w>you</w><w>can</w><w>install</w><w>Jupyter</w><w>Notebook</w><w>in</w><w>the</w><w>environment</w><w>by</w><w>typing</w><code rend="inline"><w>conda</w><w>install</w><w>jupyter</w></code></p></div></div><div type="2" n="4"><head><w>The</w><w>Basics</w><w>of</w><w>Bokeh</w></head><div type="3" n="4.1"><head><w>What</w><w>is</w><w>Bokeh</w><pc>?</pc></head><p><w>Bokeh</w><w>is</w><w>a</w><w>library</w><w>for</w><w>creating</w><w>interactive</w><w>data</w><w>visualizations</w><w>in</w><w>a</w><w>web</w><w>browser</w><pc>.</pc><w>It</w><w>offers</w><w>a</w><w>concise</w><w>,</w><w>human-readable</w><w>syntax</w><w>,</w><w>which</w><w>allows</w><w>for</w><w>rapidly</w><w>presenting</w><w>data</w><w>in</w><w>an</w><w>aesthetically</w><w>pleasing</w><w>manner</w><pc>.</pc><w>If</w><w>you</w><w>'ve</w><w>worked</w><w>with</w><w>visualization</w><w>in</w><w>Python</w><w>before</w><w>,</w><w>it</w><w>'s</w><w>likely</w><w>that</w><w>you</w><w>have</w><w>used</w><ref target="https://matplotlib.org"><w>matplotlib</w></ref><pc>.</pc><w>It</w><w>'s</w><w>worth</w><w>briefly</w><w>mentioning</w><w>how</w><w>Bokeh</w><w>differs</w><w>from</w><w>matplotlib</w><w>,</w><w>and</w><w>when</w><w>one</w><w>might</w><w>be</w><w>preferred</w><w>to</w><w>the</w><w>other</w><pc>.</pc></p><p><w>Matplotlib</w><w>has</w><w>existed</w><w>since</w><w>2002</w><w>and</w><w>has</w><w>long</w><w>been</w><w>a</w><w>standard</w><w>of</w><w>Python</w><w>data</w><w>visualization</w><pc>.</pc><w>Bokeh</w><w>emerged</w><w>in</w><w>2013</w><pc>.</pc><w>This</w><w>difference</w><w>in</w><w>age</w><w>means</w><w>that</w><w>Matplotlib</w><w>matured</w><w>long</w><w>before</w><w>Bokeh</w><w>was</w><w>released</w><w>;</w><w>however</w><w>,</w><w>in</w><w>a</w><w>short</w><w>period</w><w>of</w><w>time</w><w>,</w><w>Bokeh</w><w>has</w><w>reached</w><w>a</w><w>high</w><w>level</w><w>of</w><w>maturity</w><pc>.</pc></p><p><w>The</w><w>intended</w><w>uses</w><w>of</w><w>matplotlib</w><w>and</w><w>Bokeh</w><w>are</w><w>quite</w><w>different</w><pc>.</pc><w>Matplotlib</w><w>creates</w><w>static</w><w>graphics</w><w>that</w><w>are</w><w>useful</w><w>for</w><w>quick</w><w>and</w><w>simple</w><w>visualizations</w><w>,</w><w>or</w><w>for</w><w>creating</w><w>publication</w><w>quality</w><w>images</w><pc>.</pc><w>Bokeh</w><w>creates</w><w>visualizations</w><w>for</w><w>display</w><w>on</w><w>the</w><w>web</w><w>(</w><w>whether</w><w>locally</w><w>or</w><w>embedded</w><w>in</w><w>a</w><w>webpage</w><w>)</w><w>and</w><w>most</w><w>importantly</w><w>,</w><w>the</w><w>visualizations</w><w>are</w><w>meant</w><w>to</w><w>be</w><w>highly</w><w>interactive</w><pc>.</pc><w>Matplotlib</w><w>does</w><w>not</w><w>offer</w><w>either</w><w>of</w><w>these</w><w>features</w><pc>.</pc></p><p><w>If</w><w>would</w><w>you</w><w>like</w><w>to</w><w>visually</w><w>interact</w><w>with</w><w>your</w><w>data</w><w>in</w><w>an</w><w>exploratory</w><w>manner</w><w>or</w><w>you</w><w>would</w><w>like</w><w>to</w><w>distribute</w><w>interactive</w><w>visual</w><w>data</w><w>to</w><w>a</w><w>web</w><w>audience</w><w>,</w><w>Bokeh</w><w>is</w><w>the</w><w>library</w><w>for</w><w>you</w><pc>!</pc><w>If</w><w>your</w><w>main</w><w>interest</w><w>is</w><w>producing</w><w>finalized</w><w>visualizations</w><w>for</w><w>publication</w><w>,</w><w>matplotlib</w><w>may</w><w>be</w><w>better</w><w>,</w><w>although</w><w>Bokeh</w><w>does</w><w>offer</w><w>a</w><w>way</w><w>to</w><w>create</w><w>static</w><w>graphics</w><pc>.</pc></p><p><w>With</w><w>this</w><w>differences</w><w>in</w><w>mind</w><w>,</w><w>as</w><w>we</w><w>work</w><w>through</w><w>the</w><w>lesson</w><w>,</w><w>I</w><w>'ll</w><w>emphasize</w><w>the</w><w>interactive</w><w>aspects</w><w>that</w><w>make</w><w>Bokeh</w><w>useful</w><w>for</w><w>exploring</w><w>and</w><w>disseminating</w><w>historical</w><w>data</w><w>and</w><w>that</w><w>set</w><w>it</w><w>apart</w><w>from</w><w>other</w><w>libraries</w><w>like</w><w>matplotlib</w><pc>.</pc></p></div><div type="3" n="4.2"><head><w>Your</w><w>First</w><w>Plot</w></head><p><w>First</w><w>,</w><w>create</w><w>a</w><w>new</w><w>file</w><w>called</w><code rend="inline"><w>my_first_plot.py</w></code><w>in</w><w>the</w><w>same</w><w>directory</w><w>as</w><code rend="inline"><w>wwii_thor.csv</w></code><w>and</w><w>then</w><w>open</w><w>it</w><w>up</w><w>in</w><w>a</w><w>text</w><w>editor</w><pc>.</pc><w>We</w><w>'ll</w><w>be</w><w>adding</w><w>lines</w><w>to</w><w>this</w><w>file</w><w>to</w><w>run</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_9" corresp="code_visualizing-with-bokeh_9.txt" rend="block"/></ab><p><w>To</w><w>implement</w><w>and</w><w>use</w><w>Bokeh</w><w>,</w><w>we</w><w>first</w><w>import</w><w>some</w><w>basics</w><w>that</w><w>we</w><w>need</w><w>from</w><w>the</w><code rend="inline"><w>bokeh.plotting</w></code><w>module</w><pc>.</pc></p><p><code rend="inline"><w>figure</w></code><w>is</w><w>the</w><w>core</w><w>object</w><w>that</w><w>we</w><w>will</w><w>use</w><w>to</w><w>create</w><w>plots</w><pc>.</pc><code rend="inline"><w>figure</w></code><w>handles</w><w>the</w><w>styling</w><w>of</w><w>plots</w><w>,</w><w>including</w><w>title</w><w>,</w><w>labels</w><w>,</w><w>axes</w><w>,</w><w>and</w><w>grids</w><w>,</w><w>and</w><w>it</w><w>exposes</w><w>methods</w><w>for</w><w>adding</w><w>data</w><w>to</w><w>the</w><w>plot</w><pc>.</pc><w>The</w><code rend="inline"><w>output_file</w></code><w>function</w><w>defines</w><w>how</w><w>the</w><w>visualization</w><w>will</w><w>be</w><w>rendered</w><w>(</w><w>namely</w><w>to</w><w>an</w><w>html</w><w>file</w><w>)</w><w>and</w><w>the</w><code rend="inline"><w>show</w></code><w>function</w><w>will</w><w>be</w><w>invoked</w><w>when</w><w>the</w><w>plot</w><w>is</w><w>ready</w><w>for</w><w>output</w><pc>.</pc><code rend="inline"><w>show</w></code><w>tells</w><w>Bokeh</w><w>that</w><w>all</w><w>of</w><w>the</w><w>data</w><w>has</w><w>been</w><w>added</w><w>to</w><w>the</w><w>plot</w><w>and</w><w>it</w><w>is</w><w>time</w><w>to</w><w>render</w><w>it</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_10" corresp="code_visualizing-with-bokeh_10.txt" rend="block"/></ab><p><w>Bokeh</w><w>recommends</w><w>that</w><code rend="inline"><w>output_file</w></code><w>,</w><w>to</w><w>which</w><w>we</w><w>pass</w><w>a</w><w>file</w><w>name</w><w>,</w><w>be</w><w>called</w><w>at</w><w>the</w><w>start</w><w>of</w><w>your</w><w>script</w><w>,</w><w>immediately</w><w>after</w><w>imports</w><pc>.</pc><w>An</w><w>alternative</w><w>output</w><w>function</w><w>to</w><w>be</w><w>aware</w><w>of</w><w>is</w><code rend="inline"><w>output_notebook</w></code><w>which</w><w>is</w><w>used</w><w>to</w><w>show</w><w>plots</w><w>in-line</w><w>in</w><w>a</w><w>Jupyter</w><w>Notebook</w><pc>.</pc><w>To</w><w>learn</w><w>more</w><w>about</w><w>installing</w><w>and</w><w>using</w><w>Jupyter</w><w>notebooks</w><w>,</w><w>see</w><ref target="https://jupyter.readthedocs.io/en/latest/"><w>Jupyter</w><w>'s</w><w>documentation</w></ref><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_11" corresp="code_visualizing-with-bokeh_11.txt" rend="block"/></ab><p><w>Next</w><w>we</w><w>'ll</w><w>create</w><w>some</w><w>data</w><w>to</w><w>plot</w><pc>.</pc><w>Data</w><w>in</w><w>Bokeh</w><w>can</w><w>take</w><w>on</w><w>different</w><w>forms</w><w>,</w><w>but</w><w>at</w><w>its</w><w>simplest</w><w>,</w><w>data</w><w>is</w><w>just</w><w>a</w><w>list</w><w>of</w><w>values</w><pc>.</pc><w>We</w><w>create</w><w>one</w><w>list</w><w>for</w><w>our</w><w>x-axis</w><w>and</w><w>one</w><w>for</w><w>our</w><w>y-axis</w><pc>.</pc></p><p><w>With</w><w>our</w><w>output</w><w>format</w><w>and</w><w>data</w><w>fixed</w><w>,</w><w>we</w><w>can</w><w>instantiate</w><w>a</w><code rend="inline"><w>figure</w></code><w>and</w><w>add</w><w>the</w><w>data</w><w>to</w><w>it</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_12" corresp="code_visualizing-with-bokeh_12.txt" rend="block"/></ab><p><w>{</w><w>%</w><w>include</w><w>alert.html</w><w>text=</w><w>''</w><code rend="inline"><w>p</w></code><w>is</w><w>a</w><w>common</w><w>variable</w><w>name</w><w>for</w><w>a</w><code rend="inline"><w>figure</w></code><w>object</w><w>,</w><w>since</w><w>a</w><w>figure</w><w>is</w><w>a</w><w>type</w><w>of</w><w>plot</w><pc>.</pc><w>''</w><w>%</w><w>}</w></p><p><w>After</w><w>instantiating</w><w>the</w><w>figure</w><w>,</w><w>we</w><w>call</w><w>the</w><code rend="inline"><w>circle</w></code><w>,</w><code rend="inline"><w>line</w></code><w>,</w><w>and</w><code rend="inline"><w>triangle</w></code><w>methods</w><w>to</w><w>plot</w><w>our</w><w>data</w><pc>.</pc><w>These</w><w>types</w><w>of</w><w>methods</w><w>are</w><w>known</w><w>as</w><w>a</w><emph><w>glyph</w><w>method</w></emph><pc>.</pc><w>The</w><w>term</w><emph><w>glyph</w></emph><w>in</w><w>Bokeh</w><w>refers</w><w>to</w><w>the</w><w>lines</w><w>,</w><w>circles</w><w>,</w><w>bars</w><w>,</w><w>and</w><w>other</w><w>shapes</w><w>that</w><w>are</w><w>added</w><w>to</w><w>plots</w><w>to</w><w>display</w><w>data</w><pc>.</pc></p><p><w>If</w><w>we</w><w>wanted</w><w>,</w><w>we</w><w>could</w><w>just</w><w>keep</w><w>adding</w><w>glyphs</w><w>to</w><w>the</w><w>plot</w><pc>!</pc><w>In</w><w>addition</w><w>to</w><w>the</w><code rend="inline"><w>circle</w></code><w>,</w><code rend="inline"><w>line</w></code><w>,</w><w>and</w><code rend="inline"><w>triangle</w></code><w>glyphs</w><w>,</w><w>there</w><w>are</w><w>many</w><w>others</w><w>,</w><w>including</w><w>:</w><code rend="inline"><w>asterisk</w></code><w>,</w><code rend="inline"><w>circle_cross</w></code><w>,</w><code rend="inline"><w>circle_x</w></code><w>,</w><code rend="inline"><w>cross</w></code><w>,</w><code rend="inline"><w>diamond</w></code><w>,</w><code rend="inline"><w>diamond_cross</w></code><w>,</w><code rend="inline"><w>inverted_triangle</w></code><w>,</w><code rend="inline"><w>square</w></code><w>,</w><code rend="inline"><w>square_cross</w></code><w>,</w><code rend="inline"><w>square_x</w></code><w>,</w><w>and</w><code rend="inline"><w>x</w></code><pc>.</pc></p><p><w>When</w><w>calling</w><w>a</w><w>glyph</w><w>method</w><w>,</w><w>at</w><w>a</w><w>minimum</w><w>,</w><w>we</w><w>must</w><w>pass</w><w>the</w><w>data</w><w>we</w><w>would</w><w>like</w><w>to</w><w>plot</w><w>,</w><w>but</w><w>frequently</w><w>we</w><w>might</w><w>add</w><w>styling</w><w>arguments</w><pc>.</pc><w>Here</w><w>,</w><w>we</w><w>set</w><w>a</w><w>size</w><w>,</w><w>color</w><w>,</w><w>and</w><w>legend</w><w>name</w><w>for</w><w>each</w><w>glyph</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_13" corresp="code_visualizing-with-bokeh_13.txt" rend="block"/></ab><p><w>We</w><w>will</w><w>also</w><w>add</w><w>our</w><w>first</w><w>piece</w><w>of</w><w>code</w><w>that</w><w>brings</w><w>some</w><w>interactivity</w><w>to</w><w>the</w><w>plot</w><pc>.</pc><w>By</w><w>setting</w><w>a</w><code rend="inline"><w>click_policy</w></code><w>on</w><w>our</w><w>legend</w><w>,</w><w>a</w><w>user</w><w>can</w><w>now</w><w>click</w><w>on</w><w>each</w><w>legend</w><w>entry</w><w>(</w><w>e.g</w><pc>.</pc><w>circle</w><w>,</w><w>line</w><w>,</w><w>triangle</w><w>)</w><w>to</w><w>show/hide</w><w>that</w><w>piece</w><w>of</w><w>data</w><pc>!</pc><w>The</w><code rend="inline"><w>click_policy</w></code><w>can</w><w>also</w><w>be</w><w>set</w><w>to</w><code rend="inline"><w>mute</w></code><w>instead</w><w>of</w><code rend="inline"><w>hide</w></code><pc>.</pc><w>This</w><w>would</w><w>mute</w><w>the</w><w>color</w><w>of</w><w>that</w><w>data</w><w>on</w><w>clicking</w><w>rather</w><w>than</w><w>hide</w><w>it</w><w>completely</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_14" corresp="code_visualizing-with-bokeh_14.txt" rend="block"/></ab><p><w>Calling</w><code rend="inline"><w>show</w></code><w>and</w><w>passing</w><w>the</w><w>instantiated</w><code rend="inline"><w>figure</w></code><w>will</w><w>output</w><w>the</w><w>results</w><w>to</w><w>our</w><w>html</w><w>file</w><pc>.</pc><w>Now</w><w>let</w><w>'s</w><w>run</w><w>this</w><w>code</w><pc>!</pc></p><p><w>In</w><w>your</w><w>command</w><w>line</w><w>,</w><w>make</w><w>sure</w><w>you</w><w>'re</w><w>in</w><w>the</w><w>directory</w><w>where</w><w>you</w><w>'ve</w><w>saved</w><w>the</w><w>file</w><w>and</w><w>then</w><w>run</w><w>the</w><w>file</w><w>with</w><w>the</w><code rend="inline"><w>python</w></code><w>command</w><pc>.</pc></p><ab><code xml:id="code_visualizing-with-bokeh_15" corresp="code_visualizing-with-bokeh_15.txt" rend="block"/></ab><figure><desc><w>Plotting</w><w>a</w><w>Single</w><w>Glyph</w></desc><graphic url="visualizing-with-bokeh-1.png"/></figure><p><w>A</w><w>web</w><w>browser</w><w>will</w><w>now</w><w>appear</w><w>showing</w><w>the</w><w>html</w><w>file</w><w>with</w><w>your</w><w>visualization</w><pc>.</pc><w>The</w><w>red</w><w>circles</w><w>,</w><w>blue</w><w>line</w><w>,</w><w>and</w><w>gold</w><w>triangles</w><w>are</w><w>the</w><w>result</w><w>of</w><w>our</w><w>glyph</w><w>method</w><w>calls</w><pc>.</pc><w>Clicking</w><w>the</w><w>legend</w><w>in</w><w>the</w><w>upper</w><w>right</w><w>corner</w><w>will</w><w>show/hide</w><w>each</w><w>glyph</w><w>type</w><pc>.</pc><w>Note</w><w>that</w><w>Bokeh</w><w>has</w><w>automatically</w><w>handled</w><w>the</w><w>creation</w><w>of</w><w>the</w><w>grid-lines</w><w>and</w><w>tick</w><w>labels</w><pc>.</pc></p><p><w>Along</w><w>the</w><w>right-hand</w><w>side</w><w>,</w><w>the</w><w>default</w><w>toolbar</w><w>is</w><w>also</w><w>displayed</w><pc>.</pc><w>The</w><w>tools</w><w>include</w><w>drag</w><w>,</w><w>box</w><w>zoom</w><w>,</w><w>wheel</w><w>zoom</w><w>,</w><w>save</w><w>,</w><w>reset</w><w>,</w><w>and</w><w>help</w><pc>.</pc><w>Using</w><w>these</w><w>tools</w><w>,</w><w>a</w><w>user</w><w>can</w><w>pan</w><w>along</w><w>the</w><w>plot</w><w>or</w><w>zoom</w><w>in</w><w>on</w><w>interesting</w><w>portions</w><w>of</w><w>the</w><w>data</w><pc>.</pc><w>Since</w><w>this</w><w>is</w><w>a</w><w>stand-alone</w><w>HTML</w><w>page</w><w>,</w><w>which</w><w>includes</w><w>a</w><w>reference</w><w>to</w><w>BokehJS</w><w>,</w><w>it</w><w>can</w><w>be</w><w>immediately</w><w>passed</w><w>to</w><w>a</w><w>co-worker</w><w>for</w><w>exploration</w><w>or</w><w>posted</w><w>to</w><w>the</w><w>web</w><pc>.</pc></p></div></div><div type="2" n="5"><head><w>Bokeh</w><w>and</w><w>Pandas</w><w>:</w><w>Exploring</w><w>the</w><w>WWII</w><w>THOR</w><w>Dataset</w></head><p><w>In</w><w>the</w><w>previous</w><w>example</w><w>,</w><w>we</w><w>manually</w><w>created</w><w>two</w><w>short</w><w>Python</w><w>lists</w><w>for</w><w>our</w><w>x</w><w>and</w><w>y</w><w>data</w><pc>.</pc><w>What</w><w>happens</w><w>when</w><w>you</w><w>have</w><w>real-world</w><w>data</w><w>with</w><w>tens-of-thousands</w><w>of</w><w>rows</w><w>and</w><w>dozens</w><w>of</w><w>columns</w><w>stored</w><w>in</w><w>an</w><w>external</w><w>format</w><pc>?</pc><w>Pandas</w><w>,</w><w>a</w><w>widely-used</w><w>data</w><w>science</w><w>library</w><w>,</w><w>is</w><w>ideally</w><w>suited</w><w>to</w><w>this</w><w>type</w><w>of</w><w>data</w><w>and</w><w>integrates</w><w>seamlessly</w><w>with</w><w>Bokeh</w><w>to</w><w>create</w><w>interactive</w><w>visualizations</w><w>of</w><w>data</w><pc>.</pc></p><div type="3" n="5.1"><head><w>Pandas</w><w>Overview</w></head><p><w>For</w><w>the</w><w>purposes</w><w>of</w><w>this</w><w>tutorial</w><w>,</w><w>I</w><w>will</w><w>only</w><w>touch</w><w>on</w><w>the</w><w>basic</w><w>functions</w><w>of</w><w>Pandas</w><w>that</w><w>are</w><w>necessary</w><w>to</w><w>produce</w><w>our</w><w>visualizations</w><pc>.</pc><ref target="https://pandas.pydata.org/pandas-docs/stable/10min.html"><w>10</w><w>Minutes</w><w>to</w><w>Pandas</w></ref><w>and</w><ref target="https://pandas.pydata.org/pandas-docs/stable/tutorials.html#lessons-for-new-pandas-users"><w>Lessons</w><w>for</w><w>New</w><w>Pandas</w><w>Users</w></ref><w>are</w><w>excellent</w><w>introductions</w><w>that</w><w>I</w><w>would</w><w>recommend</w><w>for</w><w>expanding</w><w>your</w><w>knowledge</w><w>beyond</w><w>the</w><w>very</w><w>basics</w><w>touched</w><w>on</w><w>here</w><pc>.</pc></p><p><w>Pandas</w><w>has</w><w>quickly</w><w>become</w><w>the</w><emph><w>de</w><w>facto</w></emph><w>Python</w><w>library</w><w>for</w><w>data</w><w>and</w><w>data</w><w>science</w><w>workflows</w><w>;</w><w>integration</w><w>with</w><w>other</w><w>major</w><w>data</w><w>science</w><w>and</w><w>machine</w><w>learning</w><w>libraries</w><w>has</w><w>only</w><w>fueled</w><w>a</w><w>rise</w><w>in</w><w>popularity</w><pc>.</pc><ref type="footnotemark" target="#en_note_1"/><w>Pandas</w><w>provides</w><w>functionality</w><w>to</w><w>quickly</w><w>and</w><w>efficiently</w><w>read</w><w>,</w><w>write</w><w>,</w><w>and</w><w>modify</w><w>datasets</w><w>for</w><w>analysis</w><pc>.</pc><w>To</w><w>accomplish</w><w>this</w><w>,</w><w>Pandas</w><w>provides</w><w>data</w><w>structures</w><w>that</w><w>hold</w><w>different</w><w>dimensionalities</w><w>of</w><w>data</w><pc>.</pc><w>The</w><code rend="inline"><w>DataFrame</w></code><w>holds</w><w>2-dimensional</w><w>data</w><w>in</w><w>the</w><w>manner</w><w>of</w><w>a</w><w>spreadsheet</w><w>with</w><w>rows</w><w>and</w><w>columns</w><pc>.</pc><w>It</w><w>'s</w><w>through</w><w>this</w><w>object</w><w>that</w><w>we</w><w>'ll</w><w>interact</w><w>with</w><w>our</w><w>WWII</w><w>THOR</w><w>dataset</w><pc>.</pc><w>Let</w><w>'s</w><w>first</w><w>examine</w><w>the</w><w>Pandas</w><code rend="inline"><w>DataFrame</w></code><w>by</w><w>loading</w><w>our</w><w>csv</w><w>data</w><w>into</w><w>one</w><pc>.</pc></p></div><div type="3" n="5.2"><head><w>Loading</w><w>Data</w><w>in</w><w>Pandas</w></head><p><w>To</w><w>begin</w><w>with</w><w>,</w><w>create</w><w>a</w><w>new</w><w>file</w><w>called</w><code rend="inline"><w>loading_data.py</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_16" corresp="code_visualizing-with-bokeh_16.txt" rend="block"/></ab><p><w>We</w><w>start</w><w>by</w><w>importing</w><w>the</w><w>Pandas</w><w>library</w><w>and</w><w>then</w><w>calling</w><code rend="inline"><w>read_csv</w><w>(</w><w>)</w></code><w>and</w><w>passing</w><w>a</w><w>filename</w><w>to</w><w>it</w><pc>.</pc><w>Note</w><w>that</w><w>the</w><w>Pandas</w><w>library</w><w>is</w><w>aliased</w><w>as</w><emph><w>pd</w></emph><pc>.</pc><w>This</w><w>alias</w><w>is</w><w>a</w><w>convention</w><w>followed</w><w>in</w><w>the</w><ref target="https://pandas.pydata.org/pandas-docs/stable/"><w>Pandas</w><w>official</w><w>documentation</w></ref><w>and</w><w>is</w><w>widely</w><w>used</w><w>by</w><w>the</w><w>Pandas</w><w>community</w><pc>.</pc><w>For</w><w>this</w><w>reason</w><w>,</w><w>I</w><w>'ll</w><w>use</w><w>the</w><emph><w>pd</w></emph><w>alias</w><w>throughout</w><w>the</w><w>tutorial</w><pc>.</pc></p><p><w>In</w><w>this</w><w>code</w><w>,</w><code rend="inline"><w>read_csv</w></code><w>creates</w><w>a</w><code rend="inline"><w>DataFrame</w></code><w>that</w><w>holds</w><w>the</w><w>rows/columns</w><w>of</w><w>our</w><w>csv</w><w>data</w><pc>.</pc><w>By</w><w>convention</w><w>,</w><w>the</w><w>variable</w><w>name</w><emph><w>df</w></emph><w>is</w><w>used</w><w>to</w><w>represent</w><w>the</w><w>loaded</w><w>dataframe</w><w>in</w><w>tutorials</w><w>and</w><w>basic</w><w>code</w><w>examples</w><pc>.</pc><ref target="https://pandas.pydata.org/pandas-docs/stable/api.html#input-output"><w>Many</w><w>other</w><w>methods</w></ref><w>exist</w><w>for</w><w>reading</w><w>data</w><w>formats</w><w>other</w><w>than</w><w>csv</w><w>in</w><w>Pandas</w><w>,</w><w>such</w><w>as</w><w>JSON</w><w>,</w><w>SQL</w><w>tables</w><w>,</w><w>Excel</w><w>files</w><w>,</w><w>and</w><w>HTML</w><pc>.</pc></p><p><w>When</w><w>running</w><w>this</w><w>code</w><w>,</w><code rend="inline"><w>print</w><w>(</w><w>df</w><w>)</w></code><w>will</w><w>output</w><w>an</w><w>abridged</w><w>representation</w><w>of</w><w>the</w><w>loaded</w><w>data</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_17" corresp="code_visualizing-with-bokeh_17.txt" rend="block"/></ab><p><w>This</w><w>shows</w><w>that</w><w>we</w><w>have</w><w>178,281</w><w>records</w><w>of</w><w>missions</w><w>with</w><w>19</w><w>columns</w><w>per</w><w>record</w><pc>.</pc><w>To</w><w>see</w><w>what</w><w>the</w><w>19</w><w>columns</w><w>are</w><w>in</w><w>full</w><w>,</w><w>we</w><w>can</w><w>access</w><w>the</w><w>dataframe</w><w>'s</w><code rend="inline"><w>columns</w></code><w>object</w><w>by</w><w>replacing</w><code rend="inline"><w>print</w><w>(</w><w>df</w><w>)</w></code><w>in</w><w>the</w><w>above</w><w>code</w><w>with</w><w>:</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_18" corresp="code_visualizing-with-bokeh_18.txt" rend="block"/></ab><p><w>The</w><w>output</w><w>should</w><w>look</w><w>like</w><w>:</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_19" corresp="code_visualizing-with-bokeh_19.txt" rend="block"/></ab><p><w>Some</w><w>of</w><w>these</w><w>column</w><w>names</w><w>are</w><w>self</w><w>explanatory</w><w>,</w><w>but</w><w>it</w><w>'s</w><w>worth</w><w>pointing</w><w>out</w><w>the</w><w>following</w><w>:</w><w>MSNDATE</w><w>(</w><w>mission</w><w>date</w><w>)</w><w>,</w><w>NAF</w><w>(</w><w>numbered</w><w>airforce</w><w>responsible</w><w>for</w><w>mission</w><w>)</w><w>,</w><w>AC_ATTACKING</w><w>(</w><w>number</w><w>of</w><w>aircraft</w><w>)</w><w>,</w><w>TONS_HE</w><w>(</w><w>high-explosives</w><w>)</w><w>,</w><w>TONS_IC</w><w>(</w><w>incendiary</w><w>devices</w><w>)</w><w>,</w><w>TONS_FRAG</w><w>(</w><w>fragmentation</w><w>bombs</w><w>)</w><pc>.</pc></p><p><w>When</w><w>it</w><w>comes</w><w>to</w><w>accessing</w><w>data</w><w>within</w><w>a</w><code rend="inline"><w>DataFrame</w></code><w>,</w><w>in</w><w>this</w><w>tutorial</w><w>we</w><w>use</w><w>one</w><w>basic</w><w>approach</w><w>:</w><w>indexing</w><pc>.</pc><w>Here</w><w>to</w><w>access</w><w>a</w><w>single</w><w>column</w><w>we</w><w>pass</w><w>a</w><w>string</w><w>to</w><w>our</w><w>dataframe</w><w>'s</w><w>indexer</w><w>:</w><w>e.g</w><pc>.</pc><code rend="inline"><w>df</w><w>[</w><w>'MSNDATE</w><w>'</w><w>]</w></code><pc>.</pc><w>To</w><w>access</w><w>multiple</w><w>columns</w><w>,</w><w>we</w><w>pass</w><w>a</w><w>list</w><w>of</w><w>names</w><w>to</w><w>our</w><w>dataframe</w><w>'s</w><w>indexer</w><w>:</w><w>e.g</w><pc>.</pc><code rend="inline"><w>df</w><w>[</w><w>[</w><w>'MSNDATE</w><w>'</w><w>,</w><w>'THEATER</w><w>'</w><w>]</w><w>]</w></code><pc>.</pc></p></div><div type="3" n="5.3"><head><w>The</w><w>Bokeh</w><w>ColumnDataSource</w></head><p><w>Now</w><w>that</w><w>we</w><w>'ve</w><w>learned</w><w>how</w><w>to</w><w>create</w><w>a</w><w>Bokeh</w><w>plot</w><w>and</w><w>how</w><w>to</w><w>load</w><w>tabular</w><w>data</w><w>into</w><w>Pandas</w><w>,</w><w>it</w><w>'s</w><w>time</w><w>to</w><w>learn</w><w>how</w><w>to</w><w>link</w><w>Pandas</w><w>'</w><code rend="inline"><w>DataFrame</w></code><w>with</w><w>Bokeh</w><w>visualizations</w><pc>.</pc><w>The</w><w>Bokeh</w><w>object</w><code rend="inline"><w>ColumnDataSource</w></code><w>provides</w><w>this</w><w>integration</w><pc>.</pc></p><p><w>The</w><w>object</w><w>'s</w><w>constructor</w><w>accepts</w><w>a</w><w>Pandas</w><code rend="inline"><w>DataFrame</w></code><w>as</w><w>an</w><w>argument</w><pc>.</pc><w>After</w><w>it</w><w>is</w><w>created</w><w>,</w><w>the</w><code rend="inline"><w>ColumnDataSource</w></code><w>can</w><w>then</w><w>be</w><w>passed</w><w>to</w><w>glyph</w><w>methods</w><w>via</w><w>the</w><code rend="inline"><w>source</w></code><w>parameter</w><w>and</w><w>other</w><w>parameters</w><w>,</w><w>such</w><w>as</w><w>our</w><w>x</w><w>and</w><w>y</w><w>data</w><w>,</w><w>can</w><w>then</w><w>reference</w><w>column</w><w>names</w><w>within</w><w>our</w><w>source</w><pc>.</pc><w>Let</w><w>'s</w><w>go</w><w>through</w><w>an</w><w>example</w><w>of</w><w>this</w><pc>.</pc></p><p><w>Using</w><w>our</w><w>THOR</w><w>dataset</w><w>,</w><w>we</w><w>'ll</w><w>create</w><w>a</w><w>scatter</w><w>plot</w><w>of</w><w>the</w><w>number</w><w>of</w><w>attacking</w><w>aircraft</w><w>versus</w><w>the</w><w>tons</w><w>of</w><w>munitions</w><w>dropped</w><pc>.</pc><w>We</w><w>will</w><w>use</w><w>a</w><w>new</w><w>file</w><w>called</w><code rend="inline"><w>column_datasource.py</w></code><w>to</w><w>do</w><w>this</w><pc>.</pc><w>We</w><w>'ll</w><w>also</w><w>take</w><w>this</w><w>opportunity</w><w>to</w><w>learn</w><w>about</w><w>Bokeh</w><w>'s</w><w>interactive</w><w>hover</w><w>feature</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_20" corresp="code_visualizing-with-bokeh_20.txt" rend="block"/></ab><p><w>Here</w><w>,</w><w>we</w><w>import</w><w>Pandas</w><w>,</w><w>the</w><code rend="inline"><w>figure</w></code><w>object</w><w>and</w><w>basic</w><w>functions</w><w>from</w><code rend="inline"><w>bokeh.plotting</w></code><w>,</w><w>and</w><w>the</w><code rend="inline"><w>ColumnDataSource</w></code><w>object</w><w>from</w><code rend="inline"><w>bokeh.models</w></code><pc>.</pc><w>We</w><w>'re</w><w>also</w><w>going</w><w>to</w><w>expand</w><w>our</w><w>knowledge</w><w>of</w><w>interactions</w><w>in</w><w>this</w><w>example</w><w>by</w><w>adding</w><w>a</w><w>hover</w><w>feature</w><w>that</w><w>is</w><w>facilitated</w><w>by</w><w>the</w><code rend="inline"><w>HoverTool</w></code></p><p><w>We</w><w>then</w><w>immediately</w><w>set</w><w>our</w><w>output</w><w>file</w><w>following</w><w>Bokeh</w><w>'s</w><w>recommended</w><w>best</w><w>practices</w><pc>.</pc><w>Finally</w><w>,</w><w>we</w><w>call</w><w>Pandas</w><code rend="inline"><w>read_csv</w></code><w>method</w><w>to</w><w>load</w><w>our</w><w>csv</w><w>into</w><w>a</w><code rend="inline"><w>DataFrame</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_21" corresp="code_visualizing-with-bokeh_21.txt" rend="block"/></ab><p><w>Since</w><w>we</w><w>do</w><w>n't</w><w>want</w><w>to</w><w>plot</w><w>all</w><w>170,000+</w><w>rows</w><w>in</w><w>our</w><w>scatterplot</w><w>(</w><w>which</w><w>would</w><w>require</w><w>a</w><w>longer</w><w>processing</w><w>time</w><w>to</w><w>generate</w><w>and</w><w>would</w><w>create</w><w>a</w><w>confusing</w><w>plot</w><w>due</w><w>to</w><w>the</w><w>volume</w><w>of</w><w>overlapping</w><w>data</w><w>)</w><w>,</w><w>we</w><w>randomly</w><w>sample</w><w>50</w><w>rows</w><w>using</w><w>the</w><w>dataframe</w><w>'s</w><code rend="inline"><w>sample</w></code><w>method</w><pc>.</pc><w>We</w><w>then</w><w>pass</w><w>this</w><w>sample</w><w>to</w><w>the</w><code rend="inline"><w>ColumnDataSource</w></code><w>constructor</w><w>and</w><w>store</w><w>this</w><w>in</w><w>a</w><w>variable</w><w>called</w><code rend="inline"><w>source</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_22" corresp="code_visualizing-with-bokeh_22.txt" rend="block"/></ab><p><w>Next</w><w>,</w><w>we</w><w>create</w><w>our</w><code rend="inline"><w>figure</w></code><w>object</w><w>and</w><w>call</w><w>the</w><code rend="inline"><w>circle</w></code><w>glyph</w><w>method</w><w>to</w><w>plot</w><w>our</w><w>data</w><pc>.</pc><w>This</w><w>is</w><w>where</w><w>the</w><code rend="inline"><w>source</w></code><w>variable</w><w>that</w><w>holds</w><w>our</w><code rend="inline"><w>ColumnDataSource</w></code><w>comes</w><w>into</w><w>play</w><pc>.</pc><w>It</w><w>'s</w><w>passed</w><w>as</w><w>our</w><code rend="inline"><w>source</w></code><w>argument</w><w>to</w><w>the</w><w>glyph</w><w>method</w><w>and</w><w>the</w><w>column</w><w>names</w><w>holding</w><w>the</w><w>number</w><w>of</w><w>attacking</w><w>aircraft</w><w>(</w><w>AC_ATTACKING</w><w>)</w><w>and</w><w>tons</w><w>of</w><w>munitions</w><w>dropped</w><w>(</w><w>TOTAL_TONS</w><w>)</w><w>are</w><w>passed</w><w>as</w><w>our</w><code rend="inline"><w>x</w></code><w>and</w><code rend="inline"><w>y</w></code><w>arguments</w><pc>.</pc></p><p><w>Interestingly</w><w>,</w><w>when</w><w>we</w><w>use</w><w>a</w><code rend="inline"><w>ColumnDataSource</w></code><w>we</w><w>'re</w><w>not</w><w>limited</w><w>to</w><w>just</w><w>using</w><w>column</w><w>names</w><w>for</w><code rend="inline"><w>x</w></code><w>and</w><code rend="inline"><w>y</w></code><w>parameters</w><pc>.</pc><w>We</w><w>can</w><w>also</w><w>pass</w><w>a</w><w>column</w><w>name</w><w>for</w><w>other</w><w>parameters</w><w>such</w><w>as</w><code rend="inline"><w>size</w></code><w>,</w><code rend="inline"><w>line_color</w></code><w>,</w><w>or</w><code rend="inline"><w>fill_color</w></code><pc>.</pc><w>This</w><w>allows</w><w>styling</w><w>options</w><w>to</w><w>be</w><w>determined</w><w>by</w><w>columns</w><w>in</w><w>the</w><w>datasource</w><w>itself</w><pc>!</pc><w>If</w><w>you</w><w>'d</w><w>like</w><w>to</w><w>see</w><w>this</w><w>in</w><w>action</w><w>,</w><w>in</w><w>the</w><w>code</w><w>above</w><w>,</w><w>change</w><code rend="inline"><w>size=10</w></code><w>to</w><code rend="inline"><w>size='TONS_HE</w><w>'</w></code><pc>.</pc><w>The</w><w>size</w><w>of</w><w>each</w><w>dot</w><w>will</w><w>then</w><w>reflect</w><w>the</w><w>tons</w><w>of</w><w>high</w><w>explosives</w><w>used</w><pc>.</pc></p><p><w>{</w><w>%</w><w>include</w><w>alert.html</w><w>text=</w><w>''</w><w>Throughout</w><w>the</w><w>tutorial</w><w>,</w><w>I</w><w>often</w><w>pass</w><w>arguments</w><w>by</w><w>name</w><w>where</w><w>they</w><w>could</w><w>more</w><w>succinctly</w><w>be</w><w>passed</w><w>by</w><w>position</w><pc>.</pc><w>This</w><w>is</w><w>helpful</w><w>,</w><w>in</w><w>my</w><w>opinion</w><w>,</w><w>for</w><w>the</w><w>reader</w><w>to</w><w>keep</w><w>track</w><w>of</w><w>what</w><w>arguments</w><w>are</w><w>being</w><w>passed</w><w>''</w><w>%</w><w>}</w></p><p><w>Next</w><w>we</w><w>add</w><w>a</w><w>title</w><w>and</w><w>label</w><w>our</w><w>axes</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_23" corresp="code_visualizing-with-bokeh_23.txt" rend="block"/></ab><p><w>We</w><w>can</w><w>also</w><w>,</w><w>at</w><w>this</w><w>stage</w><w>,</w><w>learn</w><w>a</w><w>bit</w><w>more</w><w>about</w><w>the</w><w>strong</w><w>interactive</w><w>,</w><w>customizable</w><w>nature</w><w>of</w><w>Bokeh</w><w>plots</w><pc>.</pc><w>In</w><w>our</w><w>first</w><w>Bokeh</w><w>plot</w><w>we</w><w>saw</w><w>the</w><w>default</w><w>Bokeh</w><w>toolbar</w><w>,</w><w>but</w><w>Bokeh</w><w>allows</w><w>us</w><w>to</w><w>customize</w><w>our</w><w>plot</w><w>by</w><w>adding</w><w>new</w><w>interactive</w><w>tools</w><w>to</w><w>it</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_24" corresp="code_visualizing-with-bokeh_24.txt" rend="block"/></ab><p><w>Bokeh</w><w>supports</w><ref target="https://docs.bokeh.org/en/latest/docs/reference/plotting.html"><w>many</w><w>plotting</w><w>tools</w></ref><w>,</w><w>but</w><w>I</w><w>introduce</w><code rend="inline"><w>HoverTool</w></code><w>here</w><w>because</w><w>it</w><w>'s</w><w>particularly</w><w>useful</w><w>for</w><w>data</w><w>exploration</w><w>and</w><w>interaction</w><pc>.</pc><code rend="inline"><w>HoverTool</w></code><w>allows</w><w>you</w><w>to</w><w>set</w><w>a</w><code rend="inline"><w>tooltips</w></code><w>property</w><w>which</w><w>takes</w><w>a</w><w>list</w><w>of</w><ref target="https://www.w3schools.com/python/python_tuples.asp"><w>tuples</w></ref><pc>.</pc><w>The</w><w>first</w><w>part</w><w>of</w><w>the</w><w>tuple</w><w>is</w><w>a</w><w>display</w><w>name</w><w>and</w><w>the</w><w>second</w><w>is</w><w>a</w><w>column</w><w>name</w><w>from</w><w>your</w><code rend="inline"><w>ColumnDataSource</w></code><w>prefaced</w><w>with</w><code rend="inline"><w>@</w></code><pc>.</pc><w>Once</w><w>we</w><w>'ve</w><w>instantiated</w><w>this</w><w>tool</w><w>,</w><w>we</w><w>add</w><w>it</w><w>to</w><w>the</w><w>plot</w><w>using</w><w>the</w><code rend="inline"><w>add_tool</w></code><w>method</w><pc>.</pc><w>We</w><w>'ll</w><w>see</w><w>how</w><w>this</w><w>looks</w><w>in</w><w>a</w><w>moment</w><pc>.</pc></p><p><w>Finally</w><w>,</w><w>we</w><w>make</w><w>sure</w><w>to</w><w>add</w><w>the</w><w>line</w><w>to</w><w>show</w><w>the</w><w>plot</w><pc>.</pc><w>Now</w><w>we</w><w>can</w><w>run</w><code rend="inline"><w>column_datasource.py</w></code><w>and</w><w>interact</w><w>with</w><w>our</w><w>data</w><w>in</w><w>the</w><w>browser</w><pc>.</pc></p><figure><desc><w>Plotting</w><w>with</w><w>the</w><w>ColumnDataSource</w><w>and</w><w>More</w><w>Styling</w><w>Options</w></desc><graphic url="visualizing-with-bokeh-2.png"/></figure><p><w>Note</w><w>that</w><w>because</w><w>we</w><w>are</w><w>randomly</w><w>sampling</w><w>the</w><w>data</w><w>,</w><w>our</w><w>plot</w><w>will</w><w>look</w><w>different</w><w>each</w><w>time</w><w>we</w><w>run</w><w>the</w><w>code</w><pc>.</pc></p><p><w>At</w><w>the</w><w>top</w><w>and</w><w>along</w><w>the</w><w>axes</w><w>of</w><w>the</w><w>plot</w><w>,</w><w>we</w><w>see</w><w>the</w><w>labels</w><w>that</w><w>we</w><w>added</w><pc>.</pc><w>There</w><w>is</w><w>also</w><w>a</w><w>new</w><w>tool</w><w>in</w><w>the</w><w>toolbar</w><pc>.</pc><w>This</w><w>is</w><w>the</w><w>hover</w><w>tool</w><w>that</w><w>we</w><w>added</w><pc>.</pc><w>To</w><w>see</w><w>it</w><w>in</w><w>action</w><w>,</w><w>hover</w><w>over</w><w>any</w><w>data</w><w>point</w><w>in</w><w>the</w><w>scatterplot</w><pc>.</pc><w>A</w><w>window</w><w>will</w><w>pop</w><w>up</w><w>showing</w><w>the</w><w>columns</w><w>we</w><w>set</w><w>in</w><w>our</w><code rend="inline"><w>tooltip</w></code><w>property</w><pc>!</pc></p><p><w>Before</w><w>moving</w><w>to</w><w>the</w><w>next</w><w>section</w><w>of</w><w>the</w><w>lesson</w><w>,</w><w>try</w><w>returning</w><w>to</w><w>the</w><w>example</w><w>above</w><w>and</w><w>adding/removing</w><w>other</w><w>variables</w><w>and</w><w>changing</w><w>display</w><w>names</w><pc>.</pc></p></div></div><div type="2" n="6"><head><w>Categorical</w><w>Data</w><w>and</w><w>Bar</w><w>Charts</w><w>:</w><w>Munitions</w><w>Dropped</w><w>by</w><w>Country</w></head><p><w>In</w><w>the</w><w>preceding</w><w>example</w><w>,</w><w>we</w><w>plotted</w><w>quantitative</w><w>data</w><pc>.</pc><w>Frequently</w><w>,</w><w>though</w><w>,</w><w>we</w><w>want</w><w>to</w><w>plot</w><w>categorical</w><w>data</w><pc>.</pc><w>Categorical</w><w>data</w><w>,</w><w>in</w><w>contrast</w><w>to</w><w>quantitative</w><w>,</w><w>is</w><w>data</w><w>that</w><w>can</w><w>be</w><w>divided</w><w>into</w><w>groups</w><w>,</w><w>but</w><w>that</w><w>does</w><w>not</w><w>necessarily</w><w>have</w><w>a</w><w>numerical</w><w>aspect</w><w>to</w><w>it</w><pc>.</pc><w>For</w><w>example</w><w>,</w><w>while</w><w>your</w><w>height</w><w>is</w><w>numerical</w><w>,</w><w>your</w><w>hair</w><w>color</w><w>is</w><w>categorical</w><pc>.</pc><w>From</w><w>the</w><w>perspective</w><w>of</w><w>our</w><w>dataset</w><w>,</w><w>features</w><w>like</w><w>attacking</w><w>country</w><w>hold</w><w>categorical</w><w>data</w><w>,</w><w>while</w><w>features</w><w>like</w><w>the</w><w>weight</w><w>of</w><w>munitions</w><w>hold</w><w>quantitative</w><w>data</w><pc>.</pc></p><p><w>In</w><w>this</w><w>section</w><w>,</w><w>we</w><w>'ll</w><w>learn</w><w>how</w><w>to</w><w>use</w><w>categorical</w><w>data</w><w>as</w><w>our</w><w>x-axis</w><w>values</w><w>in</w><w>Bokeh</w><w>and</w><w>how</w><w>to</w><w>use</w><w>the</w><code rend="inline"><w>vbar</w></code><w>glyph</w><w>method</w><w>to</w><w>create</w><w>a</w><w>vertical</w><w>bar</w><w>chart</w><w>(</w><w>an</w><code rend="inline"><w>hbar</w></code><w>glyph</w><w>method</w><w>functions</w><w>similarly</w><w>to</w><w>create</w><w>a</w><w>horizontal</w><w>bar</w><w>chart</w><w>)</w><pc>.</pc><w>In</w><w>addition</w><w>,</w><w>we</w><w>'ll</w><w>learn</w><w>about</w><w>preparing</w><w>categorical</w><w>data</w><w>in</w><w>Pandas</w><w>by</w><w>grouping</w><w>data</w><pc>.</pc><w>Further</w><w>,</w><w>we</w><w>'ll</w><w>add</w><w>to</w><w>our</w><w>knowledge</w><w>of</w><w>Bokeh</w><w>styling</w><w>and</w><w>the</w><w>hover</w><w>tool</w><pc>.</pc></p><p><w>To</w><w>work</w><w>through</w><w>this</w><w>information</w><w>,</w><w>we</w><w>'ll</w><w>create</w><w>a</w><w>bar</w><w>chart</w><w>that</w><w>shows</w><w>the</w><w>total</w><w>tons</w><w>of</w><w>munitions</w><w>dropped</w><w>by</w><w>each</w><w>country</w><w>listed</w><w>in</w><w>our</w><w>csv</w><pc>.</pc></p><p><w>We</w><w>start</w><w>by</w><w>creating</w><w>a</w><w>new</w><w>file</w><w>called</w><code rend="inline"><w>munitions_by_country.py</w></code><w>and</w><w>adding</w><w>some</w><w>initial</w><w>code</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_25" corresp="code_visualizing-with-bokeh_25.txt" rend="block"/></ab><p><w>First</w><w>,</w><w>we</w><w>import</w><w>the</w><w>Pandas</w><w>library</w><w>and</w><w>the</w><w>basic</w><w>elements</w><w>from</w><w>Bokeh</w><w>(</w><w>i.e</w><pc>.</pc><code rend="inline"><w>figure</w></code><w>,</w><code rend="inline"><w>output_file</w></code><w>,</w><code rend="inline"><w>show</w></code><w>,</w><w>and</w><code rend="inline"><w>ColumnDataSource</w></code><w>)</w><pc>.</pc><w>We</w><w>also</w><w>make</w><w>two</w><w>new</w><w>imports</w><w>:</w><code rend="inline"><w>Spectral5</w></code><w>is</w><w>a</w><w>pre-made</w><w>five</w><w>color</w><w>pallette</w><w>,</w><w>one</w><w>of</w><w>Bokeh</w><w>'s</w><w>many</w><ref target="https://docs.bokeh.org/en/latest/docs/reference/palettes.html#bokeh-palettes"><w>pre-made</w><w>color</w><w>palettes</w></ref><w>,</w><w>and</w><code rend="inline"><w>factor_cmap</w></code><w>is</w><w>a</w><w>helper</w><w>method</w><w>for</w><w>mapping</w><w>colors</w><w>to</w><w>bars</w><w>in</w><w>a</w><w>bar-charts</w><pc>.</pc></p><p><w>After</w><w>the</w><w>imports</w><w>,</w><w>we</w><w>set</w><w>our</w><code rend="inline"><w>output_file</w></code><w>and</w><w>load</w><w>the</w><w>thor_wwii.csv</w><w>file</w><w>into</w><w>a</w><code rend="inline"><w>DataFrame</w></code><pc>.</pc></p><p><w>We</w><w>now</w><w>need</w><w>to</w><w>get</w><w>from</w><w>the</w><w>170,000+</w><w>records</w><w>of</w><w>individual</w><w>missions</w><w>to</w><w>one</w><w>record</w><w>per</w><w>attacking</w><w>country</w><w>with</w><w>the</w><w>total</w><w>munitions</w><w>dropped</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_26" corresp="code_visualizing-with-bokeh_26.txt" rend="block"/></ab><p><w>Pandas</w><w>lets</w><w>us</w><w>do</w><w>this</w><w>in</w><w>a</w><w>single</w><w>line</w><w>of</w><w>code</w><w>by</w><w>using</w><w>the</w><code rend="inline"><w>groupby</w></code><w>dataframe</w><w>method</w><pc>.</pc><w>This</w><w>method</w><w>accepts</w><w>a</w><w>column</w><w>by</w><w>which</w><w>to</w><w>group</w><w>the</w><w>data</w><w>and</w><w>one</w><w>or</w><w>more</w><w>aggregating</w><w>methods</w><w>that</w><w>tell</w><w>Pandas</w><w>how</w><w>to</w><w>group</w><w>the</w><w>data</w><w>together</w><pc>.</pc><w>The</w><w>output</w><w>is</w><w>a</w><w>new</w><w>dataframe</w><pc>.</pc></p><p><w>Let</w><w>'s</w><w>take</w><w>this</w><w>one</w><w>piece</w><w>at</w><w>a</w><w>time</w><pc>.</pc><w>The</w><code rend="inline"><w>groupby</w><w>(</w><w>'COUNTRY_FLYING_MISSION</w><w>'</w><w>)</w></code><w>sets</w><w>the</w><w>column</w><w>that</w><w>we</w><w>are</w><w>grouping</w><w>on</w><pc>.</pc><w>In</w><w>other</w><w>words</w><w>,</w><w>this</w><w>says</w><w>that</w><w>we</w><w>want</w><w>the</w><w>resulting</w><w>dataframe</w><w>to</w><w>have</w><w>one</w><w>row</w><w>per</w><w>unique</w><w>entry</w><w>in</w><w>the</w><w>column</w><code rend="inline"><w>COUNTRY_FLYING_MISSION</w></code><pc>.</pc><w>Since</w><w>we</w><w>do</w><w>n't</w><w>care</w><w>about</w><w>aggregating</w><w>all</w><w>19</w><w>columns</w><w>in</w><w>the</w><w>dataframe</w><w>,</w><w>we</w><w>choose</w><w>just</w><w>the</w><w>tons</w><w>of</w><w>munitions</w><w>columns</w><w>with</w><w>the</w><w>indexer</w><w>,</w><code rend="inline"><w>[</w><w>'TOTAL_TONS</w><w>'</w><w>,</w><w>'TONS_HE</w><w>'</w><w>,</w><w>'TONS_IC</w><w>'</w><w>,</w><w>'TONS_FRAG</w><w>'</w><w>]</w></code><pc>.</pc><w>Finally</w><w>,</w><w>we</w><w>use</w><w>the</w><code rend="inline"><w>sum</w></code><w>method</w><w>to</w><w>let</w><w>Pandas</w><w>know</w><w>how</w><w>to</w><w>aggregate</w><w>all</w><w>of</w><w>the</w><w>different</w><w>rows</w><pc>.</pc><w>Other</w><w>methods</w><w>also</w><w>exist</w><w>for</w><w>aggregating</w><w>,</w><w>such</w><w>as</w><code rend="inline"><w>count</w></code><w>,</w><code rend="inline"><w>mean</w></code><w>,</w><code rend="inline"><w>max</w></code><w>,</w><w>and</w><code rend="inline"><w>min</w></code><pc>.</pc></p><p><w>If</w><w>you</w><w>execute</w><code rend="inline"><w>print</w><w>(</w><w>grouped</w><w>)</w></code><w>,</w><w>you</w><w>'ll</w><w>see</w><w>that</w><w>Pandas</w><w>has</w><w>grouped</w><w>by</w><w>the</w><w>five</w><w>unique</w><w>countries</w><w>in</w><w>our</w><w>dataset</w><w>and</w><w>summed</w><w>the</w><w>total</w><w>tons</w><w>dropped</w><w>by</w><w>each</w><pc>.</pc><w>You</w><w>can</w><w>also</w><w>see</w><w>the</w><w>dataset</w><w>has</w><w>some</w><w>problems</w><w>:</w><w>South</w><w>Africa</w><w>and</w><w>New</w><w>Zealand</w><w>dropped</w><w>more</w><w>high</w><w>explosives</w><w>than</w><w>the</w><w>total</w><w>tons</w><w>column</w><pc>.</pc><w>Problems</w><w>like</w><w>this</w><w>are</w><w>typical</w><w>of</w><w>large</w><w>,</w><w>manually-created</w><w>datasets</w><w>and</w><w>this</w><w>is</w><w>a</w><w>great</w><w>reminder</w><w>why</w><w>is</w><w>so</w><w>important</w><w>to</w><w>explore</w><w>and</w><w>visualize</w><w>your</w><w>data</w><w>before</w><w>creating</w><w>research</w><w>results</w><pc>.</pc></p><ab><code xml:id="code_visualizing-with-bokeh_27" corresp="code_visualizing-with-bokeh_27.txt" rend="block"/></ab><p><w>To</w><w>plot</w><w>this</w><w>data</w><w>,</w><w>let</w><w>'s</w><w>convert</w><w>to</w><w>kilotons</w><w>by</w><w>dividing</w><w>by</w><w>1000</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_28" corresp="code_visualizing-with-bokeh_28.txt" rend="block"/></ab><p><w>This</w><w>is</w><w>a</w><w>convenience</w><w>that</w><w>we</w><w>'ll</w><w>continue</w><w>to</w><w>use</w><w>in</w><w>future</w><w>examples</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_29" corresp="code_visualizing-with-bokeh_29.txt" rend="block"/></ab><p><w>Now</w><w>,</w><w>we</w><w>need</w><w>to</w><w>make</w><w>a</w><code rend="inline"><w>ColumnDataSource</w></code><w>from</w><w>our</w><w>grouped</w><w>data</w><w>and</w><w>create</w><w>a</w><code rend="inline"><w>figure</w></code><pc>.</pc><w>Since</w><w>our</w><w>x-axis</w><w>will</w><w>list</w><w>the</w><w>five</w><w>countries</w><w>(</w><w>rather</w><w>than</w><w>numerical</w><w>data</w><w>)</w><w>we</w><w>need</w><w>to</w><w>tell</w><w>the</w><w>figure</w><w>how</w><w>to</w><w>handle</w><w>the</w><w>x-axis</w><pc>.</pc></p><p><w>To</w><w>do</w><w>this</w><w>,</w><w>we</w><w>create</w><w>a</w><w>list</w><w>of</w><w>countries</w><w>from</w><w>our</w><w>source</w><w>object</w><w>,</w><w>using</w><code rend="inline"><w>source.data</w></code><w>and</w><w>the</w><w>column</w><w>name</w><w>as</w><w>key</w><pc>.</pc><w>The</w><w>list</w><w>of</w><w>countries</w><w>is</w><w>then</w><w>passed</w><w>as</w><w>the</w><code rend="inline"><w>x_range</w></code><w>to</w><w>our</w><code rend="inline"><w>figure</w></code><w>constructor</w><pc>.</pc><w>Because</w><w>this</w><w>is</w><w>a</w><w>list</w><w>of</w><w>text</w><w>data</w><w>,</w><w>the</w><w>figure</w><w>knows</w><w>the</w><w>x-axis</w><w>is</w><w>categorical</w><w>and</w><w>it</w><w>also</w><w>knows</w><w>what</w><w>possible</w><w>values</w><w>our</w><w>x</w><w>range</w><w>can</w><w>take</w><w>(</w><w>i.e</w><pc>.</pc><w>AUSTRALIA</w><w>,</w><w>GREAT</w><w>BRITAIN</w><w>,</w><w>etc.</w><w>)</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_30" corresp="code_visualizing-with-bokeh_30.txt" rend="block"/></ab><p><w>Now</w><w>we</w><w>plot</w><w>our</w><w>data</w><w>as</w><w>individually</w><w>colored</w><w>bars</w><w>and</w><w>add</w><w>basic</w><w>labels</w><pc>.</pc><w>To</w><w>color</w><w>our</w><w>bars</w><w>we</w><w>use</w><w>the</w><code rend="inline"><w>factor_cmap</w></code><w>helper</w><w>function</w><pc>.</pc><w>This</w><w>creates</w><w>a</w><w>special</w><w>color</w><w>map</w><w>that</w><w>matches</w><w>an</w><w>individual</w><w>color</w><w>to</w><w>each</w><w>category</w><w>(</w><w>i.e</w><pc>.</pc><w>what</w><w>Bokeh</w><w>calls</w><w>a</w><emph><w>factor</w></emph><w>)</w><pc>.</pc><w>The</w><w>color</w><w>map</w><w>is</w><w>then</w><w>passed</w><w>as</w><w>the</w><w>color</w><w>argument</w><w>to</w><w>our</w><code rend="inline"><w>vbar</w></code><w>glyph</w><w>method</w><pc>.</pc></p><p><w>For</w><w>the</w><w>data</w><w>in</w><w>our</w><w>glyph</w><w>method</w><w>,</w><w>we</w><w>'re</w><w>passing</w><w>a</w><w>source</w><w>and</w><w>again</w><w>referencing</w><w>column</w><w>names</w><pc>.</pc><w>Instead</w><w>of</w><w>using</w><w>a</w><code rend="inline"><w>y</w></code><w>parameter</w><w>,</w><w>however</w><w>,</w><w>the</w><code rend="inline"><w>vbar</w></code><w>method</w><w>takes</w><w>a</w><code rend="inline"><w>top</w></code><w>parameter</w><pc>.</pc><w>A</w><code rend="inline"><w>bottom</w></code><w>parameter</w><w>can</w><w>equally</w><w>be</w><w>specified</w><w>,</w><w>but</w><w>if</w><w>left</w><w>out</w><w>,</w><w>its</w><w>default</w><w>value</w><w>is</w><w>0</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_31" corresp="code_visualizing-with-bokeh_31.txt" rend="block"/></ab><p><w>We</w><w>add</w><w>a</w><w>hover</w><w>tool</w><w>again</w><w>,</w><w>but</w><w>now</w><w>we</w><w>see</w><w>that</w><w>we</w><w>can</w><w>use</w><w>multiple</w><w>data</w><w>variables</w><w>in</w><w>a</w><w>single</w><w>line</w><w>and</w><w>add</w><w>in</w><w>our</w><w>own</w><w>text</w><w>so</w><w>the</w><w>hover</w><w>popup</w><w>will</w><w>list</w><w>the</w><w>kilotons</w><w>of</w><w>each</w><w>type</w><w>of</w><w>explosive</w><pc>.</pc><w>The</w><code rend="inline"><w>hover.mode</w></code><w>is</w><w>new</w><pc>.</pc><w>Three</w><w>modes</w><w>exist</w><w>for</w><w>the</w><w>hover</w><w>tool</w><w>:</w><code rend="inline"><w>mouse</w></code><w>,</w><code rend="inline"><w>vline</w></code><w>,</w><w>and</w><code rend="inline"><w>hline</w></code><pc>.</pc><w>These</w><w>tell</w><w>the</w><w>hover</w><w>tool</w><w>when</w><w>to</w><w>show</w><w>the</w><w>popup</w><pc>.</pc><code rend="inline"><w>mouse</w></code><w>is</w><w>the</w><w>default</w><w>value</w><w>and</w><w>shows</w><w>a</w><w>popup</w><w>when</w><w>directly</w><w>over</w><w>a</w><w>glyph</w><pc>.</pc><code rend="inline"><w>vline</w></code><w>and</w><code rend="inline"><w>hline</w></code><w>tell</w><w>the</w><w>popup</w><w>to</w><w>show</w><w>when</w><w>a</w><w>vertical</w><w>or</w><w>horizontal</w><w>line</w><w>crosses</w><w>a</w><w>glyph</w><pc>.</pc><w>With</w><code rend="inline"><w>vline</w></code><w>set</w><w>here</w><w>,</w><w>anytime</w><w>your</w><w>mouse</w><w>passes</w><w>through</w><w>an</w><w>imaginary</w><w>vertical</w><w>line</w><w>extending</w><w>from</w><w>each</w><w>bar</w><w>,</w><w>a</w><w>popup</w><w>will</w><w>show</w><pc>.</pc></p><figure><desc><w>A</w><w>Bar</w><w>Chart</w><w>with</w><w>Categorical</w><w>Data</w><w>and</w><w>Coloring</w></desc><graphic url="visualizing-with-bokeh-3.png"/></figure><p><w>{</w><w>%</w><w>include</w><w>alert.html</w><w>text=</w><w>''</w><w>If</w><w>you</w><w>have</w><w>a</w><w>chance</w><w>,</w><w>it</w><w>'s</w><w>worth</w><w>exploring</w><w>Bokeh</w><w>'s</w><ref target="https://docs.bokeh.org/en/latest/docs/reference/palettes.html#bokeh-palettes"><w>color</w><w>palettes</w></ref><pc>.</pc><w>In</w><w>the</w><w>above</w><w>example</w><w>,</w><w>try</w><w>rewriting</w><w>the</w><w>code</w><w>to</w><w>use</w><w>something</w><w>other</w><w>than</w><code rend="inline"><w>Spectral5</w></code><w>,</w><w>such</w><w>as</w><code rend="inline"><w>Inferno5</w></code><w>or</w><code rend="inline"><w>RdGy5</w></code><pc>.</pc><w>To</w><w>take</w><w>it</w><w>one</w><w>step</w><w>further</w><w>,</w><w>you</w><w>can</w><w>try</w><w>your</w><w>hand</w><w>at</w><w>using</w><w>built-in</w><w>palettes</w><w>in</w><w>any</w><w>example</w><w>that</w><w>uses</w><w>color</w><pc>.</pc><w>''</w><w>%</w><w>}</w></p></div><div type="2" n="7"><head><w>Stacked</w><w>Bar</w><w>Charts</w><w>and</w><w>Sub-sampling</w><w>Data</w><w>:</w><w>Types</w><w>of</w><w>Munitions</w><w>Dropped</w><w>by</w><w>Country</w></head><p><w>Because</w><w>the</w><w>previous</w><w>plot</w><w>shows</w><w>that</w><w>the</w><w>USA</w><w>and</w><w>Great</w><w>Britain</w><w>account</w><w>for</w><w>the</w><w>overwhelming</w><w>majority</w><w>of</w><w>bombings</w><w>,</w><w>we</w><w>now</w><w>focus</w><w>on</w><w>these</w><w>two</w><w>countries</w><w>and</w><w>learn</w><w>how</w><w>to</w><w>make</w><w>a</w><w>stacked</w><w>bar</w><w>chart</w><w>that</w><w>shows</w><w>the</w><w>types</w><w>of</w><w>munitions</w><w>each</w><w>country</w><w>used</w><pc>.</pc></p><p><w>We</w><w>'ll</w><w>start</w><w>a</w><w>new</w><w>file</w><w>called</w><code rend="inline"><w>munitions_by_country_stacked.py</w></code></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_32" corresp="code_visualizing-with-bokeh_32.txt" rend="block"/></ab><p><w>In</w><w>addition</w><w>to</w><w>our</w><w>standard</w><w>imports</w><w>,</w><w>this</w><w>time</w><w>we</w><w>use</w><w>a</w><w>three-color</w><w>Spectral</w><w>palette</w><w>,</w><w>one</w><w>color</w><w>for</w><w>each</w><w>type</w><w>of</w><w>explosive</w><w>(</w><w>High</w><w>Explosive</w><w>,</w><w>Incendiary</w><w>,</w><w>and</w><w>Fragmentation</w><w>)</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_33" corresp="code_visualizing-with-bokeh_33.txt" rend="block"/></ab><p><w>Since</w><w>the</w><w>x-axis</w><w>is</w><w>again</w><w>categorical</w><w>,</w><w>we</w><w>'ll</w><w>need</w><w>to</w><w>group</w><w>and</w><w>aggregate</w><w>our</w><w>data</w><pc>.</pc><w>This</w><w>time</w><w>,</w><w>though</w><w>,</w><w>we</w><w>need</w><w>to</w><w>exclude</w><w>any</w><w>records</w><w>hat</w><w>do</w><w>n't</w><w>have</w><w>a</w><w>COUNTRY_FLYING_MISSION</w><w>with</w><w>a</w><w>value</w><w>of</w><w>GREAT</w><w>BRITAIN</w><w>or</w><w>USA</w><pc>.</pc><w>To</w><w>do</w><w>that</w><w>,</w><w>we</w><w>filter</w><w>our</w><w>dataframe</w><pc>.</pc></p><p><w>For</w><w>each</w><w>row</w><w>in</w><code rend="inline"><w>df</w></code><w>,</w><w>the</w><code rend="inline"><w>isin</w></code><w>function</w><w>checks</w><w>whether</w><w>COUNTRY_FLYING_MISSION</w><w>has</w><w>a</w><w>value</w><w>of</w><w>USA</w><w>or</w><w>GREAT</w><w>BRITAIN</w><pc>.</pc><w>If</w><w>it</w><w>does</w><w>,</w><w>the</w><w>corresponding</w><w>value</w><w>in</w><w>the</w><w>variable</w><code rend="inline"><w>filter</w></code><w>is</w><code rend="inline"><w>True</w></code><w>and</w><w>if</w><w>not</w><w>the</w><w>value</w><w>is</w><code rend="inline"><w>False</w></code></p><p><w>When</w><w>applied</w><w>to</w><w>our</w><w>dataframe</w><w>via</w><code rend="inline"><w>df</w><w>[</w><w>filter</w><w>]</w></code><w>,</w><w>a</w><w>new</w><w>dataframe</w><w>is</w><w>created</w><w>in</w><w>which</w><w>rows</w><w>with</w><w>a</w><code rend="inline"><w>True</w></code><w>value</w><w>are</w><w>kept</w><w>and</w><w>rows</w><w>with</w><w>a</w><code rend="inline"><w>False</w></code><w>value</w><w>are</w><w>discarded</w><pc>.</pc><w>After</w><w>the</w><w>filter</w><w>has</w><w>been</w><w>applied</w><w>here</w><w>,</w><w>executing</w><code rend="inline"><w>df.shape</w></code><w>shows</w><w>that</w><w>125,526</w><w>rows</w><w>remain</w><w>of</w><w>an</w><w>original</w><w>178,281</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_34" corresp="code_visualizing-with-bokeh_34.txt" rend="block"/></ab><p><w>Now</w><w>that</w><w>we</w><w>have</w><w>reduced</w><w>the</w><w>dataframe</w><w>to</w><w>show</w><w>only</w><w>records</w><w>for</w><w>the</w><w>USA</w><w>and</w><w>Great</w><w>Britain</w><w>,</w><w>we</w><w>group</w><w>our</w><w>data</w><w>with</w><code rend="inline"><w>groupby</w></code><w>and</w><w>aggregate</w><w>the</w><w>three</w><w>columns</w><w>that</w><w>hold</w><w>bomb</w><w>types</w><w>with</w><code rend="inline"><w>sum</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_35" corresp="code_visualizing-with-bokeh_35.txt" rend="block"/></ab><p><w>As</w><w>in</w><w>the</w><w>previous</w><w>example</w><w>,</w><w>we</w><w>create</w><w>a</w><w>source</w><w>object</w><w>from</w><w>our</w><w>grouped</w><w>data</w><w>and</w><w>make</w><w>sure</w><w>our</w><w>figure</w><w>uses</w><w>categorical</w><w>data</w><w>for</w><w>the</w><w>x-axis</w><w>by</w><w>setting</w><w>the</w><code rend="inline"><w>x_range</w></code><w>to</w><w>the</w><w>list</w><w>of</w><w>countries</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_36" corresp="code_visualizing-with-bokeh_36.txt" rend="block"/></ab><p><w>To</w><w>create</w><w>the</w><w>stacked</w><w>bar</w><w>chart</w><w>,</w><w>we</w><w>call</w><w>the</w><code rend="inline"><w>vbar_stack</w></code><w>glyph</w><w>method</w><pc>.</pc><w>Rather</w><w>than</w><w>passing</w><w>a</w><w>single</w><w>column</w><w>name</w><w>to</w><w>a</w><code rend="inline"><w>y</w></code><w>parameter</w><w>,</w><w>we</w><w>instead</w><w>pass</w><w>a</w><w>list</w><w>of</w><w>column</w><w>names</w><w>as</w><code rend="inline"><w>stackers</w></code><pc>.</pc><w>The</w><w>order</w><w>of</w><w>this</w><w>list</w><w>determines</w><w>the</w><w>order</w><w>that</w><w>the</w><w>columns</w><w>will</w><w>be</w><w>stacked</w><w>from</w><w>bottom</w><w>to</w><w>top</w><w>(</w><w>after</w><w>you</w><w>'ve</w><w>worked</w><w>through</w><w>this</w><w>example</w><w>,</w><w>try</w><w>switching</w><w>the</w><w>column</w><w>order</w><w>to</w><w>see</w><w>what</w><w>happens</w><w>)</w><pc>.</pc><w>The</w><code rend="inline"><w>legend</w></code><w>argument</w><w>supplies</w><w>text</w><w>for</w><w>each</w><w>stacker</w><w>and</w><w>the</w><code rend="inline"><w>Spectral3</w></code><w>palette</w><w>provides</w><w>colors</w><w>for</w><w>each</w><w>stacker</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_37" corresp="code_visualizing-with-bokeh_37.txt" rend="block"/></ab><p><w>We</w><w>add</w><w>basic</w><w>styling</w><w>and</w><w>labeling</w><w>,</w><w>and</w><w>then</w><w>output</w><w>the</w><w>plot</w><pc>.</pc></p><figure><desc><w>A</w><w>Stacked</w><w>Bar</w><w>Chart</w><w>with</w><w>Categorical</w><w>Data</w><w>and</w><w>Coloring</w></desc><graphic url="visualizing-with-bokeh-4.png"/></figure></div><div type="2" n="8"><head><w>Time-Series</w><w>and</w><w>Annotations</w><w>:</w><w>Bombing</w><w>Operations</w><w>over</w><w>Time</w></head><p><w>Let</w><w>'s</w><w>now</w><w>explore</w><w>the</w><w>use</w><w>of</w><w>incendiary</w><w>and</w><w>fragmentation</w><w>explosive</w><w>a</w><w>little</w><w>more</w><w>by</w><w>seeing</w><w>if</w><w>there</w><w>'s</w><w>any</w><w>trend</w><w>in</w><w>their</w><w>use</w><w>over</w><w>time</w><w>versus</w><w>the</w><w>total</w><w>munitions</w><w>dropped</w><pc>.</pc><w>As</w><w>you</w><w>have</w><w>had</w><w>some</w><w>time</w><w>to</w><w>get</w><w>used</w><w>to</w><w>Bokeh</w><w>'s</w><w>syntax</w><w>,</w><w>let</w><w>'s</w><w>dive</w><w>right</w><w>in</w><w>with</w><w>a</w><w>full</w><w>code</w><w>example</w><w>in</w><w>a</w><w>new</w><w>file</w><w>named</w><code rend="inline"><w>my_first_timeseries.py</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_38" corresp="code_visualizing-with-bokeh_38.txt" rend="block"/></ab><p><w>Take</w><w>a</w><w>minute</w><w>to</w><w>seriously</w><w>look</w><w>through</w><w>this</w><w>code</w><w>and</w><w>see</w><w>what</w><w>you</w><w>recognize</w><pc>.</pc><w>Two</w><w>items</w><w>should</w><w>stand</w><w>out</w><w>as</w><w>new</w><pc>.</pc></p><p><w>First</w><w>,</w><w>the</w><w>statement</w><code rend="inline"><w>df</w><w>[</w><w>'MSNDATE</w><w>'</w><w>]</w><w>=</w><w>pd.to_datetime</w><w>(</w><w>df</w><w>[</w><w>'MSNDATE</w><w>'</w><w>]</w><w>,</w><w>format=</w><w>'</w><w>%</w><w>m/</w><w>%</w><w>d/</w><w>%</w><w>Y</w><w>'</w><w>)</w></code><w>makes</w><w>sure</w><w>our</w><w>MSNDATE</w><w>column</w><w>is</w><w>a</w><w>datetime</w><pc>.</pc><w>This</w><w>is</w><w>important</w><w>because</w><w>often</w><w>data</w><w>loaded</w><w>from</w><w>a</w><w>csv</w><w>file</w><w>will</w><w>not</w><w>be</w><w>properly</w><w>typed</w><w>as</w><w>datetime</w><pc>.</pc><w>Supplying</w><w>the</w><code rend="inline"><w>format</w></code><w>argument</w><w>is</w><w>not</w><w>required</w><w>,</w><w>but</w><w>doing</w><w>so</w><w>significantly</w><w>speeds</w><w>up</w><w>the</w><w>process</w><pc>.</pc></p><p><w>Second</w><w>,</w><w>we</w><w>pass</w><w>the</w><w>argument</w><code rend="inline"><w>x_axis_type='datetime</w><w>'</w></code><w>to</w><w>our</w><w>figure</w><w>constructor</w><w>to</w><w>tell</w><w>it</w><w>that</w><w>our</w><w>x</w><w>data</w><w>will</w><w>be</w><w>datetimes</w><pc>.</pc><w>Otherwise</w><w>,</w><w>Bokeh</w><w>works</w><w>seamlessly</w><w>with</w><w>time</w><w>data</w><w>just</w><w>like</w><w>any</w><w>other</w><w>type</w><w>of</w><w>numerical</w><w>data</w><pc>!</pc></p><p><w>Looking</w><w>at</w><w>the</w><w>output</w><w>,</w><w>though</w><w>,</w><w>you</w><w>might</w><w>notice</w><w>a</w><w>major</w><w>issue</w><pc>.</pc></p><figure><desc><w>A</w><w>Basic</w><w>Time-Series</w><w>Plot</w></desc><graphic url="visualizing-with-bokeh-5.png"/></figure><p><w>This</w><w>data</w><w>is</w><w>volatile</w><w>and</w><w>hard-to-read</w><w>because</w><w>it</w><w>is</w><w>too</w><w>fine-grained</w><w>for</w><w>our</w><w>needs</w><pc>.</pc><w>Having</w><w>daily</w><w>data</w><w>over</w><w>the</w><w>course</w><w>of</w><w>five</w><w>years</w><w>is</w><w>great</w><w>,</w><w>but</w><w>plotting</w><w>it</w><w>as</w><w>such</w><w>obscures</w><w>trends</w><w>in</w><w>the</w><w>data</w><pc>.</pc><w>To</w><w>successfully</w><w>plot</w><w>time-series</w><w>data</w><w>and</w><w>look</w><w>for</w><w>long-term</w><w>trends</w><w>,</w><w>we</w><w>need</w><w>a</w><w>way</w><w>to</w><w>change</w><w>the</w><w>time-scale</w><w>we</w><w>'re</w><w>looking</w><w>at</w><w>so</w><w>that</w><w>,</w><w>for</w><w>example</w><w>,</w><w>we</w><w>can</w><w>plot</w><w>data</w><w>summarized</w><w>by</w><w>weeks</w><w>,</w><w>months</w><w>,</w><w>or</w><w>years</w><pc>.</pc></p><p><w>Thankfully</w><w>,</w><w>Pandas</w><w>offers</w><w>a</w><w>quick</w><w>and</w><w>easy</w><w>way</w><w>to</w><w>do</w><w>this</w><pc>.</pc><w>By</w><w>modifying</w><w>a</w><w>single</w><w>line</w><w>of</w><w>code</w><w>in</w><w>the</w><w>above</w><w>example</w><w>,</w><w>we</w><w>can</w><emph><w>resample</w></emph><w>our</w><w>time-series</w><w>data</w><w>to</w><w>any</w><w>valid</w><w>unit</w><w>of</w><w>time</w><pc>.</pc></p><div type="3" n="8.1"><head><w>Resampling</w><w>Time-Series</w><w>Data</w></head><p><w>Resampling</w><w>time-series</w><w>data</w><w>can</w><w>involve</w><w>either</w><w>upsampling</w><w>(</w><w>creating</w><w>more</w><w>records</w><w>)</w><w>or</w><w>downsampling</w><w>(</w><w>creating</w><w>fewer</w><w>records</w><w>)</w><pc>.</pc><w>For</w><w>example</w><w>,</w><w>a</w><w>list</w><w>of</w><w>daily</w><w>temperatures</w><w>could</w><w>be</w><w>upsampled</w><w>to</w><w>a</w><w>list</w><w>of</w><w>hourly</w><w>temperatures</w><w>or</w><w>downsampled</w><w>to</w><w>a</w><w>list</w><w>of</w><w>weekly</w><w>temperatures</w><pc>.</pc><w>We</w><w>'ll</w><w>only</w><w>be</w><w>downsampling</w><w>in</w><w>this</w><w>tutorial</w><w>,</w><w>but</w><w>upsampling</w><w>is</w><w>very</w><w>useful</w><w>when</w><w>you</w><w>'re</w><w>trying</w><w>to</w><w>match</w><w>a</w><w>sporadically-measured</w><w>dataset</w><w>with</w><w>one</w><w>that</w><w>'s</w><w>more</w><w>periodically</w><w>measured</w><pc>.</pc></p><p><w>To</w><w>resample</w><w>our</w><w>data</w><w>,</w><w>we</w><w>use</w><w>a</w><w>Pandas</w><code rend="inline"><w>Grouper</w></code><w>object</w><w>,</w><w>to</w><w>which</w><w>we</w><w>pass</w><w>the</w><w>column</w><w>name</w><w>holding</w><w>our</w><w>datetimes</w><w>and</w><w>a</w><w>code</w><w>representing</w><w>the</w><w>desired</w><w>resampling</w><w>frequency</w><pc>.</pc><w>In</w><w>the</w><w>case</w><w>of</w><w>our</w><w>data</w><w>,</w><w>the</w><w>statement</w><code rend="inline"><w>pd.Grouper</w><w>(</w><w>key='MSNDATE</w><w>'</w><w>,</w><w>freq='M</w><w>'</w><w>)</w></code><w>will</w><w>be</w><w>used</w><w>to</w><w>resample</w><w>our</w><w>MSNDATE</w><w>column</w><w>by</w><emph><w>M</w></emph><w>onth</w><pc>.</pc><w>We</w><w>could</w><w>equally</w><w>resample</w><w>by</w><emph><w>W</w></emph><w>eek</w><w>,</w><emph><w>Y</w></emph><w>ear</w><w>,</w><emph><w>H</w></emph><w>our</w><w>,</w><w>and</w><ref target="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases"><w>so</w><w>forth</w></ref><pc>.</pc><w>These</w><w>frequency</w><w>designations</w><w>can</w><w>also</w><w>be</w><w>prefaced</w><w>with</w><w>numbers</w><w>so</w><w>that</w><w>,</w><w>for</w><w>example</w><w>,</w><code rend="inline"><w>freq='2W</w><w>'</w></code><w>resamples</w><w>at</w><w>two</w><w>week</w><w>intervals</w><pc>!</pc></p><p><w>To</w><w>complete</w><w>the</w><w>process</w><w>of</w><w>resampling</w><w>and</w><w>plotting</w><w>our</w><w>data</w><w>,</w><w>we</w><w>pass</w><w>the</w><w>above</w><code rend="inline"><w>Grouper</w></code><w>object</w><w>to</w><w>our</w><code rend="inline"><w>groupby</w></code><w>function</w><w>in</w><w>place</w><w>of</w><w>the</w><w>raw</w><w>column</w><w>name</w><pc>.</pc><w>The</w><code rend="inline"><w>groupby</w></code><w>statement</w><w>from</w><w>the</w><w>previous</w><w>code</w><w>example</w><w>should</w><w>now</w><w>look</w><w>like</w><w>this</w><w>:</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_39" corresp="code_visualizing-with-bokeh_39.txt" rend="block"/></ab><p><w>Rerunning</w><w>the</w><w>above</w><w>code</w><w>sample</w><w>will</w><w>produce</w><w>a</w><w>much</w><w>cleaner</w><w>plot</w><w>with</w><w>obvious</w><w>trends</w><pc>.</pc><w>The</w><w>plot</w><w>now</w><w>shows</w><w>four</w><w>points</w><w>of</w><w>interest</w><w>:</w></p><list type="unordered"><item><w>First</w><w>,</w><w>in</w><w>both</w><w>the</w><w>Spring</w><w>of</w><w>1944</w><w>and</w><w>1945</w><w>,</w><w>the</w><w>scale</w><w>of</w><w>Allied</w><w>bombing</w><w>operations</w><w>reached</w><w>greater</w><w>intensity</w><pc>.</pc></item><item><w>Second</w><w>,</w><w>there</w><w>is</w><w>a</w><w>smaller</w><w>spike</w><w>in</w><w>the</w><w>summer</w><w>of</w><w>1945</w><w>during</w><w>the</w><w>acceleration</w><w>of</w><w>bombings</w><w>against</w><w>the</w><w>Japanese</w><w>after</w><w>Germany</w><w>'s</w><w>surrender</w><pc>.</pc></item><item><w>Third</w><w>,</w><w>four</w><w>spikes</w><w>in</w><w>the</w><w>use</w><w>of</w><w>incendiary</w><w>weapons</w><w>appear</w><w>that</w><w>could</w><w>further</w><w>explored</w><pc>.</pc></item><item><w>Fourth</w><w>and</w><w>finally</w><w>,</w><w>there</w><w>are</w><w>a</w><w>few</w><w>small</w><w>spikes</w><w>in</w><w>the</w><w>use</w><w>of</w><w>fragmentation</w><w>bombs</w><w>,</w><w>the</w><w>use</w><w>of</w><w>which</w><w>then</w><w>effectively</w><w>stops</w><w>after</w><w>the</w><w>surrender</w><w>of</w><w>Germany</w><pc>.</pc></item></list><figure><desc><w>A</w><w>Time-Series</w><w>Plot</w><w>with</w><w>Data</w><w>Resampled</w><w>to</w><w>Months</w></desc><graphic url="visualizing-with-bokeh-6.png"/></figure></div><div type="3" n="8.2"><head><w>Annotating</w><w>Trends</w><w>in</w><w>Plots</w></head><p><w>Let</w><w>'s</w><w>look</w><w>more</w><w>closely</w><w>now</w><w>at</w><w>the</w><w>bombings</w><w>in</w><w>Europe</w><w>in</w><w>1944</w><w>and</w><w>1945</w><w>to</w><w>see</w><w>what</w><w>trends</w><w>there</w><w>are</w><w>with</w><w>fragmentation</w><w>and</w><w>incendiary</w><w>munitions</w><pc>.</pc><w>We</w><w>will</w><w>also</w><w>point</w><w>out</w><w>some</w><w>of</w><w>these</w><w>trends</w><w>in</w><w>our</w><w>plot</w><w>with</w><w>annotations</w><pc>.</pc><w>To</w><w>do</w><w>this</w><w>,</w><w>we</w><w>'ll</w><w>filter</w><w>our</w><w>dataset</w><w>so</w><w>that</w><w>we</w><w>work</w><w>only</w><w>with</w><w>bombings</w><w>in</w><w>the</w><w>European</w><w>Theater</w><w>of</w><w>Operations</w><w>(</w><w>ETO</w><w>)</w><w>,</w><w>resample</w><w>the</w><w>data</w><w>at</w><w>one-month</w><w>intervals</w><w>(</w><code rend="inline"><w>freq='M</w><w>'</w></code><w>)</w><w>,</w><w>and</w><w>then</w><w>plot</w><w>the</w><w>results</w><w>in</w><w>the</w><w>same</w><w>manner</w><w>as</w><w>before</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_40" corresp="code_visualizing-with-bokeh_40.txt" rend="block"/></ab><figure><desc><w>A</w><w>Time-Series</w><w>Plot</w><w>of</w><w>the</w><w>ETO</w><w>with</w><w>Data</w><w>Resampled</w><w>to</w><w>Months</w></desc><graphic url="visualizing-with-bokeh-7.png"/></figure><p><w>A</w><w>few</w><w>patterns</w><w>emerge</w><w>in</w><w>the</w><w>ETO</w><w>data</w><pc>.</pc><w>First</w><w>we</w><w>see</w><w>a</w><w>very</w><w>clear</w><w>escalation</w><w>of</w><w>overall</w><w>bombings</w><w>leading</w><w>up</w><w>to</w><w>June</w><w>6</w><w>,</w><w>1944</w><w>and</w><w>a</w><w>notable</w><w>dip</w><w>during</w><w>the</w><w>winter</w><w>of</w><w>1944/1945</w><pc>.</pc><w>Incendiary</w><w>munitions</w><w>show</w><w>three</w><w>spikes</w><w>and</w><w>confirm</w><w>that</w><w>the</w><w>fourth</w><w>spike</w><w>seen</w><w>in</w><w>the</w><w>preceding</w><w>example</w><w>was</w><w>directed</w><w>at</w><w>the</w><w>bombing</w><w>of</w><w>Japan</w><w>after</w><w>Germany</w><w>'s</w><w>surrender</w><pc>.</pc><w>The</w><w>pattern</w><w>of</w><w>fragmentation</w><w>bombs</w><w>is</w><w>harder</w><w>to</w><w>read</w><w>,</w><w>but</w><w>it</w><w>'s</w><w>now</w><w>clear</w><w>that</w><w>they</w><w>were</w><w>only</w><w>seriously</w><w>used</w><w>in</w><w>the</w><w>European</w><w>Theater</w><w>after</w><w>D-Day</w><pc>.</pc></p><p><w>{</w><w>%</w><w>include</w><w>alert.html</w><w>text=</w><w>''</w><w>Try</w><w>your</w><w>hand</w><w>at</w><w>resampling</w><w>this</w><w>data</w><w>using</w><w>any</w><w>of</w><ref target="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases"><w>Pandas</w><w>'</w><w>time</w><w>frequencies</w></ref><w>to</w><w>see</w><w>what</w><w>other</w><w>trends</w><w>might</w><w>emerge</w><pc>.</pc><w>Remember</w><w>,</w><w>you</w><w>can</w><w>preface</w><w>these</w><w>frequencies</w><w>with</w><w>numbers</w><w>as</w><w>well</w><w>(</w><w>e.g</w><pc>.</pc><w>if</w><w>you</w><w>were</w><w>working</w><w>with</w><w>historical</w><w>stock</w><w>market</w><w>data</w><w>,</w><w>2Q</w><w>would</w><w>give</w><w>you</w><w>bi-quarterly</w><w>data</w><pc>!</pc><w>)</w><w>''</w><w>%</w><w>}</w></p><p><w>Since</w><w>we</w><w>have</w><w>established</w><w>that</w><w>6</w><w>June</w><w>1944</w><w>and</w><w>the</w><w>winter</w><w>of</w><w>1944/1945</w><w>mark</w><w>changes</w><w>to</w><w>the</w><w>bombing</w><w>patterns</w><w>in</w><w>the</w><w>ETO</w><w>,</w><w>let</w><w>'s</w><w>highlight</w><w>these</w><w>trends</w><w>using</w><w>Bokeh</w><w>'s</w><w>annotation</w><w>features</w><pc>.</pc></p><p><w>To</w><w>do</w><w>this</w><w>,</w><w>we</w><w>'ll</w><w>create</w><w>a</w><code rend="inline"><w>BoxAnnotation</w></code><w>and</w><w>then</w><w>add</w><w>these</w><w>to</w><w>our</w><code rend="inline"><w>figure</w></code><w>before</w><w>showing</w><w>it</w><pc>.</pc><w>First</w><w>,</w><w>we</w><w>need</w><w>to</w><w>add</w><w>an</w><w>additional</w><w>import</w><w>statement</w><w>to</w><w>our</w><w>code</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_41" corresp="code_visualizing-with-bokeh_41.txt" rend="block"/></ab><p><w>To</w><w>create</w><w>the</w><w>box</w><w>,</w><w>we</w><w>first</w><w>need</w><w>to</w><w>determine</w><w>its</w><w>coordinates</w><pc>.</pc><w>Coordinates</w><w>for</w><w>Bokeh</w><w>annotations</w><w>can</w><w>be</w><w>either</w><w>absolute</w><w>(</w><w>i.e</w><pc>.</pc><w>positioned</w><w>using</w><w>screen</w><w>units</w><w>)</w><w>,</w><w>meaning</w><w>they</w><w>always</w><w>stay</w><w>in</w><w>one</w><w>place</w><w>,</w><w>or</w><w>they</w><w>can</w><w>be</w><w>positioned</w><w>in</w><w>relation</w><w>to</w><w>data</w><pc>.</pc><w>Our</w><w>annotations</w><w>will</w><w>all</w><w>be</w><w>positioned</w><w>using</w><w>data</w><w>coordinates</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_42" corresp="code_visualizing-with-bokeh_42.txt" rend="block"/></ab><p><w>The</w><w>left</w><w>of</w><w>the</w><w>box</w><w>will</w><w>be</w><w>6</w><w>June</w><w>1944</w><w>(</w><w>D-Day</w><w>)</w><w>and</w><w>for</w><w>the</w><w>right</w><w>of</w><w>the</w><w>box</w><w>we</w><w>'ll</w><w>choose</w><w>the</w><w>first</w><w>day</w><w>of</w><w>the</w><w>Battle</w><w>of</w><w>the</w><w>Bulge</w><w>:</w><w>16</w><w>December</w><w>1944</w><pc>.</pc><w>In</w><w>this</w><w>case</w><w>,</w><w>the</w><w>dates</w><w>follow</w><w>a</w><w>month-day-year</w><w>format</w><w>,</w><w>but</w><code rend="inline"><w>to_datetime</w></code><w>also</w><w>works</w><w>with</w><ref target="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.to_datetime.html"><w>day-first</w><w>and</w><w>year-first</w><w>formats</w></ref><pc>.</pc></p><p><w>We</w><w>pass</w><w>these</w><w>coordinates</w><w>to</w><w>the</w><code rend="inline"><w>BoxAnnotation</w></code><w>constructor</w><w>along</w><w>with</w><w>some</w><w>styling</w><w>arguments</w><pc>.</pc><w>Then</w><w>,</w><w>we</w><w>add</w><w>it</w><w>to</w><w>the</w><w>our</w><w>figure</w><w>using</w><w>the</w><code rend="inline"><w>add_layout</w><w>(</w><w>)</w></code><w>method</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_43" corresp="code_visualizing-with-bokeh_43.txt" rend="block"/></ab><figure><desc><w>A</w><w>Time-Series</w><w>Plot</w><w>of</w><w>the</w><w>ETO</w><w>with</w><w>Annotations</w><w>Added</w></desc><graphic url="visualizing-with-bokeh-8.png"/></figure><p><w>{</w><w>%</w><w>include</w><w>alert.html</w><w>text=</w><w>''</w><w>Try</w><w>to</w><w>create</w><w>a</w><w>similar</w><w>plot</w><w>for</w><w>the</w><w>Pacific</w><w>Theater</w><w>of</w><w>Operations</w><w>(</w><w>PTO</w><w>)</w><pc>.</pc><w>Annotate</w><w>the</w><w>invasion</w><w>of</w><w>Iwo</w><w>Jima</w><w>(</w><w>February</w><w>19</w><w>,</w><w>1945</w><w>)</w><w>and</w><w>Japan</w><w>'s</w><w>announcement</w><w>of</w><w>surrender</w><w>(</w><w>August</w><w>15</w><w>,</w><w>1945</w><w>)</w><pc>.</pc><w>''</w><w>%</w><w>}</w></p></div></div><div type="2" n="9"><head><w>Spatial</w><w>Data</w><w>:</w><w>Mapping</w><w>Target</w><w>Locations</w></head><p><w>In</w><w>this</w><w>final</w><w>part</w><w>of</w><w>the</w><w>lesson</w><w>we</w><w>'ll</w><w>look</w><w>at</w><w>the</w><w>spatial</w><w>components</w><w>of</w><w>fragmentation</w><w>bombs</w><pc>.</pc></p><p><w>Bokeh</w><w>provides</w><ref target="https://docs.bokeh.org/en/latest/docs/reference/tile_providers.html"><w>built-in</w><w>tile</w><w>providers</w></ref><w>that</w><w>render</w><w>base</w><w>maps</w><w>of</w><w>the</w><w>world</w><pc>.</pc><w>These</w><w>are</w><w>contained</w><w>in</w><w>the</w><code rend="inline"><w>bokeh.tile_providers</w></code><w>module</w><pc>.</pc><w>For</w><w>this</w><w>example</w><w>,</w><w>we</w><w>'ll</w><w>use</w><w>the</w><w>CartoDB</w><w>Tile</w><w>Service</w><w>(</w><w>CARTODBPOSITRON</w><w>)</w><pc>.</pc></p><p><w>We</w><w>'ll</w><w>also</w><w>be</w><w>using</w><w>functions</w><w>imported</w><w>from</w><w>the</w><code rend="inline"><w>pyproj</w></code><w>library</w><pc>.</pc><w>Since</w><w>our</w><w>coordinates</w><w>are</w><w>stored</w><w>as</w><w>latitude/longitude</w><w>,</w><w>we</w><w>'ll</w><w>define</w><w>a</w><w>custom</w><w>function</w><w>to</w><w>convert</w><w>them</w><w>before</w><w>mapping</w><pc>.</pc><w>Note</w><w>that</w><w>although</w><w>Bokeh</w><w>is</w><w>coordinate-system</w><w>neutral</w><w>,</w><w>it</w><w>uses</w><w>the</w><w>Web</w><w>Mercator</w><w>projection</w><w>for</w><w>mapping</w><w>,</w><w>a</w><w>standard</w><w>found</w><w>across</w><w>web</w><w>tile</w><w>providers</w><pc>.</pc><w>The</w><w>subject</w><w>of</w><w>coordinate</w><w>systems</w><w>and</w><w>projections</w><w>are</w><w>outside</w><w>the</w><w>scope</w><w>of</w><w>this</w><w>tutorial</w><w>,</w><w>but</w><w>the</w><w>interested</w><w>reader</w><w>will</w><w>find</w><w>many</w><w>useful</w><w>web</w><w>resources</w><w>on</w><w>these</w><w>topics</w><pc>.</pc></p><p><w>{</w><w>%</w><w>include</w><w>alert.html</w><w>text=</w><w>''</w><w>If</w><w>your</w><w>own</w><w>dataset</w><w>has</w><w>place</w><w>names</w><w>,</w><w>but</w><w>not</w><w>latitude</w><w>and</w><w>longitude</w><w>,</w><w>do</w><w>n't</w><w>worry</w><pc>!</pc><w>You</w><w>can</w><w>find</w><w>ways</w><w>to</w><w>easily</w><w>get</w><w>coordinates</w><w>from</w><w>place</w><w>names</w><w>in</w><w>Programming</w><w>Historian</w><w>'s</w><ref target="/lessons/geocoding-qgis"><w>Geocoding</w><w>Historical</w><w>Data</w><w>using</w><w>QGIS</w></ref><w>or</w><ref target="/lessons/mapping-with-python-leaflet#geocoding-with-python"><w>Web</w><w>Mapping</w><w>with</w><w>Python</w><w>and</w><w>Leaflet</w></ref><pc>.</pc><w>''</w><w>%</w><w>}</w></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_44" corresp="code_visualizing-with-bokeh_44.txt" rend="block"/></ab><p><w>The</w><w>boilerplate</w><w>imports</w><w>and</w><w>our</w><w>conversion</w><w>function</w><w>are</w><w>defined</w><pc>.</pc><w>Next</w><w>,</w><w>we</w><w>load</w><w>our</w><w>data</w><w>and</w><w>apply</w><w>our</w><w>conversion</w><w>function</w><w>to</w><w>create</w><w>new</w><w>E</w><w>and</w><w>N</w><w>columns</w><w>that</w><w>store</w><w>our</w><w>Web</w><w>Mercator</w><w>easting</w><w>and</w><w>northing</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_45" corresp="code_visualizing-with-bokeh_45.txt" rend="block"/></ab><p><w>Because</w><w>a</w><w>single</w><w>target</w><w>can</w><w>appear</w><w>in</w><w>multiple</w><w>records</w><w>,</w><w>we</w><w>need</w><w>to</w><w>group</w><w>the</w><w>data</w><w>by</w><w>E</w><w>and</w><w>N</w><w>to</w><w>get</w><w>unique</w><w>target</w><w>locations</w><pc>.</pc><w>Otherwise</w><w>,</w><w>we</w><w>would</w><w>map</w><w>the</w><w>same</w><w>target</w><w>every</w><w>time</w><w>it</w><w>appears</w><w>in</w><w>a</w><w>record</w><pc>.</pc></p><p><w>The</w><code rend="inline"><w>reset_index</w></code><w>function</w><w>applied</w><w>after</w><w>aggregating</w><w>is</w><w>new</w><w>here</w><pc>.</pc><w>By</w><w>default</w><w>,</w><w>when</w><w>Pandas</w><w>groups</w><w>these</w><w>two</w><w>columns</w><w>it</w><w>will</w><w>make</w><w>E</w><w>and</w><w>N</w><w>the</w><w>index</w><w>for</w><w>each</w><w>row</w><w>in</w><w>the</w><w>new</w><w>dataframe</w><pc>.</pc><w>Since</w><w>we</w><w>just</w><w>want</w><w>E</w><w>and</w><w>N</w><w>to</w><w>remain</w><w>as</w><w>normal</w><w>columns</w><w>for</w><w>mapping</w><w>,</w><w>we</w><w>call</w><code rend="inline"><w>reset_index</w></code><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_46" corresp="code_visualizing-with-bokeh_46.txt" rend="block"/></ab><p><w>To</w><w>set</w><w>bounds</w><w>for</w><w>our</w><w>map</w><w>,</w><w>we</w><w>'ll</w><w>set</w><w>a</w><w>minimum</w><w>and</w><w>maximum</w><w>value</w><w>for</w><w>our</w><w>plot</w><w>'s</w><code rend="inline"><w>x_range</w></code><w>and</w><code rend="inline"><w>y_range</w></code><pc>.</pc><w>We</w><w>use</w><w>the</w><code rend="inline"><w>Range1D</w></code><w>object</w><w>,</w><w>which</w><w>represents</w><w>bounded</w><w>1-dimensional</w><w>data</w><w>in</w><w>Bokeh</w><pc>.</pc></p><ab><code lang="language-python" xml:id="code_visualizing-with-bokeh_47" corresp="code_visualizing-with-bokeh_47.txt" rend="block"/></ab><p><w>Finally</w><w>,</w><w>we</w><w>call</w><code rend="inline"><w>add_tile</w></code><w>and</w><w>pass</w><w>the</w><w>tile</w><w>provider</w><w>we</w><w>imported</w><pc>.</pc><w>Then</w><w>,</w><w>we</w><w>use</w><w>glyph</w><w>methods</w><w>just</w><w>like</w><w>in</w><w>any</w><w>other</w><w>plot</w><pc>.</pc><w>Here</w><w>,</w><w>we</w><w>call</w><code rend="inline"><w>circle</w></code><w>and</w><w>pass</w><w>the</w><w>easting</w><w>and</w><w>northing</w><w>columns</w><w>as</w><w>our</w><w>x</w><w>and</w><w>y</w><w>data</w><pc>.</pc></p><figure><desc><w>A</w><w>Map</w><w>of</w><w>Target</w><w>Locations</w></desc><graphic url="visualizing-with-bokeh-9.png"/></figure><p><w>Having</w><w>plotted</w><w>which</w><w>targets</w><w>in</w><w>Europe</w><w>and</w><w>Asia</w><w>were</w><w>bombed</w><w>with</w><w>fragmentation</w><w>bombs</w><w>,</w><w>we</w><w>can</w><w>now</w><w>start</w><w>to</w><w>examine</w><w>patterns</w><w>of</w><w>destruction</w><w>with</w><w>greater</w><w>detail</w><pc>.</pc><w>In</w><w>the</w><w>above</w><w>code</w><w>,</w><w>we</w><w>also</w><w>summed</w><w>incendiary</w><w>bombs</w><pc>.</pc><w>Try</w><w>to</w><w>alter</w><w>the</w><w>code</w><w>to</w><w>create</w><w>a</w><w>map</w><w>of</w><w>these</w><w>targets</w><pc>.</pc></p></div><div type="2" n="10"><head><w>Bokeh</w><w>as</w><w>a</w><w>Visualization</w><w>Tool</w></head><p><w>Bokeh</w><w>'s</w><w>strength</w><w>as</w><w>a</w><w>visualization</w><w>tool</w><w>lies</w><w>in</w><w>its</w><w>ability</w><w>to</w><w>show</w><w>differing</w><w>types</w><w>of</w><w>data</w><w>in</w><w>an</w><w>interactive</w><w>and</w><w>web-friendly</w><w>manner</w><pc>.</pc><w>This</w><w>tutorial</w><w>has</w><w>only</w><w>scratched</w><w>the</w><w>surface</w><w>of</w><w>Bokeh</w><w>'s</w><w>capabilities</w><w>and</w><w>the</w><w>reader</w><w>is</w><w>encourage</w><w>to</w><w>delve</w><w>deeper</w><w>into</w><w>the</w><w>library</w><w>'s</w><w>workings</w><pc>.</pc><w>A</w><w>great</w><w>place</w><w>to</w><w>start</w><w>is</w><w>the</w><ref target="https://docs.bokeh.org/en/latest/docs/gallery.html"><w>Bokeh</w><w>gallery</w></ref><w>,</w><w>where</w><w>you</w><w>can</w><w>see</w><w>a</w><w>variety</w><w>of</w><w>visualizations</w><w>and</w><w>decide</w><w>how</w><w>you</w><w>might</w><w>apply</w><w>these</w><w>techniques</w><w>to</w><w>your</w><w>own</w><w>data</w><pc>.</pc><w>If</w><w>you</w><w>'re</w><w>more</w><w>inclined</w><w>to</w><w>dive</w><w>right</w><w>into</w><w>further</w><w>code</w><w>examples</w><w>,</w><w>Bokeh</w><w>'s</w><ref target="https://mybinder.org/v2/gh/bokeh/bokeh-notebooks/master?filepath=tutorial%2F00%20-%20Introduction%20and%20Setup.ipynb"><w>online</w><w>notebook</w></ref><w>is</w><w>an</w><w>excellent</w><w>place</w><w>to</w><w>start</w><pc>!</pc></p></div><div type="2" n="11"><head><w>Further</w><w>Resources</w></head><list type="unordered"><item><ref target="https://docs.bokeh.org/en/latest/docs/user_guide.html"><w>Bokeh</w><w>User</w><w>Guide</w></ref></item><item><ref target="https://docs.bokeh.org/en/latest/docs/gallery.html"><w>Bokeh</w><w>Gallery</w></ref></item><item><ref target="https://pandas.pydata.org/pandas-docs/stable/index.html"><w>Pandas</w><w>Documentation</w></ref></item><item><ref target="https://www.kdnuggets.com/2017/01/pandas-cheat-sheet.html"><w>Pandas</w><w>Cheat</w><w>Sheet</w></ref></item><item><ref target="https://www.kdnuggets.com/2017/03/bokeh-cheat-sheet.html"><w>Bokeh</w><w>Cheat</w><w>Sheet</w></ref></item></list><p><ref type="footnotemark" target="#en_note_1"/><w>:</w><w>David</w><w>Robinson</w><w>,</w><w>'Why</w><w>is</w><w>Python</w><w>Growing</w><w>so</w><w>Quickly</w><pc>?</pc><w>'</w><w>,</w><emph><w>Stack</w><w>Overflow</w><w>Blog</w></emph><w>,</w><w>14</w><w>September</w><w>2017</w><ref target="https://stackoverflow.blog/2017/09/14/python-growing-quickly/"><w>https</w><w>:</w><w>//stackoverflow.blog/2017/09/14/python-growing-quickly/</w></ref></p></div></body>
    </text>
</TEI>
