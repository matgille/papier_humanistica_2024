<TEI xmlns="http://www.tei-c.org/ns/1.0" xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="cleaning-ocrd-text-with-regular-expressions" type="original" xml:base="cleaning-ocrd-text-with-regular-expressions/cleaning-ocrd-text-with-regular-expressions/cleaning-ocrd-text-with-regular-expressions.xml">
    <teiHeader>
        <fileDesc>
            <titleStmt>
                <title>Cleaning OCR’d text with Regular Expressions</title>
                <author role="original_author">Laura Turner O'Hara</author>
                <editor role="editors">Fred Gibbs</editor>
            </titleStmt>
            <publicationStmt>
                <distributor>Programming Historian</distributor>
                <idno type="doi">10.46430/phen0024</idno>
                <date type="published">05/22/2013</date>
            </publicationStmt>
            <sourceDesc>
                <p>Born digital, in a markdown format. This lesson is original.</p>
            </sourceDesc>
        </fileDesc>
        <profileDesc>
            <abstract>
                <p>Optical Character Recognition (OCR)—the conversion of scanned images to machine-encoded text—has proven a godsend for historical research. This lesson will help you clean up OCR'd text to make it more usable.</p>
            </abstract>
            <textClass>
                <keywords>
                    <term xml:lang="en">data-manipulation</term>
                </keywords>
            </textClass>
        </profileDesc>
    </teiHeader>
    <text xml:lang="en">
        <body><div type="2" n="1"><head><s xml:id="s_8DovvJ"><w>Introduction</w></s></head><p><s xml:id="s_JOKzkE"><w>Optical</w><w>Character</w><w>Recognition</w><w>(</w><w>OCR</w><w>)</w><w>—the</w><w>conversion</w><w>of</w><w>scanned</w><w>images</w><w>to</w><w>machine-encoded</w><w>text—has</w><w>proven</w><w>a</w><w>godsend</w><w>for</w><w>historical</w><w>research</w><pc>.</pc></s><s xml:id="s_ngJ7KQ"><w>This</w><w>process</w><w>allows</w><w>texts</w><w>to</w><w>be</w><w>searchable</w><w>on</w><w>one</w><w>hand</w><w>and</w><w>more</w><w>easily</w><w>parsed</w><w>and</w><w>mined</w><w>on</w><w>the</w><w>other</w><pc>.</pc></s><s xml:id="s_JCC7Br"><w>But</w><w>we</w><w>’</w><w>ve</w><w>all</w><w>noticed</w><w>that</w><w>the</w><w>OCR</w><w>for</w><w>historic</w><w>texts</w><w>is</w><w>far</w><w>from</w><w>perfect</w><pc>.</pc></s><s xml:id="s_A69XpW"><w>Old</w><w>type</w><w>faces</w><w>and</w><w>formats</w><w>make</w><w>for</w><w>unique</w><w>OCR</w><pc>.</pc></s><s xml:id="s_hOc9nT"><w>Take</w><w>for</w><w>example</w><w>,</w><w>this</w><w>page</w><w>from</w><w>the</w><emph><w>Congressional</w><w>Directory</w></emph><w>from</w><w>the</w><w>50th</w><w>Congress</w><w>(</w><w>1887</w><w>)</w><pc>.</pc></s><s xml:id="s_HSa69q"><w>The</w><w>PDF</w><w>scan</w><w>downloaded</w><w>from</w><ref target="http://home.heinonline.org/"><w>HeinOnline</w></ref><w>looks</w><w>organized</w><w>:</w></s></p><figure><desc><s xml:id="s_47jB33"><w>This</w><w>is</w><w>a</w><w>screenshot</w><w>of</w><w>the</w><w>PDF</w><w>page</w><pc>.</pc></s></desc><graphic url="cd_pdf.png"/></figure><p><s xml:id="s_zDUJJ4"><w>However</w><w>,</w><w>the</w><w>OCR</w><w>layer</w><w>(</w><w>downloaded</w><w>as</w><w>a</w><w>text</w><w>file</w><w>*</w><w>)</w><w>shows</w><w>that</w><w>the</w><w>machine-encoded</w><w>text</w><w>is</w><w>not</w><w>nearly</w><w>as</w><w>neat</w><w>:</w></s></p><figure><desc><s xml:id="s_ymlhI3"><w>This</w><w>is</w><w>a</w><w>screenshot</w><w>of</w><w>the</w><w>OCR</w><pc>.</pc></s></desc><graphic url="cd_txt.png"/></figure><quote><p><s xml:id="s_sZbfwQ"><w>Note</w><w>:</w><w>If</w><w>you</w><w>do</w><w>not</w><w>have</w><w>the</w><w>option</w><w>to</w><w>download</w><w>a</w><w>text</w><w>file</w><w>,</w><w>you</w><w>can</w><w>use</w><w>the</w><ref target="http://www.unixuser.org/~euske/python/pdfminer/index.html"><w>pdfminer</w></ref><w>module</w><w>to</w><w>extract</w><w>text</w><w>from</w><w>the</w><w>pdf</w><pc>.</pc></s></p></quote><p><s xml:id="s_V8PHsL"><w>Since</w><w>I</w><w>want</w><w>to</w><w>use</w><w>this</w><w>to</w><w>map</w><w>the</w><w>Washington</w><w>residences</w><w>for</w><w>Members</w><w>of</w><w>these</w><w>late</w><w>19th-century</w><w>Congresses</w><w>,</w><w>how</w><w>might</w><w>I</w><w>make</w><w>this</w><w>data</w><w>more</w><w>useable</w><pc>?</pc></s></p><p><s xml:id="s_y0cOVF"><w>The</w><w>answer</w><w>is</w><w>Regular</w><w>Expressions</w><w>or</w><w>“</w><w>regex.</w><w>”</w><w>Here</w><w>’</w><w>s</w><w>what</w><w>regex</w><w>did</w><w>for</w><w>me</w><pc>.</pc></s><s xml:id="s_7l80Xl"><w>Though</w><w>this</w><w>is</w><w>not</w><w>a</w><w>“</w><w>real</w><w>”</w><w>CSV</w><w>file</w><w>(</w><w>the</w><w>commas</w><w>are</w><w>not</w><w>quite</w><w>right</w><w>)</w><w>,</w><w>it</w><w>can</w><w>be</w><w>easily</w><w>viewed</w><w>in</w><w>Excel</w><w>and</w><w>prepped</w><w>for</w><w>geocoding</w><pc>.</pc></s><s xml:id="s_urBGKg"><w>Much</w><w>better</w><w>than</w><w>the</w><w>text</w><w>file</w><w>from</w><w>above</w><w>,</w><w>right</w><pc>?</pc></s></p><ab><code lang="language-text" xml:id="code_cleaning-ocrd-text-with-regular-expressions_0" corresp="code_cleaning-ocrd-text-with-regular-expressions_0.txt" rend="block"/></ab></div><div type="2" n="2"><head><s xml:id="s_xzNFLU"><w>Regular</w><w>Expressions</w><w>(</w><w>Regex</w><w>)</w></s></head><p><s xml:id="s_vp2R3p"><w>Regex</w><w>is</w><w>not</w><w>a</w><w>programming</w><w>language</w><pc>.</pc></s><s xml:id="s_GocvvD"><w>Rather</w><w>it</w><w>follows</w><w>a</w><w>syntax</w><w>used</w><w>in</w><w>many</w><w>different</w><w>languages</w><w>,</w><w>employing</w><w>a</w><w>series</w><w>of</w><w>characters</w><w>to</w><w>find</w><w>and/or</w><w>replace</w><w>precise</w><w>patterns</w><w>in</w><w>texts</w><pc>.</pc></s><s xml:id="s_69W8N6"><w>For</w><w>example</w><w>,</w><w>using</w><w>this</w><w>sample</w><w>text</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_1" corresp="code_cleaning-ocrd-text-with-regular-expressions_1.txt" rend="block"/></ab><p><s xml:id="s_nlWpeo"><w>1</w><pc>.</pc></s><s xml:id="s_pn5HNH"><w>You</w><w>could</w><w>isolate</w><w>all</w><w>the</w><w>capital</w><w>letters</w><w>(</w><w>L</w><w>,</w><w>O</w><w>,</w><w>C</w><w>,</w><w>R</w><w>,</w><w>G</w><w>)</w><w>with</w><w>this</w><w>regex</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_2" corresp="code_cleaning-ocrd-text-with-regular-expressions_2.txt" rend="block"/></ab><p><s xml:id="s_XjGm2L"><w>2</w><pc>.</pc></s><s xml:id="s_HF26jf"><w>You</w><w>could</w><w>isolate</w><w>the</w><w>first</w><w>capital</w><w>letter</w><w>(</w><w>L</w><w>)</w><w>with</w><w>this</w><w>regex</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_3" corresp="code_cleaning-ocrd-text-with-regular-expressions_3.txt" rend="block"/></ab><p><s xml:id="s_MaHDv6"><w>3</w><pc>.</pc></s><s xml:id="s_uqyuYi"><w>You</w><w>could</w><w>isolate</w><w>all</w><w>characters</w><w>BUT</w><w>the</w><w>capital</w><w>letters</w><w>with</w><w>this</w><w>regex</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_4" corresp="code_cleaning-ocrd-text-with-regular-expressions_4.txt" rend="block"/></ab><p><s xml:id="s_Na8J3C"><w>4</w><pc>.</pc></s><s xml:id="s_yB3sYg"><w>You</w><w>could</w><w>isolate</w><w>the</w><w>acronym</w><w>“</w><w>OCR</w><w>”</w><w>with</w><w>this</w><w>regex</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_5" corresp="code_cleaning-ocrd-text-with-regular-expressions_5.txt" rend="block"/></ab><p><s xml:id="s_ryM7US"><w>5</w><pc>.</pc></s><s xml:id="s_BmJDo4"><w>You</w><w>could</w><w>isolate</w><w>the</w><w>punctuation</w><w>using</w><w>this</w><w>regex</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_6" corresp="code_cleaning-ocrd-text-with-regular-expressions_6.txt" rend="block"/></ab><p><s xml:id="s_UvCN1f"><w>6</w><pc>.</pc></s><s xml:id="s_kQDmbv"><w>You</w><w>could</w><w>isolate</w><w>all</w><w>the</w><w>punctuation</w><w>,</w><w>spaces</w><w>,</w><w>and</w><w>numbers</w><w>this</w><w>way</w><w>:</w></s></p><ab><code xml:id="code_cleaning-ocrd-text-with-regular-expressions_7" corresp="code_cleaning-ocrd-text-with-regular-expressions_7.txt" rend="block"/></ab><p><s xml:id="s_tiQfWa"><w>The</w><w>character</w><w>set</w><w>is</w><w>not</w><w>that</w><w>large</w><w>,</w><w>but</w><w>the</w><w>patterns</w><w>can</w><w>get</w><w>complicated</w><pc>.</pc></s><s xml:id="s_jODoR5"><w>Moreover</w><w>,</w><w>different</w><w>characters</w><w>can</w><w>mean</w><w>different</w><w>things</w><w>depending</w><w>on</w><w>their</w><w>placement</w><pc>.</pc></s><s xml:id="s_hHis53"><w>Take</w><w>for</w><w>example</w><w>,</w><w>the</w><w>difference</w><w>between</w><w>example</w><w>2</w><w>and</w><w>example</w><w>3</w><w>above</w><pc>.</pc></s><s xml:id="s_Jv9dSC"><w>In</w><w>example</w><w>2</w><w>,</w><w>the</w><w>caret</w><w>(</w><w>^</w><w>)</w><w>means</w><w>isolate</w><w>the</w><w>pattern</w><w>at</w><w>the</w><w>beginning</w><w>of</w><w>the</w><w>line</w><w>or</w><w>document</w><pc>.</pc></s><s xml:id="s_EhwKm3"><w>However</w><w>,</w><w>when</w><w>you</w><w>put</w><w>the</w><w>caret</w><w>inside</w><w>the</w><w>character</w><w>class</w><w>(</w><w>demarcated</w><w>by</w><code rend="inline"><w>[</w><w>]</w></code><w>)</w><w>it</w><w>means</w><w>“</w><w>except</w><w>”</w><w>these</w><w>sets</w><w>of</w><w>characters</w><pc>.</pc></s></p><p><s xml:id="s_xB792V"><w>The</w><w>best</w><w>way</w><w>to</w><w>understand</w><w>Regular</w><w>Expressions</w><w>is</w><w>to</w><w>learn</w><w>what</w><w>the</w><w>characters</w><w>do</w><w>in</w><w>different</w><w>positions</w><w>and</w><w>practice</w><w>,</w><w>practice</w><w>,</w><w>practice</w><pc>.</pc></s><s xml:id="s_ZThIZ8"><w>And</w><w>since</w><w>experimentation</w><w>is</w><w>the</w><w>best</w><w>way</w><w>to</w><w>learn</w><w>,</w><w>I</w><w>suggest</w><w>using</w><w>a</w><w>regex</w><w>tester</w><w>tool</w><w>and</w><w>experimenting</w><w>with</w><w>the</w><w>syntax</w><pc>.</pc></s><s xml:id="s_7XpbnR"><w>A</w><w>free</w><w>option</w><w>is</w><ref target="https://pythonium.net/regex"><w>Pythonium</w><w>’</w><w>s</w><w>Pyrexp</w></ref><pc>.</pc></s><s xml:id="s_G5Ln1V"><w>For</w><w>Mac</w><w>users</w><w>,</w><w>I</w><w>had</w><w>a</w><w>lot</w><w>of</w><w>luck</w><w>with</w><w>the</w><ref target="http://krillapps.com/patterns/"><w>Patterns</w><w>App</w></ref><w>(</w><w>Mac</w><w>Store</w><w>$</w><w>2.99</w><w>)</w><w>,</w><w>which</w><w>allowed</w><w>me</w><w>to</w><w>see</w><w>what</w><w>the</w><w>regular</w><w>expressions</w><w>were</w><w>doing</w><w>in</w><w>real</w><w>time</w><pc>.</pc></s><s xml:id="s_qj9LBG"><w>It</w><w>also</w><w>comes</w><w>with</w><w>a</w><w>built-in</w><w>cheat</w><w>sheet</w><w>for</w><w>the</w><w>symbols</w><w>,</w><w>but</w><w>I</w><w>actually</w><w>found</w><w>this</w><w>generic</w><w>(</w><w>meaning</w><w>it</w><w>works</w><w>across</w><w>languages</w><w>)</w><ref target="https://cheatography.com/davechild/cheat-sheets/regular-expressions/"><w>cheat</w><w>sheet</w></ref><w>more</w><w>comprehensive</w><pc>.</pc></s></p></div><div type="2" n="3"><head><s xml:id="s_lhnswE"><w>Python</w><w>and</w><w>Regex</w></s></head><p><s xml:id="s_bzJl1G"><w>In</w><w>this</w><w>tutorial</w><w>,</w><w>I</w><w>use</w><w>the</w><w>Regular</w><w>Expressions</w><w>Python</w><w>module</w><w>to</w><w>extract</w><w>a</w><w>“</w><w>cleaner</w><w>”</w><w>version</w><w>of</w><w>the</w><emph><w>Congressional</w><w>Directory</w></emph><w>text</w><w>file</w><pc>.</pc></s><s xml:id="s_ifVZvJ"><w>Though</w><w>the</w><ref target="http://docs.python.org/2/library/re.html"><w>documentation</w></ref><w>for</w><w>this</w><w>module</w><w>is</w><w>fairly</w><w>comprehensive</w><w>,</w><w>beginners</w><w>will</w><w>have</w><w>more</w><w>luck</w><w>with</w><w>the</w><w>simpler</w><ref target="http://docs.python.org/2/howto/regex.html#regex-howto"><w>Regular</w><w>Expression</w><w>HOWTO</w><w>documentation</w></ref><pc>.</pc></s></p><div type="3" n="3.1"><head><s xml:id="s_YuFhPZ"><w>Two</w><w>things</w><w>to</w><w>note</w><w>before</w><w>you</w><w>get</w><w>started</w></s></head><list type="unordered"><item><s xml:id="s_Qez9NT"><w>From</w><w>what</w><w>I</w><w>’</w><w>ve</w><w>observed</w><w>,</w><w>Python</w><w>is</w><emph><w>not</w></emph><w>the</w><w>most</w><w>efficient</w><w>way</w><w>to</w><w>use</w><w>Regular</w><w>Expressions</w><w>if</w><w>you</w><w>have</w><w>to</w><w>clean</w><w>a</w><w>single</w><w>document</w><pc>.</pc></s><s xml:id="s_K5YV2G"><w>Command</w><w>Line</w><w>programs</w><w>like</w><ref target="http://www.gnu.org/software/sed/"><w>sed</w></ref><w>or</w><ref target="http://www.gnu.org/software/grep/"><w>grep</w></ref><w>appear</w><w>to</w><w>be</w><w>more</w><w>efficient</w><w>for</w><w>this</w><w>process</w><pc>.</pc></s><s xml:id="s_y09KXC"><w>(</w><w>I</w><w>will</w><w>leave</w><w>it</w><w>to</w><w>the</w><w>better</w><w>grep/sed</w><w>users</w><w>to</w><w>create</w><w>tutorials</w><w>on</w><w>those</w><w>tools</w><pc>.</pc></s><s xml:id="s_gyajRP"><w>)</w><w>I</w><w>use</w><w>Python</w><w>for</w><w>several</w><w>reasons</w><w>:</w><w>1</w><w>)</w><w>I</w><w>understand</w><w>the</w><w>syntax</w><w>best</w><w>;</w><w>2</w><w>)</w><w>I</w><w>appreciate</w><w>seeing</w><w>each</w><w>step</w><w>written</w><w>out</w><w>in</w><w>a</w><w>single</w><w>file</w><w>so</w><w>I</w><w>can</w><w>easily</w><w>backtrack</w><w>mistakes</w><w>;</w><w>and</w><w>3</w><w>)</w><w>I</w><w>want</w><w>a</w><w>program</w><w>I</w><w>could</w><w>use</w><w>over</w><w>and</w><w>over</w><w>again</w><w>,</w><w>since</w><w>I</w><w>am</w><w>cleaning</w><w>multiple</w><w>pages</w><w>from</w><w>the</w><emph><w>Congressional</w><w>Directory</w></emph><pc>.</pc></s></item><item><s xml:id="s_O68cLc"><w>The</w><w>OCR</w><w>in</w><w>this</w><w>document</w><w>is</w><w>far</w><w>from</w><w>consistent</w><w>(</w><w>within</w><w>a</w><w>single</w><w>page</w><w>or</w><w>across</w><w>multiple</w><w>pages</w><w>)</w><pc>.</pc></s><s xml:id="s_IKSNSn"><w>Thus</w><w>,</w><w>the</w><w>results</w><w>of</w><w>this</w><w>cleaning</w><w>tutorial</w><w>are</w><w>not</w><w>perfect</w><pc>.</pc></s><hi rend="bold"><s xml:id="s_iIheEF"><w>My</w><w>goal</w><w>is</w><w>to</w><w>let</w><w>regex</w><w>do</w><w>the</w><w>heavy</w><w>lifting</w><w>and</w><w>export</w><w>a</w><w>document</w><w>in</w><w>my</w><w>chosen</w><w>format</w><w>that</w><w>is</w><emph><w>more</w></emph><w>organized</w><w>than</w><w>the</w><w>document</w><w>with</w><w>which</w><w>I</w><w>started</w><pc>.</pc></s></hi><s xml:id="s_0yuWRE"><w>This</w><w>significantly</w><w>reduces</w><w>,</w><w>but</w><w>does</w><w>not</w><w>eliminate</w><w>,</w><w>any</w><w>hand-cleaning</w><w>I</w><w>might</w><w>need</w><w>to</w><w>do</w><w>before</w><w>geocoding</w><w>the</w><w>address</w><w>data</w><pc>.</pc></s></item></list></div><div type="3" n="3.2"><head><s xml:id="s_FaR8Wv"><w>My</w><w>example</w><w>Python</w><w>File</w></s></head><p><s xml:id="s_1NsEHD"><w>Here</w><w>’</w><w>s</w><w>the</w><w>Python</w><w>file</w><w>that</w><w>I</w><w>used</w><w>to</w><w>created</w><w>to</w><w>clean</w><w>my</w><w>document</w><w>:</w></s></p><ab><code lang="language-python" xml:id="code_cleaning-ocrd-text-with-regular-expressions_8" corresp="code_cleaning-ocrd-text-with-regular-expressions_8.txt" rend="block"/></ab><p><s xml:id="s_TNmX23"><w>I</w><w>’</w><w>ve</w><w>commented</w><w>it</w><w>pretty</w><w>extensively</w><w>,</w><w>so</w><w>I</w><w>will</w><w>explain</w><w>why</w><w>I</w><w>structured</w><w>the</w><w>code</w><w>the</w><w>way</w><w>I</w><w>did</w><pc>.</pc></s><s xml:id="s_KQphHp"><w>I</w><w>will</w><w>also</w><w>demonstrate</w><w>a</w><w>different</w><w>way</w><w>to</w><w>format</w><w>long</w><w>regular</w><w>expressions</w><w>for</w><w>better</w><w>legibility</w><pc>.</pc></s></p><list type="unordered"><item><s xml:id="s_ctR6Le"><w>–</w><w>Notice</w><w>in</w><w>my</w><w>original</w><w>text</w><w>file</w><w>that</w><w>my</w><w>data</w><w>is</w><w>all</w><w>on</w><w>lines</w><w>with</w><w>multiple</w><w>dashes</w><pc>.</pc></s><hi rend="bold"><s xml:id="s_kKM4mL"><w>Lines</w><w>16-22</w></s></hi><s xml:id="s_qZJ1t4"><w>This</w><w>code</w><w>effectively</w><w>isolates</w><w>those</w><w>lines</w><pc>.</pc></s><s xml:id="s_HdsyG1"><w>I</w><w>use</w><w>the</w><ref target="http://docs.python.org/2/library/re.html#re.search"><w>re.search</w><w>(</w><w>)</w></ref><w>function</w><w>to</w><w>find</w><w>all</w><w>lines</w><w>with</w><w>multiple</w><w>dashes</w><pc>.</pc></s><s xml:id="s_Ed0LsQ"><w>The</w><w>“</w><w>if</w><w>”</w><w>statement</w><w>on</w><w>line</w><w>20</w><w>only</w><w>works</w><w>with</w><w>the</w><w>lines</w><w>with</w><w>dashes</w><w>in</w><w>the</w><w>rest</w><w>of</w><w>the</w><w>code</w><pc>.</pc></s><s xml:id="s_WXupDZ"><w>(</w><w>This</w><w>eliminates</w><w>all</w><w>introductory</w><w>text</w><w>and</w><w>the</w><w>rows</w><w>of</w><w>page</w><w>numbers</w><w>that</w><w>follow</w><w>the</w><w>data</w><w>I</w><w>want</w><pc>.</pc></s><s xml:id="s_owCdeY"><w>)</w></s></item><item><s xml:id="s_C7wOOH"><w>–</w><w>This</w><w>is</w><w>the</w><w>long</w><w>process</w><w>by</w><w>which</w><w>I</w><w>eliminate</w><w>all</w><w>of</w><w>the</w><w>extraneous</w><w>punctuation</w><w>and</w><w>put</w><w>the</w><w>pieces</w><w>of</w><w>my</w><w>data</w><w>(</w><w>last</w><w>name</w><w>,</w><w>first</w><w>name</w><w>,</w><w>home</w><w>post</w><w>office</w><w>,</w><w>washington</w><w>address</w><w>)</w><w>into</w><w>different</w><w>fields</w><w>for</w><w>a</w><w>csv</w><w>document</w><pc>.</pc></s><hi rend="bold"><s xml:id="s_9sK8RK"><w>Lines</w><w>23-40</w></s></hi><s xml:id="s_xCSEjF"><w>I</w><w>use</w><w>the</w><ref target="http://docs.python.org/2/library/re.html#re.sub"><w>re.sub</w><w>(</w><w>)</w></ref><w>function</w><w>,</w><w>which</w><w>substitutes</w><w>pattern</w><w>with</w><w>another</w><w>character</w><pc>.</pc></s><s xml:id="s_EwHmhL"><w>I</w><w>comment</w><w>extensively</w><w>here</w><w>,</w><w>so</w><w>you</w><w>can</w><w>see</w><w>what</w><w>each</w><w>piece</w><w>does</w><pc>.</pc></s><s xml:id="s_zLdGv5"><w>This</w><w>may</w><w>not</w><w>be</w><w>the</w><w>most</w><w>efficient</w><w>way</w><w>of</w><w>doing</w><w>this</w><w>,</w><w>but</w><w>by</w><w>doing</w><w>this</w><w>piece</w><w>by</w><w>piece</w><w>,</w><w>I</w><w>could</w><w>check</w><w>my</w><w>work</w><w>as</w><w>I</w><w>went</w><pc>.</pc></s><s xml:id="s_qqtd7H"><w>As</w><w>I</w><w>built</w><w>loop</w><w>,</w><w>I</w><w>checked</w><w>each</w><w>step</w><w>by</w><w>printing</w><w>the</w><w>variable</w><w>in</w><w>the</w><w>command</w><w>line</w><pc>.</pc></s><s xml:id="s_Prjfy6"><w>So</w><w>,</w><w>for</w><w>example</w><w>,</w><w>after</w><w>line</w><w>24</w><w>(</w><w>when</w><w>I</w><w>eliminate</w><w>the</w><w>dashes</w><w>)</w><w>,</w><w>I</w><w>would</w><w>add</w><w>“</w><w>print</w><w>nodash</w><w>”</w><w>(</w><w>inside</w><w>the</w><w>if</w><w>loop</w><w>)</w><w>before</w><w>I</w><w>ran</w><w>the</w><w>file</w><w>in</w><w>the</w><w>command</w><w>line</w><pc>.</pc></s><s xml:id="s_FZKrUs"><w>I</w><w>checked</w><w>each</w><w>step</w><w>to</w><w>make</w><w>sure</w><w>my</w><w>patterns</w><w>were</w><w>only</w><w>changing</w><w>the</w><w>things</w><w>I</w><w>wanted</w><w>and</w><w>not</w><w>changing</w><w>things</w><w>I</w><w>did</w><emph><w>not</w></emph><w>want</w><w>changed</w><pc>.</pc></s></item><item><s xml:id="s_o6WNIZ"><w>-</w><w>I</w><w>used</w><w>a</w><w>slightly</w><w>different</w><w>method</w><w>here</w><pc>.</pc></s><hi rend="bold"><s xml:id="s_xABM8a"><w>Lines</w><w>41-46</w></s></hi><s xml:id="s_iDEHJ9"><w>The</w><w>OCR</w><w>in</w><w>the</w><w>text</w><w>file</w><w>separated</w><w>some</w><w>names</w><w>with</w><w>a</w><w>period</w><w>(</w><w>for</w><w>example</w><w>,</w><w>Chace.Jonathan</w><w>vs</w><pc>.</pc></s><s xml:id="s_2YYWbE"><w>Chase</w><w>,</w><w>Jonathan</w><w>)</w><pc>.</pc></s><s xml:id="s_xj0UdR"><w>I</w><w>wanted</w><w>to</w><w>isolate</w><w>the</w><w>periods</w><w>that</w><w>came</w><w>up</w><w>in</w><w>this</w><w>pattern</w><w>and</w><w>change</w><w>those</w><w>periods</w><w>to</w><w>commas</w><pc>.</pc></s><s xml:id="s_b5ydNd"><w>So</w><w>I</w><w>searched</w><w>for</w><w>the</w><w>pattern</w><code rend="inline"><w>^</w><w>(</w><w>[</w><w>A-Z</w><w>]</w><w>[</w><w>a-z</w><w>]</w><w>+\</w><pc>.</pc><w>)</w></code><w>,</w><w>which</w><w>looks</w><w>at</w><w>the</w><w>beginning</w><w>of</w><w>a</w><w>line</w><w>(</w><w>^</w><w>)</w><w>and</w><w>finds</w><w>a</w><w>pattern</w><w>with</w><w>one</w><w>capital</w><w>letter</w><w>,</w><w>multiple</w><w>lowercase</w><w>letters</w><w>and</w><w>a</w><w>period</w><pc>.</pc></s><s xml:id="s_XcSmQc"><w>After</w><w>I</w><w>had</w><w>isolated</w><w>that</w><w>pattern</w><w>,</w><w>I</w><w>substitute</w><w>the</w><w>period</w><w>those</w><w>lines</w><w>that</w><w>fit</w><w>the</w><w>pattern</w><w>with</w><w>a</w><w>comma</w><pc>.</pc></s></item></list></div><div type="3" n="3.3"><head><s xml:id="s_sw57Ca"><w>Using</w><w>Verbose</w><w>Mode</w></s></head><p><s xml:id="s_Un7duZ"><w>Most</w><w>regular</w><w>expressions</w><w>are</w><w>difficult</w><w>to</w><w>read</w><pc>.</pc></s><s xml:id="s_aBCVHB"><w>But</w><w>lines</w><w>39</w><w>and</w><w>40</w><w>look</w><emph><w>especially</w></emph><w>bad</w><pc>.</pc></s><s xml:id="s_SOh8rf"><w>How</w><w>might</w><w>you</w><w>clarify</w><w>these</w><w>patterns</w><w>for</w><w>people</w><w>who</w><w>might</w><w>look</w><w>at</w><w>your</w><w>code</w><w>(</w><w>or</w><w>for</w><w>yourself</w><w>when</w><w>you</w><w>are</w><w>staring</w><w>at</w><w>them</w><w>at</w><w>2:00</w><w>AM</w><w>someday</w><w>)</w><pc>?</pc></s><s xml:id="s_wZ2XMv"><w>You</w><w>can</w><w>use</w><w>the</w><w>module</w><w>’</w><w>s</w><ref target="http://docs.python.org/2/library/re.html#re.VERBOSE"><w>verbose</w><w>mode</w></ref><pc>.</pc></s><s xml:id="s_6iOdGT"><w>By</w><w>putting</w><w>your</w><w>patterns</w><w>in</w><w>verbose</w><w>mode</w><w>,</w><w>python</w><w>ignores</w><w>white</w><w>space</w><w>and</w><w>the</w><w>#</w><w>character</w><w>,</w><w>so</w><w>you</w><w>can</w><w>split</w><w>the</w><w>patterns</w><w>across</w><w>multiple</w><w>lines</w><w>and</w><w>comment</w><w>each</w><w>piece</w><pc>.</pc></s><emph><hi rend="bold"><s xml:id="s_SfdgL5"><w>Keep</w><w>in</w><w>mind</w><w>that</w><w>,</w><w>because</w><w>it</w><w>ignores</w><w>spaces</w><w>,</w><w>if</w><w>spaces</w><w>are</w><w>part</w><w>of</w><w>your</w><w>pattern</w><w>,</w><w>you</w><w>need</w><w>to</w><w>escape</w><w>them</w><w>with</w><w>a</w><w>backslash</w><w>(</w><w>\</w><w>)</w><pc>.</pc></s><s xml:id="s_qBjTgL"><w>Also</w><w>note</w><w>that</w><w>re.VERBOSE</w><w>and</w><w>re.X</w><w>are</w><w>the</w><w>same</w><w>thing</w><pc>.</pc></s></hi></emph></p><p><s xml:id="s_R4FiIU"><w>Here</w><w>are</w><w>lines</w><w>39</w><w>and</w><w>40</w><w>in</w><w>verbose</w><w>mode</w><w>:</w></s></p><ab><code lang="language-python" xml:id="code_cleaning-ocrd-text-with-regular-expressions_9" corresp="code_cleaning-ocrd-text-with-regular-expressions_9.txt" rend="block"/></ab><p><s xml:id="s_7abTaP"><w>In</w><w>above</w><w>example</w><w>,</w><w>I</w><w>use</w><w>the</w><ref target="http://docs.python.org/2/library/re.html#re.compile"><w>re.compile</w><w>(</w><w>)</w></ref><w>function</w><w>to</w><w>save</w><w>the</w><w>pattern</w><w>for</w><w>future</w><w>use</w><pc>.</pc></s><s xml:id="s_XBzLXd"><w>So</w><w>,</w><w>adjusting</w><w>my</w><w>full</w><w>python</w><w>code</w><w>to</w><w>use</w><w>verbose</w><w>mode</w><w>would</w><w>look</w><w>like</w><w>the</w><w>following</w><pc>.</pc></s><s xml:id="s_mr8ebv"><w>Note</w><w>that</w><w>I</w><w>define</w><w>my</w><w>verbose</w><w>patterns</w><w>on</w><w>lines</w><w>17-39</w><w>and</w><w>store</w><w>them</w><w>in</w><w>variables</w><w>(</w><w>ne_pattern</w><w>and</w><w>nw_pattern</w><w>)</w><pc>.</pc></s><s xml:id="s_ckbuB5"><w>I</w><w>use</w><w>them</w><w>in</w><w>my</w><w>loop</w><w>on</w><w>lines</w><w>65</w><w>and</w><w>66</w><pc>.</pc></s></p><ab><code lang="language-python" xml:id="code_cleaning-ocrd-text-with-regular-expressions_10" corresp="code_cleaning-ocrd-text-with-regular-expressions_10.txt" rend="block"/></ab><p><s xml:id="s_sJ7E3x"><w>In</w><w>conclusion</w><w>,</w><w>I</w><w>will</w><w>note</w><w>that</w><w>this</w><w>is</w><w>not</w><w>for</w><w>the</w><w>faint</w><w>of</w><w>heart</w><pc>.</pc></s><s xml:id="s_zAbH2H"><w>Regular</w><w>Expressions</w><w>are</w><w>powerful</w><pc>.</pc></s><s xml:id="s_KwV3s9"><w>Yes</w><w>,</w><w>they</w><w>are</w><w>powerful</w><w>enough</w><w>to</w><w>completely</w><w>destroy</w><w>your</w><w>data</w><pc>.</pc></s><s xml:id="s_F4FuIp"><w>So</w><w>practice</w><w>on</w><w>copies</w><w>and</w><w>take</w><w>it</w><w>one</w><w>itty</w><w>bitty</w><w>step</w><w>at</w><w>a</w><w>time</w><pc>.</pc></s></p></div></div></body>
    </text>
</TEI>
